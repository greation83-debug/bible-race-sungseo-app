(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function hS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Uw={exports:{}},nh={},zw={exports:{}},re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lc=Symbol.for("react.element"),fS=Symbol.for("react.portal"),pS=Symbol.for("react.fragment"),mS=Symbol.for("react.strict_mode"),gS=Symbol.for("react.profiler"),yS=Symbol.for("react.provider"),vS=Symbol.for("react.context"),xS=Symbol.for("react.forward_ref"),wS=Symbol.for("react.suspense"),bS=Symbol.for("react.memo"),_S=Symbol.for("react.lazy"),Av=Symbol.iterator;function IS(t){return t===null||typeof t!="object"?null:(t=Av&&t[Av]||t["@@iterator"],typeof t=="function"?t:null)}var Bw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qw=Object.assign,Ww={};function Zo(t,e,n){this.props=t,this.context=e,this.refs=Ww,this.updater=n||Bw}Zo.prototype.isReactComponent={};Zo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Zo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Hw(){}Hw.prototype=Zo.prototype;function jg(t,e,n){this.props=t,this.context=e,this.refs=Ww,this.updater=n||Bw}var Dg=jg.prototype=new Hw;Dg.constructor=jg;qw(Dg,Zo.prototype);Dg.isPureReactComponent=!0;var Rv=Array.isArray,Gw=Object.prototype.hasOwnProperty,Ag={current:null},Kw={key:!0,ref:!0,__self:!0,__source:!0};function Qw(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Gw.call(e,r)&&!Kw.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var c=Array(a),u=0;u<a;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:lc,type:t,key:i,ref:o,props:s,_owner:Ag.current}}function NS(t,e){return{$$typeof:lc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Rg(t){return typeof t=="object"&&t!==null&&t.$$typeof===lc}function ES(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Pv=/\/+/g;function Mf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ES(""+t.key):e.toString(36)}function Du(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case lc:case fS:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Mf(o,0):r,Rv(s)?(n="",t!=null&&(n=t.replace(Pv,"$&/")+"/"),Du(s,e,n,"",function(u){return u})):s!=null&&(Rg(s)&&(s=NS(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Pv,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Rv(t))for(var a=0;a<t.length;a++){i=t[a];var c=r+Mf(i,a);o+=Du(i,e,n,c,s)}else if(c=IS(t),typeof c=="function")for(t=c.call(t),a=0;!(i=t.next()).done;)i=i.value,c=r+Mf(i,a++),o+=Du(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function tu(t,e,n){if(t==null)return t;var r=[],s=0;return Du(t,r,"","",function(i){return e.call(n,i,s++)}),r}function kS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Gt={current:null},Au={transition:null},SS={ReactCurrentDispatcher:Gt,ReactCurrentBatchConfig:Au,ReactCurrentOwner:Ag};function Yw(){throw Error("act(...) is not supported in production builds of React.")}re.Children={map:tu,forEach:function(t,e,n){tu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return tu(t,function(){e++}),e},toArray:function(t){return tu(t,function(e){return e})||[]},only:function(t){if(!Rg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};re.Component=Zo;re.Fragment=pS;re.Profiler=gS;re.PureComponent=jg;re.StrictMode=mS;re.Suspense=wS;re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SS;re.act=Yw;re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=qw({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Ag.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(c in e)Gw.call(e,c)&&!Kw.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){a=Array(c);for(var u=0;u<c;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:lc,type:t.type,key:s,ref:i,props:r,_owner:o}};re.createContext=function(t){return t={$$typeof:vS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:yS,_context:t},t.Consumer=t};re.createElement=Qw;re.createFactory=function(t){var e=Qw.bind(null,t);return e.type=t,e};re.createRef=function(){return{current:null}};re.forwardRef=function(t){return{$$typeof:xS,render:t}};re.isValidElement=Rg;re.lazy=function(t){return{$$typeof:_S,_payload:{_status:-1,_result:t},_init:kS}};re.memo=function(t,e){return{$$typeof:bS,type:t,compare:e===void 0?null:e}};re.startTransition=function(t){var e=Au.transition;Au.transition={};try{t()}finally{Au.transition=e}};re.unstable_act=Yw;re.useCallback=function(t,e){return Gt.current.useCallback(t,e)};re.useContext=function(t){return Gt.current.useContext(t)};re.useDebugValue=function(){};re.useDeferredValue=function(t){return Gt.current.useDeferredValue(t)};re.useEffect=function(t,e){return Gt.current.useEffect(t,e)};re.useId=function(){return Gt.current.useId()};re.useImperativeHandle=function(t,e,n){return Gt.current.useImperativeHandle(t,e,n)};re.useInsertionEffect=function(t,e){return Gt.current.useInsertionEffect(t,e)};re.useLayoutEffect=function(t,e){return Gt.current.useLayoutEffect(t,e)};re.useMemo=function(t,e){return Gt.current.useMemo(t,e)};re.useReducer=function(t,e,n){return Gt.current.useReducer(t,e,n)};re.useRef=function(t){return Gt.current.useRef(t)};re.useState=function(t){return Gt.current.useState(t)};re.useSyncExternalStore=function(t,e,n){return Gt.current.useSyncExternalStore(t,e,n)};re.useTransition=function(){return Gt.current.useTransition()};re.version="18.3.1";zw.exports=re;var A=zw.exports;const Lp=hS(A);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TS=A,CS=Symbol.for("react.element"),jS=Symbol.for("react.fragment"),DS=Object.prototype.hasOwnProperty,AS=TS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,RS={key:!0,ref:!0,__self:!0,__source:!0};function Xw(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)DS.call(e,r)&&!RS.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:CS,type:t,key:i,ref:o,props:s,_owner:AS.current}}nh.Fragment=jS;nh.jsx=Xw;nh.jsxs=Xw;Uw.exports=nh;var l=Uw.exports,Mp={},Jw={exports:{}},gn={},Zw={exports:{}},eb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,T){var S=V.length;V.push(T);e:for(;0<S;){var O=S-1>>>1,B=V[O];if(0<s(B,T))V[O]=T,V[S]=B,S=O;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var T=V[0],S=V.pop();if(S!==T){V[0]=S;e:for(var O=0,B=V.length,M=B>>>1;O<M;){var X=2*(O+1)-1,me=V[X],oe=X+1,ge=V[oe];if(0>s(me,S))oe<B&&0>s(ge,me)?(V[O]=ge,V[oe]=S,O=oe):(V[O]=me,V[X]=S,O=X);else if(oe<B&&0>s(ge,S))V[O]=ge,V[oe]=S,O=oe;else break e}}return T}function s(V,T){var S=V.sortIndex-T.sortIndex;return S!==0?S:V.id-T.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var c=[],u=[],d=1,h=null,f=3,m=!1,y=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(V){for(var T=n(u);T!==null;){if(T.callback===null)r(u);else if(T.startTime<=V)r(u),T.sortIndex=T.expirationTime,e(c,T);else break;T=n(u)}}function b(V){if(x=!1,v(V),!y)if(n(c)!==null)y=!0,Le(I);else{var T=n(u);T!==null&&ke(b,T.startTime-V)}}function I(V,T){y=!1,x&&(x=!1,g(C),C=-1),m=!0;var S=f;try{for(v(T),h=n(c);h!==null&&(!(h.expirationTime>T)||V&&!W());){var O=h.callback;if(typeof O=="function"){h.callback=null,f=h.priorityLevel;var B=O(h.expirationTime<=T);T=t.unstable_now(),typeof B=="function"?h.callback=B:h===n(c)&&r(c),v(T)}else r(c);h=n(c)}if(h!==null)var M=!0;else{var X=n(u);X!==null&&ke(b,X.startTime-T),M=!1}return M}finally{h=null,f=S,m=!1}}var _=!1,N=null,C=-1,R=5,j=-1;function W(){return!(t.unstable_now()-j<R)}function Q(){if(N!==null){var V=t.unstable_now();j=V;var T=!0;try{T=N(!0,V)}finally{T?te():(_=!1,N=null)}}else _=!1}var te;if(typeof p=="function")te=function(){p(Q)};else if(typeof MessageChannel<"u"){var Z=new MessageChannel,Re=Z.port2;Z.port1.onmessage=Q,te=function(){Re.postMessage(null)}}else te=function(){w(Q,0)};function Le(V){N=V,_||(_=!0,te())}function ke(V,T){C=w(function(){V(t.unstable_now())},T)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){y||m||(y=!0,Le(I))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(V){switch(f){case 1:case 2:case 3:var T=3;break;default:T=f}var S=f;f=T;try{return V()}finally{f=S}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,T){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var S=f;f=V;try{return T()}finally{f=S}},t.unstable_scheduleCallback=function(V,T,S){var O=t.unstable_now();switch(typeof S=="object"&&S!==null?(S=S.delay,S=typeof S=="number"&&0<S?O+S:O):S=O,V){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=S+B,V={id:d++,callback:T,priorityLevel:V,startTime:S,expirationTime:B,sortIndex:-1},S>O?(V.sortIndex=S,e(u,V),n(c)===null&&V===n(u)&&(x?(g(C),C=-1):x=!0,ke(b,S-O))):(V.sortIndex=B,e(c,V),y||m||(y=!0,Le(I))),V},t.unstable_shouldYield=W,t.unstable_wrapCallback=function(V){var T=f;return function(){var S=f;f=T;try{return V.apply(this,arguments)}finally{f=S}}}})(eb);Zw.exports=eb;var PS=Zw.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OS=A,fn=PS;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tb=new Set,yl={};function $i(t,e){Do(t,e),Do(t+"Capture",e)}function Do(t,e){for(yl[t]=e,t=0;t<e.length;t++)tb.add(e[t])}var jr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Fp=Object.prototype.hasOwnProperty,$S=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ov={},$v={};function LS(t){return Fp.call($v,t)?!0:Fp.call(Ov,t)?!1:$S.test(t)?$v[t]=!0:(Ov[t]=!0,!1)}function MS(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function FS(t,e,n,r){if(e===null||typeof e>"u"||MS(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Kt(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tt[t]=new Kt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tt[e]=new Kt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tt[t]=new Kt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tt[t]=new Kt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tt[t]=new Kt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tt[t]=new Kt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tt[t]=new Kt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tt[t]=new Kt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tt[t]=new Kt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Pg=/[\-:]([a-z])/g;function Og(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Pg,Og);Tt[e]=new Kt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Pg,Og);Tt[e]=new Kt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Pg,Og);Tt[e]=new Kt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tt[t]=new Kt(t,1,!1,t.toLowerCase(),null,!1,!1)});Tt.xlinkHref=new Kt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tt[t]=new Kt(t,1,!1,t.toLowerCase(),null,!0,!0)});function $g(t,e,n,r){var s=Tt.hasOwnProperty(e)?Tt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(FS(e,n,s,r)&&(n=null),r||s===null?LS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Mr=OS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,nu=Symbol.for("react.element"),no=Symbol.for("react.portal"),ro=Symbol.for("react.fragment"),Lg=Symbol.for("react.strict_mode"),Vp=Symbol.for("react.profiler"),nb=Symbol.for("react.provider"),rb=Symbol.for("react.context"),Mg=Symbol.for("react.forward_ref"),Up=Symbol.for("react.suspense"),zp=Symbol.for("react.suspense_list"),Fg=Symbol.for("react.memo"),Xr=Symbol.for("react.lazy"),sb=Symbol.for("react.offscreen"),Lv=Symbol.iterator;function _a(t){return t===null||typeof t!="object"?null:(t=Lv&&t[Lv]||t["@@iterator"],typeof t=="function"?t:null)}var Ve=Object.assign,Ff;function Ua(t){if(Ff===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ff=e&&e[1]||""}return`
`+Ff+t}var Vf=!1;function Uf(t,e){if(!t||Vf)return"";Vf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=a);break}}}finally{Vf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ua(t):""}function VS(t){switch(t.tag){case 5:return Ua(t.type);case 16:return Ua("Lazy");case 13:return Ua("Suspense");case 19:return Ua("SuspenseList");case 0:case 2:case 15:return t=Uf(t.type,!1),t;case 11:return t=Uf(t.type.render,!1),t;case 1:return t=Uf(t.type,!0),t;default:return""}}function Bp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ro:return"Fragment";case no:return"Portal";case Vp:return"Profiler";case Lg:return"StrictMode";case Up:return"Suspense";case zp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rb:return(t.displayName||"Context")+".Consumer";case nb:return(t._context.displayName||"Context")+".Provider";case Mg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fg:return e=t.displayName||null,e!==null?e:Bp(t.type)||"Memo";case Xr:e=t._payload,t=t._init;try{return Bp(t(e))}catch{}}return null}function US(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bp(e);case 8:return e===Lg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ys(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ib(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function zS(t){var e=ib(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ru(t){t._valueTracker||(t._valueTracker=zS(t))}function ob(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ib(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function nd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qp(t,e){var n=e.checked;return Ve({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Mv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ys(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ab(t,e){e=e.checked,e!=null&&$g(t,"checked",e,!1)}function Wp(t,e){ab(t,e);var n=ys(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Hp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Hp(t,e.type,ys(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Fv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Hp(t,e,n){(e!=="number"||nd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var za=Array.isArray;function yo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ys(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Gp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return Ve({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Vv(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(za(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ys(n)}}function lb(t,e){var n=ys(e.value),r=ys(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Uv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function cb(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?cb(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var su,ub=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(su=su||document.createElement("div"),su.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=su.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vl(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ja={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},BS=["Webkit","ms","Moz","O"];Object.keys(Ja).forEach(function(t){BS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ja[e]=Ja[t]})});function db(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ja.hasOwnProperty(t)&&Ja[t]?(""+e).trim():e+"px"}function hb(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=db(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var qS=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qp(t,e){if(e){if(qS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function Yp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xp=null;function Vg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Jp=null,vo=null,xo=null;function zv(t){if(t=dc(t)){if(typeof Jp!="function")throw Error($(280));var e=t.stateNode;e&&(e=ah(e),Jp(t.stateNode,t.type,e))}}function fb(t){vo?xo?xo.push(t):xo=[t]:vo=t}function pb(){if(vo){var t=vo,e=xo;if(xo=vo=null,zv(t),e)for(t=0;t<e.length;t++)zv(e[t])}}function mb(t,e){return t(e)}function gb(){}var zf=!1;function yb(t,e,n){if(zf)return t(e,n);zf=!0;try{return mb(t,e,n)}finally{zf=!1,(vo!==null||xo!==null)&&(gb(),pb())}}function xl(t,e){var n=t.stateNode;if(n===null)return null;var r=ah(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var Zp=!1;if(jr)try{var Ia={};Object.defineProperty(Ia,"passive",{get:function(){Zp=!0}}),window.addEventListener("test",Ia,Ia),window.removeEventListener("test",Ia,Ia)}catch{Zp=!1}function WS(t,e,n,r,s,i,o,a,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Za=!1,rd=null,sd=!1,em=null,HS={onError:function(t){Za=!0,rd=t}};function GS(t,e,n,r,s,i,o,a,c){Za=!1,rd=null,WS.apply(HS,arguments)}function KS(t,e,n,r,s,i,o,a,c){if(GS.apply(this,arguments),Za){if(Za){var u=rd;Za=!1,rd=null}else throw Error($(198));sd||(sd=!0,em=u)}}function Li(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function vb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Bv(t){if(Li(t)!==t)throw Error($(188))}function QS(t){var e=t.alternate;if(!e){if(e=Li(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Bv(s),t;if(i===r)return Bv(s),e;i=i.sibling}throw Error($(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function xb(t){return t=QS(t),t!==null?wb(t):null}function wb(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=wb(t);if(e!==null)return e;t=t.sibling}return null}var bb=fn.unstable_scheduleCallback,qv=fn.unstable_cancelCallback,YS=fn.unstable_shouldYield,XS=fn.unstable_requestPaint,Ke=fn.unstable_now,JS=fn.unstable_getCurrentPriorityLevel,Ug=fn.unstable_ImmediatePriority,_b=fn.unstable_UserBlockingPriority,id=fn.unstable_NormalPriority,ZS=fn.unstable_LowPriority,Ib=fn.unstable_IdlePriority,rh=null,ir=null;function eT(t){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(rh,t,void 0,(t.current.flags&128)===128)}catch{}}var On=Math.clz32?Math.clz32:rT,tT=Math.log,nT=Math.LN2;function rT(t){return t>>>=0,t===0?32:31-(tT(t)/nT|0)|0}var iu=64,ou=4194304;function Ba(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function od(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Ba(a):(i&=o,i!==0&&(r=Ba(i)))}else o=n&~s,o!==0?r=Ba(o):i!==0&&(r=Ba(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-On(e),s=1<<n,r|=t[n],e&=~s;return r}function sT(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function iT(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-On(i),a=1<<o,c=s[o];c===-1?(!(a&n)||a&r)&&(s[o]=sT(a,e)):c<=e&&(t.expiredLanes|=a),i&=~a}}function tm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Nb(){var t=iu;return iu<<=1,!(iu&4194240)&&(iu=64),t}function Bf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function cc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-On(e),t[e]=n}function oT(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-On(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function zg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-On(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ve=0;function Eb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var kb,Bg,Sb,Tb,Cb,nm=!1,au=[],as=null,ls=null,cs=null,wl=new Map,bl=new Map,Zr=[],aT="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Wv(t,e){switch(t){case"focusin":case"focusout":as=null;break;case"dragenter":case"dragleave":ls=null;break;case"mouseover":case"mouseout":cs=null;break;case"pointerover":case"pointerout":wl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":bl.delete(e.pointerId)}}function Na(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=dc(e),e!==null&&Bg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function lT(t,e,n,r,s){switch(e){case"focusin":return as=Na(as,t,e,n,r,s),!0;case"dragenter":return ls=Na(ls,t,e,n,r,s),!0;case"mouseover":return cs=Na(cs,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return wl.set(i,Na(wl.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,bl.set(i,Na(bl.get(i)||null,t,e,n,r,s)),!0}return!1}function jb(t){var e=ri(t.target);if(e!==null){var n=Li(e);if(n!==null){if(e=n.tag,e===13){if(e=vb(n),e!==null){t.blockedOn=e,Cb(t.priority,function(){Sb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ru(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=rm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Xp=r,n.target.dispatchEvent(r),Xp=null}else return e=dc(n),e!==null&&Bg(e),t.blockedOn=n,!1;e.shift()}return!0}function Hv(t,e,n){Ru(t)&&n.delete(e)}function cT(){nm=!1,as!==null&&Ru(as)&&(as=null),ls!==null&&Ru(ls)&&(ls=null),cs!==null&&Ru(cs)&&(cs=null),wl.forEach(Hv),bl.forEach(Hv)}function Ea(t,e){t.blockedOn===e&&(t.blockedOn=null,nm||(nm=!0,fn.unstable_scheduleCallback(fn.unstable_NormalPriority,cT)))}function _l(t){function e(s){return Ea(s,t)}if(0<au.length){Ea(au[0],t);for(var n=1;n<au.length;n++){var r=au[n];r.blockedOn===t&&(r.blockedOn=null)}}for(as!==null&&Ea(as,t),ls!==null&&Ea(ls,t),cs!==null&&Ea(cs,t),wl.forEach(e),bl.forEach(e),n=0;n<Zr.length;n++)r=Zr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Zr.length&&(n=Zr[0],n.blockedOn===null);)jb(n),n.blockedOn===null&&Zr.shift()}var wo=Mr.ReactCurrentBatchConfig,ad=!0;function uT(t,e,n,r){var s=ve,i=wo.transition;wo.transition=null;try{ve=1,qg(t,e,n,r)}finally{ve=s,wo.transition=i}}function dT(t,e,n,r){var s=ve,i=wo.transition;wo.transition=null;try{ve=4,qg(t,e,n,r)}finally{ve=s,wo.transition=i}}function qg(t,e,n,r){if(ad){var s=rm(t,e,n,r);if(s===null)Zf(t,e,r,ld,n),Wv(t,r);else if(lT(s,t,e,n,r))r.stopPropagation();else if(Wv(t,r),e&4&&-1<aT.indexOf(t)){for(;s!==null;){var i=dc(s);if(i!==null&&kb(i),i=rm(t,e,n,r),i===null&&Zf(t,e,r,ld,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Zf(t,e,r,null,n)}}var ld=null;function rm(t,e,n,r){if(ld=null,t=Vg(r),t=ri(t),t!==null)if(e=Li(t),e===null)t=null;else if(n=e.tag,n===13){if(t=vb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ld=t,null}function Db(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(JS()){case Ug:return 1;case _b:return 4;case id:case ZS:return 16;case Ib:return 536870912;default:return 16}default:return 16}}var rs=null,Wg=null,Pu=null;function Ab(){if(Pu)return Pu;var t,e=Wg,n=e.length,r,s="value"in rs?rs.value:rs.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Pu=s.slice(t,1<r?1-r:void 0)}function Ou(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function lu(){return!0}function Gv(){return!1}function yn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?lu:Gv,this.isPropagationStopped=Gv,this}return Ve(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=lu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=lu)},persist:function(){},isPersistent:lu}),e}var ea={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Hg=yn(ea),uc=Ve({},ea,{view:0,detail:0}),hT=yn(uc),qf,Wf,ka,sh=Ve({},uc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ka&&(ka&&t.type==="mousemove"?(qf=t.screenX-ka.screenX,Wf=t.screenY-ka.screenY):Wf=qf=0,ka=t),qf)},movementY:function(t){return"movementY"in t?t.movementY:Wf}}),Kv=yn(sh),fT=Ve({},sh,{dataTransfer:0}),pT=yn(fT),mT=Ve({},uc,{relatedTarget:0}),Hf=yn(mT),gT=Ve({},ea,{animationName:0,elapsedTime:0,pseudoElement:0}),yT=yn(gT),vT=Ve({},ea,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),xT=yn(vT),wT=Ve({},ea,{data:0}),Qv=yn(wT),bT={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_T={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NT(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=IT[t])?!!e[t]:!1}function Gg(){return NT}var ET=Ve({},uc,{key:function(t){if(t.key){var e=bT[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ou(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_T[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gg,charCode:function(t){return t.type==="keypress"?Ou(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ou(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kT=yn(ET),ST=Ve({},sh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yv=yn(ST),TT=Ve({},uc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gg}),CT=yn(TT),jT=Ve({},ea,{propertyName:0,elapsedTime:0,pseudoElement:0}),DT=yn(jT),AT=Ve({},sh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),RT=yn(AT),PT=[9,13,27,32],Kg=jr&&"CompositionEvent"in window,el=null;jr&&"documentMode"in document&&(el=document.documentMode);var OT=jr&&"TextEvent"in window&&!el,Rb=jr&&(!Kg||el&&8<el&&11>=el),Xv=String.fromCharCode(32),Jv=!1;function Pb(t,e){switch(t){case"keyup":return PT.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ob(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var so=!1;function $T(t,e){switch(t){case"compositionend":return Ob(e);case"keypress":return e.which!==32?null:(Jv=!0,Xv);case"textInput":return t=e.data,t===Xv&&Jv?null:t;default:return null}}function LT(t,e){if(so)return t==="compositionend"||!Kg&&Pb(t,e)?(t=Ab(),Pu=Wg=rs=null,so=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Rb&&e.locale!=="ko"?null:e.data;default:return null}}var MT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Zv(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!MT[t.type]:e==="textarea"}function $b(t,e,n,r){fb(r),e=cd(e,"onChange"),0<e.length&&(n=new Hg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var tl=null,Il=null;function FT(t){Gb(t,0)}function ih(t){var e=ao(t);if(ob(e))return t}function VT(t,e){if(t==="change")return e}var Lb=!1;if(jr){var Gf;if(jr){var Kf="oninput"in document;if(!Kf){var e1=document.createElement("div");e1.setAttribute("oninput","return;"),Kf=typeof e1.oninput=="function"}Gf=Kf}else Gf=!1;Lb=Gf&&(!document.documentMode||9<document.documentMode)}function t1(){tl&&(tl.detachEvent("onpropertychange",Mb),Il=tl=null)}function Mb(t){if(t.propertyName==="value"&&ih(Il)){var e=[];$b(e,Il,t,Vg(t)),yb(FT,e)}}function UT(t,e,n){t==="focusin"?(t1(),tl=e,Il=n,tl.attachEvent("onpropertychange",Mb)):t==="focusout"&&t1()}function zT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ih(Il)}function BT(t,e){if(t==="click")return ih(e)}function qT(t,e){if(t==="input"||t==="change")return ih(e)}function WT(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ln=typeof Object.is=="function"?Object.is:WT;function Nl(t,e){if(Ln(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Fp.call(e,s)||!Ln(t[s],e[s]))return!1}return!0}function n1(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function r1(t,e){var n=n1(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=n1(n)}}function Fb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Fb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Vb(){for(var t=window,e=nd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=nd(t.document)}return e}function Qg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function HT(t){var e=Vb(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Fb(n.ownerDocument.documentElement,n)){if(r!==null&&Qg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=r1(n,i);var o=r1(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var GT=jr&&"documentMode"in document&&11>=document.documentMode,io=null,sm=null,nl=null,im=!1;function s1(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;im||io==null||io!==nd(r)||(r=io,"selectionStart"in r&&Qg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),nl&&Nl(nl,r)||(nl=r,r=cd(sm,"onSelect"),0<r.length&&(e=new Hg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=io)))}function cu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var oo={animationend:cu("Animation","AnimationEnd"),animationiteration:cu("Animation","AnimationIteration"),animationstart:cu("Animation","AnimationStart"),transitionend:cu("Transition","TransitionEnd")},Qf={},Ub={};jr&&(Ub=document.createElement("div").style,"AnimationEvent"in window||(delete oo.animationend.animation,delete oo.animationiteration.animation,delete oo.animationstart.animation),"TransitionEvent"in window||delete oo.transitionend.transition);function oh(t){if(Qf[t])return Qf[t];if(!oo[t])return t;var e=oo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Ub)return Qf[t]=e[n];return t}var zb=oh("animationend"),Bb=oh("animationiteration"),qb=oh("animationstart"),Wb=oh("transitionend"),Hb=new Map,i1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function As(t,e){Hb.set(t,e),$i(e,[t])}for(var Yf=0;Yf<i1.length;Yf++){var Xf=i1[Yf],KT=Xf.toLowerCase(),QT=Xf[0].toUpperCase()+Xf.slice(1);As(KT,"on"+QT)}As(zb,"onAnimationEnd");As(Bb,"onAnimationIteration");As(qb,"onAnimationStart");As("dblclick","onDoubleClick");As("focusin","onFocus");As("focusout","onBlur");As(Wb,"onTransitionEnd");Do("onMouseEnter",["mouseout","mouseover"]);Do("onMouseLeave",["mouseout","mouseover"]);Do("onPointerEnter",["pointerout","pointerover"]);Do("onPointerLeave",["pointerout","pointerover"]);$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$i("onBeforeInput",["compositionend","keypress","textInput","paste"]);$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YT=new Set("cancel close invalid load scroll toggle".split(" ").concat(qa));function o1(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,KS(r,e,void 0,t),t.currentTarget=null}function Gb(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],c=a.instance,u=a.currentTarget;if(a=a.listener,c!==i&&s.isPropagationStopped())break e;o1(s,a,u),i=c}else for(o=0;o<r.length;o++){if(a=r[o],c=a.instance,u=a.currentTarget,a=a.listener,c!==i&&s.isPropagationStopped())break e;o1(s,a,u),i=c}}}if(sd)throw t=em,sd=!1,em=null,t}function Se(t,e){var n=e[um];n===void 0&&(n=e[um]=new Set);var r=t+"__bubble";n.has(r)||(Kb(e,t,2,!1),n.add(r))}function Jf(t,e,n){var r=0;e&&(r|=4),Kb(n,t,r,e)}var uu="_reactListening"+Math.random().toString(36).slice(2);function El(t){if(!t[uu]){t[uu]=!0,tb.forEach(function(n){n!=="selectionchange"&&(YT.has(n)||Jf(n,!1,t),Jf(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[uu]||(e[uu]=!0,Jf("selectionchange",!1,e))}}function Kb(t,e,n,r){switch(Db(e)){case 1:var s=uT;break;case 4:s=dT;break;default:s=qg}n=s.bind(null,e,n,t),s=void 0,!Zp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Zf(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;a!==null;){if(o=ri(a),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}a=a.parentNode}}r=r.return}yb(function(){var u=i,d=Vg(n),h=[];e:{var f=Hb.get(t);if(f!==void 0){var m=Hg,y=t;switch(t){case"keypress":if(Ou(n)===0)break e;case"keydown":case"keyup":m=kT;break;case"focusin":y="focus",m=Hf;break;case"focusout":y="blur",m=Hf;break;case"beforeblur":case"afterblur":m=Hf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Kv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=pT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=CT;break;case zb:case Bb:case qb:m=yT;break;case Wb:m=DT;break;case"scroll":m=hT;break;case"wheel":m=RT;break;case"copy":case"cut":case"paste":m=xT;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Yv}var x=(e&4)!==0,w=!x&&t==="scroll",g=x?f!==null?f+"Capture":null:f;x=[];for(var p=u,v;p!==null;){v=p;var b=v.stateNode;if(v.tag===5&&b!==null&&(v=b,g!==null&&(b=xl(p,g),b!=null&&x.push(kl(p,b,v)))),w)break;p=p.return}0<x.length&&(f=new m(f,y,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==Xp&&(y=n.relatedTarget||n.fromElement)&&(ri(y)||y[Dr]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(y=n.relatedTarget||n.toElement,m=u,y=y?ri(y):null,y!==null&&(w=Li(y),y!==w||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(x=Kv,b="onMouseLeave",g="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(x=Yv,b="onPointerLeave",g="onPointerEnter",p="pointer"),w=m==null?f:ao(m),v=y==null?f:ao(y),f=new x(b,p+"leave",m,n,d),f.target=w,f.relatedTarget=v,b=null,ri(d)===u&&(x=new x(g,p+"enter",y,n,d),x.target=v,x.relatedTarget=w,b=x),w=b,m&&y)t:{for(x=m,g=y,p=0,v=x;v;v=Ki(v))p++;for(v=0,b=g;b;b=Ki(b))v++;for(;0<p-v;)x=Ki(x),p--;for(;0<v-p;)g=Ki(g),v--;for(;p--;){if(x===g||g!==null&&x===g.alternate)break t;x=Ki(x),g=Ki(g)}x=null}else x=null;m!==null&&a1(h,f,m,x,!1),y!==null&&w!==null&&a1(h,w,y,x,!0)}}e:{if(f=u?ao(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var I=VT;else if(Zv(f))if(Lb)I=qT;else{I=zT;var _=UT}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(I=BT);if(I&&(I=I(t,u))){$b(h,I,n,d);break e}_&&_(t,f,u),t==="focusout"&&(_=f._wrapperState)&&_.controlled&&f.type==="number"&&Hp(f,"number",f.value)}switch(_=u?ao(u):window,t){case"focusin":(Zv(_)||_.contentEditable==="true")&&(io=_,sm=u,nl=null);break;case"focusout":nl=sm=io=null;break;case"mousedown":im=!0;break;case"contextmenu":case"mouseup":case"dragend":im=!1,s1(h,n,d);break;case"selectionchange":if(GT)break;case"keydown":case"keyup":s1(h,n,d)}var N;if(Kg)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else so?Pb(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(Rb&&n.locale!=="ko"&&(so||C!=="onCompositionStart"?C==="onCompositionEnd"&&so&&(N=Ab()):(rs=d,Wg="value"in rs?rs.value:rs.textContent,so=!0)),_=cd(u,C),0<_.length&&(C=new Qv(C,t,null,n,d),h.push({event:C,listeners:_}),N?C.data=N:(N=Ob(n),N!==null&&(C.data=N)))),(N=OT?$T(t,n):LT(t,n))&&(u=cd(u,"onBeforeInput"),0<u.length&&(d=new Qv("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=N))}Gb(h,e)})}function kl(t,e,n){return{instance:t,listener:e,currentTarget:n}}function cd(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=xl(t,n),i!=null&&r.unshift(kl(t,i,s)),i=xl(t,e),i!=null&&r.push(kl(t,i,s))),t=t.return}return r}function Ki(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function a1(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,c=a.alternate,u=a.stateNode;if(c!==null&&c===r)break;a.tag===5&&u!==null&&(a=u,s?(c=xl(n,i),c!=null&&o.unshift(kl(n,c,a))):s||(c=xl(n,i),c!=null&&o.push(kl(n,c,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var XT=/\r\n?/g,JT=/\u0000|\uFFFD/g;function l1(t){return(typeof t=="string"?t:""+t).replace(XT,`
`).replace(JT,"")}function du(t,e,n){if(e=l1(e),l1(t)!==e&&n)throw Error($(425))}function ud(){}var om=null,am=null;function lm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cm=typeof setTimeout=="function"?setTimeout:void 0,ZT=typeof clearTimeout=="function"?clearTimeout:void 0,c1=typeof Promise=="function"?Promise:void 0,eC=typeof queueMicrotask=="function"?queueMicrotask:typeof c1<"u"?function(t){return c1.resolve(null).then(t).catch(tC)}:cm;function tC(t){setTimeout(function(){throw t})}function ep(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),_l(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);_l(e)}function us(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function u1(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ta=Math.random().toString(36).slice(2),Kn="__reactFiber$"+ta,Sl="__reactProps$"+ta,Dr="__reactContainer$"+ta,um="__reactEvents$"+ta,nC="__reactListeners$"+ta,rC="__reactHandles$"+ta;function ri(t){var e=t[Kn];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Dr]||n[Kn]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=u1(t);t!==null;){if(n=t[Kn])return n;t=u1(t)}return e}t=n,n=t.parentNode}return null}function dc(t){return t=t[Kn]||t[Dr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ao(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function ah(t){return t[Sl]||null}var dm=[],lo=-1;function Rs(t){return{current:t}}function je(t){0>lo||(t.current=dm[lo],dm[lo]=null,lo--)}function Ne(t,e){lo++,dm[lo]=t.current,t.current=e}var vs={},Mt=Rs(vs),nn=Rs(!1),vi=vs;function Ao(t,e){var n=t.type.contextTypes;if(!n)return vs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function rn(t){return t=t.childContextTypes,t!=null}function dd(){je(nn),je(Mt)}function d1(t,e,n){if(Mt.current!==vs)throw Error($(168));Ne(Mt,e),Ne(nn,n)}function Qb(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error($(108,US(t)||"Unknown",s));return Ve({},n,r)}function hd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||vs,vi=Mt.current,Ne(Mt,t),Ne(nn,nn.current),!0}function h1(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=Qb(t,e,vi),r.__reactInternalMemoizedMergedChildContext=t,je(nn),je(Mt),Ne(Mt,t)):je(nn),Ne(nn,n)}var xr=null,lh=!1,tp=!1;function Yb(t){xr===null?xr=[t]:xr.push(t)}function sC(t){lh=!0,Yb(t)}function Ps(){if(!tp&&xr!==null){tp=!0;var t=0,e=ve;try{var n=xr;for(ve=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}xr=null,lh=!1}catch(s){throw xr!==null&&(xr=xr.slice(t+1)),bb(Ug,Ps),s}finally{ve=e,tp=!1}}return null}var co=[],uo=0,fd=null,pd=0,xn=[],wn=0,xi=null,wr=1,br="";function Ks(t,e){co[uo++]=pd,co[uo++]=fd,fd=t,pd=e}function Xb(t,e,n){xn[wn++]=wr,xn[wn++]=br,xn[wn++]=xi,xi=t;var r=wr;t=br;var s=32-On(r)-1;r&=~(1<<s),n+=1;var i=32-On(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,wr=1<<32-On(e)+s|n<<s|r,br=i+t}else wr=1<<i|n<<s|r,br=t}function Yg(t){t.return!==null&&(Ks(t,1),Xb(t,1,0))}function Xg(t){for(;t===fd;)fd=co[--uo],co[uo]=null,pd=co[--uo],co[uo]=null;for(;t===xi;)xi=xn[--wn],xn[wn]=null,br=xn[--wn],xn[wn]=null,wr=xn[--wn],xn[wn]=null}var hn=null,un=null,Pe=!1,Rn=null;function Jb(t,e){var n=_n(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function f1(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,hn=t,un=us(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,hn=t,un=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xi!==null?{id:wr,overflow:br}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=_n(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,hn=t,un=null,!0):!1;default:return!1}}function hm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fm(t){if(Pe){var e=un;if(e){var n=e;if(!f1(t,e)){if(hm(t))throw Error($(418));e=us(n.nextSibling);var r=hn;e&&f1(t,e)?Jb(r,n):(t.flags=t.flags&-4097|2,Pe=!1,hn=t)}}else{if(hm(t))throw Error($(418));t.flags=t.flags&-4097|2,Pe=!1,hn=t}}}function p1(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;hn=t}function hu(t){if(t!==hn)return!1;if(!Pe)return p1(t),Pe=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!lm(t.type,t.memoizedProps)),e&&(e=un)){if(hm(t))throw Zb(),Error($(418));for(;e;)Jb(t,e),e=us(e.nextSibling)}if(p1(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){un=us(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}un=null}}else un=hn?us(t.stateNode.nextSibling):null;return!0}function Zb(){for(var t=un;t;)t=us(t.nextSibling)}function Ro(){un=hn=null,Pe=!1}function Jg(t){Rn===null?Rn=[t]:Rn.push(t)}var iC=Mr.ReactCurrentBatchConfig;function Sa(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function fu(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function m1(t){var e=t._init;return e(t._payload)}function e2(t){function e(g,p){if(t){var v=g.deletions;v===null?(g.deletions=[p],g.flags|=16):v.push(p)}}function n(g,p){if(!t)return null;for(;p!==null;)e(g,p),p=p.sibling;return null}function r(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function s(g,p){return g=ps(g,p),g.index=0,g.sibling=null,g}function i(g,p,v){return g.index=v,t?(v=g.alternate,v!==null?(v=v.index,v<p?(g.flags|=2,p):v):(g.flags|=2,p)):(g.flags|=1048576,p)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,p,v,b){return p===null||p.tag!==6?(p=lp(v,g.mode,b),p.return=g,p):(p=s(p,v),p.return=g,p)}function c(g,p,v,b){var I=v.type;return I===ro?d(g,p,v.props.children,b,v.key):p!==null&&(p.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Xr&&m1(I)===p.type)?(b=s(p,v.props),b.ref=Sa(g,p,v),b.return=g,b):(b=zu(v.type,v.key,v.props,null,g.mode,b),b.ref=Sa(g,p,v),b.return=g,b)}function u(g,p,v,b){return p===null||p.tag!==4||p.stateNode.containerInfo!==v.containerInfo||p.stateNode.implementation!==v.implementation?(p=cp(v,g.mode,b),p.return=g,p):(p=s(p,v.children||[]),p.return=g,p)}function d(g,p,v,b,I){return p===null||p.tag!==7?(p=hi(v,g.mode,b,I),p.return=g,p):(p=s(p,v),p.return=g,p)}function h(g,p,v){if(typeof p=="string"&&p!==""||typeof p=="number")return p=lp(""+p,g.mode,v),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case nu:return v=zu(p.type,p.key,p.props,null,g.mode,v),v.ref=Sa(g,null,p),v.return=g,v;case no:return p=cp(p,g.mode,v),p.return=g,p;case Xr:var b=p._init;return h(g,b(p._payload),v)}if(za(p)||_a(p))return p=hi(p,g.mode,v,null),p.return=g,p;fu(g,p)}return null}function f(g,p,v,b){var I=p!==null?p.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return I!==null?null:a(g,p,""+v,b);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case nu:return v.key===I?c(g,p,v,b):null;case no:return v.key===I?u(g,p,v,b):null;case Xr:return I=v._init,f(g,p,I(v._payload),b)}if(za(v)||_a(v))return I!==null?null:d(g,p,v,b,null);fu(g,v)}return null}function m(g,p,v,b,I){if(typeof b=="string"&&b!==""||typeof b=="number")return g=g.get(v)||null,a(p,g,""+b,I);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case nu:return g=g.get(b.key===null?v:b.key)||null,c(p,g,b,I);case no:return g=g.get(b.key===null?v:b.key)||null,u(p,g,b,I);case Xr:var _=b._init;return m(g,p,v,_(b._payload),I)}if(za(b)||_a(b))return g=g.get(v)||null,d(p,g,b,I,null);fu(p,b)}return null}function y(g,p,v,b){for(var I=null,_=null,N=p,C=p=0,R=null;N!==null&&C<v.length;C++){N.index>C?(R=N,N=null):R=N.sibling;var j=f(g,N,v[C],b);if(j===null){N===null&&(N=R);break}t&&N&&j.alternate===null&&e(g,N),p=i(j,p,C),_===null?I=j:_.sibling=j,_=j,N=R}if(C===v.length)return n(g,N),Pe&&Ks(g,C),I;if(N===null){for(;C<v.length;C++)N=h(g,v[C],b),N!==null&&(p=i(N,p,C),_===null?I=N:_.sibling=N,_=N);return Pe&&Ks(g,C),I}for(N=r(g,N);C<v.length;C++)R=m(N,g,C,v[C],b),R!==null&&(t&&R.alternate!==null&&N.delete(R.key===null?C:R.key),p=i(R,p,C),_===null?I=R:_.sibling=R,_=R);return t&&N.forEach(function(W){return e(g,W)}),Pe&&Ks(g,C),I}function x(g,p,v,b){var I=_a(v);if(typeof I!="function")throw Error($(150));if(v=I.call(v),v==null)throw Error($(151));for(var _=I=null,N=p,C=p=0,R=null,j=v.next();N!==null&&!j.done;C++,j=v.next()){N.index>C?(R=N,N=null):R=N.sibling;var W=f(g,N,j.value,b);if(W===null){N===null&&(N=R);break}t&&N&&W.alternate===null&&e(g,N),p=i(W,p,C),_===null?I=W:_.sibling=W,_=W,N=R}if(j.done)return n(g,N),Pe&&Ks(g,C),I;if(N===null){for(;!j.done;C++,j=v.next())j=h(g,j.value,b),j!==null&&(p=i(j,p,C),_===null?I=j:_.sibling=j,_=j);return Pe&&Ks(g,C),I}for(N=r(g,N);!j.done;C++,j=v.next())j=m(N,g,C,j.value,b),j!==null&&(t&&j.alternate!==null&&N.delete(j.key===null?C:j.key),p=i(j,p,C),_===null?I=j:_.sibling=j,_=j);return t&&N.forEach(function(Q){return e(g,Q)}),Pe&&Ks(g,C),I}function w(g,p,v,b){if(typeof v=="object"&&v!==null&&v.type===ro&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case nu:e:{for(var I=v.key,_=p;_!==null;){if(_.key===I){if(I=v.type,I===ro){if(_.tag===7){n(g,_.sibling),p=s(_,v.props.children),p.return=g,g=p;break e}}else if(_.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Xr&&m1(I)===_.type){n(g,_.sibling),p=s(_,v.props),p.ref=Sa(g,_,v),p.return=g,g=p;break e}n(g,_);break}else e(g,_);_=_.sibling}v.type===ro?(p=hi(v.props.children,g.mode,b,v.key),p.return=g,g=p):(b=zu(v.type,v.key,v.props,null,g.mode,b),b.ref=Sa(g,p,v),b.return=g,g=b)}return o(g);case no:e:{for(_=v.key;p!==null;){if(p.key===_)if(p.tag===4&&p.stateNode.containerInfo===v.containerInfo&&p.stateNode.implementation===v.implementation){n(g,p.sibling),p=s(p,v.children||[]),p.return=g,g=p;break e}else{n(g,p);break}else e(g,p);p=p.sibling}p=cp(v,g.mode,b),p.return=g,g=p}return o(g);case Xr:return _=v._init,w(g,p,_(v._payload),b)}if(za(v))return y(g,p,v,b);if(_a(v))return x(g,p,v,b);fu(g,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,p!==null&&p.tag===6?(n(g,p.sibling),p=s(p,v),p.return=g,g=p):(n(g,p),p=lp(v,g.mode,b),p.return=g,g=p),o(g)):n(g,p)}return w}var Po=e2(!0),t2=e2(!1),md=Rs(null),gd=null,ho=null,Zg=null;function e0(){Zg=ho=gd=null}function t0(t){var e=md.current;je(md),t._currentValue=e}function pm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function bo(t,e){gd=t,Zg=ho=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Jt=!0),t.firstContext=null)}function En(t){var e=t._currentValue;if(Zg!==t)if(t={context:t,memoizedValue:e,next:null},ho===null){if(gd===null)throw Error($(308));ho=t,gd.dependencies={lanes:0,firstContext:t}}else ho=ho.next=t;return e}var si=null;function n0(t){si===null?si=[t]:si.push(t)}function n2(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,n0(e)):(n.next=s.next,s.next=n),e.interleaved=n,Ar(t,r)}function Ar(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Jr=!1;function r0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function r2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Sr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ds(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ue&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ar(t,n)}return s=r.interleaved,s===null?(e.next=e,n0(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ar(t,n)}function $u(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zg(t,n)}}function g1(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function yd(t,e,n,r){var s=t.updateQueue;Jr=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var c=a,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=u:a.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,a=i;do{var f=a.lane,m=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=t,x=a;switch(f=e,m=n,x.tag){case 1:if(y=x.payload,typeof y=="function"){h=y.call(m,h,f);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=x.payload,f=typeof y=="function"?y.call(m,h,f):y,f==null)break e;h=Ve({},h,f);break e;case 2:Jr=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else m={eventTime:m,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);bi|=o,t.lanes=o,t.memoizedState=h}}function y1(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error($(191,s));s.call(r)}}}var hc={},or=Rs(hc),Tl=Rs(hc),Cl=Rs(hc);function ii(t){if(t===hc)throw Error($(174));return t}function s0(t,e){switch(Ne(Cl,e),Ne(Tl,t),Ne(or,hc),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Kp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Kp(e,t)}je(or),Ne(or,e)}function Oo(){je(or),je(Tl),je(Cl)}function s2(t){ii(Cl.current);var e=ii(or.current),n=Kp(e,t.type);e!==n&&(Ne(Tl,t),Ne(or,n))}function i0(t){Tl.current===t&&(je(or),je(Tl))}var Me=Rs(0);function vd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var np=[];function o0(){for(var t=0;t<np.length;t++)np[t]._workInProgressVersionPrimary=null;np.length=0}var Lu=Mr.ReactCurrentDispatcher,rp=Mr.ReactCurrentBatchConfig,wi=0,Fe=null,st=null,ct=null,xd=!1,rl=!1,jl=0,oC=0;function Dt(){throw Error($(321))}function a0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ln(t[n],e[n]))return!1;return!0}function l0(t,e,n,r,s,i){if(wi=i,Fe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Lu.current=t===null||t.memoizedState===null?uC:dC,t=n(r,s),rl){i=0;do{if(rl=!1,jl=0,25<=i)throw Error($(301));i+=1,ct=st=null,e.updateQueue=null,Lu.current=hC,t=n(r,s)}while(rl)}if(Lu.current=wd,e=st!==null&&st.next!==null,wi=0,ct=st=Fe=null,xd=!1,e)throw Error($(300));return t}function c0(){var t=jl!==0;return jl=0,t}function Gn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?Fe.memoizedState=ct=t:ct=ct.next=t,ct}function kn(){if(st===null){var t=Fe.alternate;t=t!==null?t.memoizedState:null}else t=st.next;var e=ct===null?Fe.memoizedState:ct.next;if(e!==null)ct=e,st=t;else{if(t===null)throw Error($(310));st=t,t={memoizedState:st.memoizedState,baseState:st.baseState,baseQueue:st.baseQueue,queue:st.queue,next:null},ct===null?Fe.memoizedState=ct=t:ct=ct.next=t}return ct}function Dl(t,e){return typeof e=="function"?e(t):e}function sp(t){var e=kn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=st,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,c=null,u=i;do{var d=u.lane;if((wi&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(a=c=h,o=r):c=c.next=h,Fe.lanes|=d,bi|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=a,Ln(r,e.memoizedState)||(Jt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Fe.lanes|=i,bi|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ip(t){var e=kn(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Ln(i,e.memoizedState)||(Jt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function i2(){}function o2(t,e){var n=Fe,r=kn(),s=e(),i=!Ln(r.memoizedState,s);if(i&&(r.memoizedState=s,Jt=!0),r=r.queue,u0(c2.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ct!==null&&ct.memoizedState.tag&1){if(n.flags|=2048,Al(9,l2.bind(null,n,r,s,e),void 0,null),dt===null)throw Error($(349));wi&30||a2(n,e,s)}return s}function a2(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Fe.updateQueue,e===null?(e={lastEffect:null,stores:null},Fe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function l2(t,e,n,r){e.value=n,e.getSnapshot=r,u2(e)&&d2(t)}function c2(t,e,n){return n(function(){u2(e)&&d2(t)})}function u2(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ln(t,n)}catch{return!0}}function d2(t){var e=Ar(t,1);e!==null&&$n(e,t,1,-1)}function v1(t){var e=Gn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dl,lastRenderedState:t},e.queue=t,t=t.dispatch=cC.bind(null,Fe,t),[e.memoizedState,t]}function Al(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Fe.updateQueue,e===null?(e={lastEffect:null,stores:null},Fe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function h2(){return kn().memoizedState}function Mu(t,e,n,r){var s=Gn();Fe.flags|=t,s.memoizedState=Al(1|e,n,void 0,r===void 0?null:r)}function ch(t,e,n,r){var s=kn();r=r===void 0?null:r;var i=void 0;if(st!==null){var o=st.memoizedState;if(i=o.destroy,r!==null&&a0(r,o.deps)){s.memoizedState=Al(e,n,i,r);return}}Fe.flags|=t,s.memoizedState=Al(1|e,n,i,r)}function x1(t,e){return Mu(8390656,8,t,e)}function u0(t,e){return ch(2048,8,t,e)}function f2(t,e){return ch(4,2,t,e)}function p2(t,e){return ch(4,4,t,e)}function m2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function g2(t,e,n){return n=n!=null?n.concat([t]):null,ch(4,4,m2.bind(null,e,t),n)}function d0(){}function y2(t,e){var n=kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&a0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function v2(t,e){var n=kn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&a0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function x2(t,e,n){return wi&21?(Ln(n,e)||(n=Nb(),Fe.lanes|=n,bi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Jt=!0),t.memoizedState=n)}function aC(t,e){var n=ve;ve=n!==0&&4>n?n:4,t(!0);var r=rp.transition;rp.transition={};try{t(!1),e()}finally{ve=n,rp.transition=r}}function w2(){return kn().memoizedState}function lC(t,e,n){var r=fs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},b2(t))_2(e,n);else if(n=n2(t,e,n,r),n!==null){var s=qt();$n(n,t,r,s),I2(n,e,r)}}function cC(t,e,n){var r=fs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(b2(t))_2(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Ln(a,o)){var c=e.interleaved;c===null?(s.next=s,n0(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=n2(t,e,s,r),n!==null&&(s=qt(),$n(n,t,r,s),I2(n,e,r))}}function b2(t){var e=t.alternate;return t===Fe||e!==null&&e===Fe}function _2(t,e){rl=xd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function I2(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,zg(t,n)}}var wd={readContext:En,useCallback:Dt,useContext:Dt,useEffect:Dt,useImperativeHandle:Dt,useInsertionEffect:Dt,useLayoutEffect:Dt,useMemo:Dt,useReducer:Dt,useRef:Dt,useState:Dt,useDebugValue:Dt,useDeferredValue:Dt,useTransition:Dt,useMutableSource:Dt,useSyncExternalStore:Dt,useId:Dt,unstable_isNewReconciler:!1},uC={readContext:En,useCallback:function(t,e){return Gn().memoizedState=[t,e===void 0?null:e],t},useContext:En,useEffect:x1,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mu(4194308,4,m2.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mu(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mu(4,2,t,e)},useMemo:function(t,e){var n=Gn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Gn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=lC.bind(null,Fe,t),[r.memoizedState,t]},useRef:function(t){var e=Gn();return t={current:t},e.memoizedState=t},useState:v1,useDebugValue:d0,useDeferredValue:function(t){return Gn().memoizedState=t},useTransition:function(){var t=v1(!1),e=t[0];return t=aC.bind(null,t[1]),Gn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Fe,s=Gn();if(Pe){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),dt===null)throw Error($(349));wi&30||a2(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,x1(c2.bind(null,r,i,t),[t]),r.flags|=2048,Al(9,l2.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Gn(),e=dt.identifierPrefix;if(Pe){var n=br,r=wr;n=(r&~(1<<32-On(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=jl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=oC++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},dC={readContext:En,useCallback:y2,useContext:En,useEffect:u0,useImperativeHandle:g2,useInsertionEffect:f2,useLayoutEffect:p2,useMemo:v2,useReducer:sp,useRef:h2,useState:function(){return sp(Dl)},useDebugValue:d0,useDeferredValue:function(t){var e=kn();return x2(e,st.memoizedState,t)},useTransition:function(){var t=sp(Dl)[0],e=kn().memoizedState;return[t,e]},useMutableSource:i2,useSyncExternalStore:o2,useId:w2,unstable_isNewReconciler:!1},hC={readContext:En,useCallback:y2,useContext:En,useEffect:u0,useImperativeHandle:g2,useInsertionEffect:f2,useLayoutEffect:p2,useMemo:v2,useReducer:ip,useRef:h2,useState:function(){return ip(Dl)},useDebugValue:d0,useDeferredValue:function(t){var e=kn();return st===null?e.memoizedState=t:x2(e,st.memoizedState,t)},useTransition:function(){var t=ip(Dl)[0],e=kn().memoizedState;return[t,e]},useMutableSource:i2,useSyncExternalStore:o2,useId:w2,unstable_isNewReconciler:!1};function Dn(t,e){if(t&&t.defaultProps){e=Ve({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function mm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Ve({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var uh={isMounted:function(t){return(t=t._reactInternals)?Li(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=qt(),s=fs(t),i=Sr(r,s);i.payload=e,n!=null&&(i.callback=n),e=ds(t,i,s),e!==null&&($n(e,t,s,r),$u(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=qt(),s=fs(t),i=Sr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=ds(t,i,s),e!==null&&($n(e,t,s,r),$u(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=qt(),r=fs(t),s=Sr(n,r);s.tag=2,e!=null&&(s.callback=e),e=ds(t,s,r),e!==null&&($n(e,t,r,n),$u(e,t,r))}};function w1(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!Nl(n,r)||!Nl(s,i):!0}function N2(t,e,n){var r=!1,s=vs,i=e.contextType;return typeof i=="object"&&i!==null?i=En(i):(s=rn(e)?vi:Mt.current,r=e.contextTypes,i=(r=r!=null)?Ao(t,s):vs),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=uh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function b1(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&uh.enqueueReplaceState(e,e.state,null)}function gm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},r0(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=En(i):(i=rn(e)?vi:Mt.current,s.context=Ao(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(mm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&uh.enqueueReplaceState(s,s.state,null),yd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function $o(t,e){try{var n="",r=e;do n+=VS(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function op(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ym(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var fC=typeof WeakMap=="function"?WeakMap:Map;function E2(t,e,n){n=Sr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_d||(_d=!0,Sm=r),ym(t,e)},n}function k2(t,e,n){n=Sr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){ym(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){ym(t,e),typeof r!="function"&&(hs===null?hs=new Set([this]):hs.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function _1(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new fC;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=SC.bind(null,t,e,n),e.then(t,t))}function I1(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function N1(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Sr(-1,1),e.tag=2,ds(n,e,1))),n.lanes|=1),t)}var pC=Mr.ReactCurrentOwner,Jt=!1;function Vt(t,e,n,r){e.child=t===null?t2(e,null,n,r):Po(e,t.child,n,r)}function E1(t,e,n,r,s){n=n.render;var i=e.ref;return bo(e,s),r=l0(t,e,n,r,i,s),n=c0(),t!==null&&!Jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Rr(t,e,s)):(Pe&&n&&Yg(e),e.flags|=1,Vt(t,e,r,s),e.child)}function k1(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!x0(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,S2(t,e,i,r,s)):(t=zu(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Nl,n(o,r)&&t.ref===e.ref)return Rr(t,e,s)}return e.flags|=1,t=ps(i,r),t.ref=e.ref,t.return=e,e.child=t}function S2(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(Nl(i,r)&&t.ref===e.ref)if(Jt=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Jt=!0);else return e.lanes=t.lanes,Rr(t,e,s)}return vm(t,e,n,r,s)}function T2(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ne(po,ln),ln|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ne(po,ln),ln|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Ne(po,ln),ln|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Ne(po,ln),ln|=r;return Vt(t,e,s,n),e.child}function C2(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function vm(t,e,n,r,s){var i=rn(n)?vi:Mt.current;return i=Ao(e,i),bo(e,s),n=l0(t,e,n,r,i,s),r=c0(),t!==null&&!Jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Rr(t,e,s)):(Pe&&r&&Yg(e),e.flags|=1,Vt(t,e,n,s),e.child)}function S1(t,e,n,r,s){if(rn(n)){var i=!0;hd(e)}else i=!1;if(bo(e,s),e.stateNode===null)Fu(t,e),N2(e,n,r),gm(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=En(u):(u=rn(n)?vi:Mt.current,u=Ao(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||c!==u)&&b1(e,o,r,u),Jr=!1;var f=e.memoizedState;o.state=f,yd(e,r,o,s),c=e.memoizedState,a!==r||f!==c||nn.current||Jr?(typeof d=="function"&&(mm(e,n,d,r),c=e.memoizedState),(a=Jr||w1(e,n,a,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,r2(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Dn(e.type,a),o.props=u,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=En(c):(c=rn(n)?vi:Mt.current,c=Ao(e,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==c)&&b1(e,o,r,c),Jr=!1,f=e.memoizedState,o.state=f,yd(e,r,o,s);var y=e.memoizedState;a!==h||f!==y||nn.current||Jr?(typeof m=="function"&&(mm(e,n,m,r),y=e.memoizedState),(u=Jr||w1(e,n,u,r,f,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),o.props=r,o.state=y,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return xm(t,e,n,r,i,s)}function xm(t,e,n,r,s,i){C2(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&h1(e,n,!1),Rr(t,e,i);r=e.stateNode,pC.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Po(e,t.child,null,i),e.child=Po(e,null,a,i)):Vt(t,e,a,i),e.memoizedState=r.state,s&&h1(e,n,!0),e.child}function j2(t){var e=t.stateNode;e.pendingContext?d1(t,e.pendingContext,e.pendingContext!==e.context):e.context&&d1(t,e.context,!1),s0(t,e.containerInfo)}function T1(t,e,n,r,s){return Ro(),Jg(s),e.flags|=256,Vt(t,e,n,r),e.child}var wm={dehydrated:null,treeContext:null,retryLane:0};function bm(t){return{baseLanes:t,cachePool:null,transitions:null}}function D2(t,e,n){var r=e.pendingProps,s=Me.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Ne(Me,s&1),t===null)return fm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=fh(o,r,0,null),t=hi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=bm(n),e.memoizedState=wm,t):h0(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return mC(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ps(s,c),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=ps(a,i):(i=hi(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?bm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=wm,r}return i=t.child,t=i.sibling,r=ps(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function h0(t,e){return e=fh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function pu(t,e,n,r){return r!==null&&Jg(r),Po(e,t.child,null,n),t=h0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function mC(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=op(Error($(422))),pu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=fh({mode:"visible",children:r.children},s,0,null),i=hi(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Po(e,t.child,null,o),e.child.memoizedState=bm(o),e.memoizedState=wm,i);if(!(e.mode&1))return pu(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error($(419)),r=op(i,r,void 0),pu(t,e,o,r)}if(a=(o&t.childLanes)!==0,Jt||a){if(r=dt,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Ar(t,s),$n(r,t,s,-1))}return v0(),r=op(Error($(421))),pu(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=TC.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,un=us(s.nextSibling),hn=e,Pe=!0,Rn=null,t!==null&&(xn[wn++]=wr,xn[wn++]=br,xn[wn++]=xi,wr=t.id,br=t.overflow,xi=e),e=h0(e,r.children),e.flags|=4096,e)}function C1(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),pm(t.return,e,n)}function ap(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function A2(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Vt(t,e,r.children,n),r=Me.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&C1(t,n,e);else if(t.tag===19)C1(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ne(Me,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&vd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),ap(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&vd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}ap(e,!0,n,null,i);break;case"together":ap(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Fu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Rr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),bi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=ps(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ps(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function gC(t,e,n){switch(e.tag){case 3:j2(e),Ro();break;case 5:s2(e);break;case 1:rn(e.type)&&hd(e);break;case 4:s0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Ne(md,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ne(Me,Me.current&1),e.flags|=128,null):n&e.child.childLanes?D2(t,e,n):(Ne(Me,Me.current&1),t=Rr(t,e,n),t!==null?t.sibling:null);Ne(Me,Me.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return A2(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ne(Me,Me.current),r)break;return null;case 22:case 23:return e.lanes=0,T2(t,e,n)}return Rr(t,e,n)}var R2,_m,P2,O2;R2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};_m=function(){};P2=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ii(or.current);var i=null;switch(n){case"input":s=qp(t,s),r=qp(t,r),i=[];break;case"select":s=Ve({},s,{value:void 0}),r=Ve({},r,{value:void 0}),i=[];break;case"textarea":s=Gp(t,s),r=Gp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ud)}Qp(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(yl.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==a&&(c!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(yl.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Se("scroll",t),i||a===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};O2=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ta(t,e){if(!Pe)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function At(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function yC(t,e,n){var r=e.pendingProps;switch(Xg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return At(e),null;case 1:return rn(e.type)&&dd(),At(e),null;case 3:return r=e.stateNode,Oo(),je(nn),je(Mt),o0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(hu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Rn!==null&&(jm(Rn),Rn=null))),_m(t,e),At(e),null;case 5:i0(e);var s=ii(Cl.current);if(n=e.type,t!==null&&e.stateNode!=null)P2(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return At(e),null}if(t=ii(or.current),hu(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Kn]=e,r[Sl]=i,t=(e.mode&1)!==0,n){case"dialog":Se("cancel",r),Se("close",r);break;case"iframe":case"object":case"embed":Se("load",r);break;case"video":case"audio":for(s=0;s<qa.length;s++)Se(qa[s],r);break;case"source":Se("error",r);break;case"img":case"image":case"link":Se("error",r),Se("load",r);break;case"details":Se("toggle",r);break;case"input":Mv(r,i),Se("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Se("invalid",r);break;case"textarea":Vv(r,i),Se("invalid",r)}Qp(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&du(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&du(r.textContent,a,t),s=["children",""+a]):yl.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Se("scroll",r)}switch(n){case"input":ru(r),Fv(r,i,!0);break;case"textarea":ru(r),Uv(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ud)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=cb(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Kn]=e,t[Sl]=r,R2(t,e,!1,!1),e.stateNode=t;e:{switch(o=Yp(n,r),n){case"dialog":Se("cancel",t),Se("close",t),s=r;break;case"iframe":case"object":case"embed":Se("load",t),s=r;break;case"video":case"audio":for(s=0;s<qa.length;s++)Se(qa[s],t);s=r;break;case"source":Se("error",t),s=r;break;case"img":case"image":case"link":Se("error",t),Se("load",t),s=r;break;case"details":Se("toggle",t),s=r;break;case"input":Mv(t,r),s=qp(t,r),Se("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Ve({},r,{value:void 0}),Se("invalid",t);break;case"textarea":Vv(t,r),s=Gp(t,r),Se("invalid",t);break;default:s=r}Qp(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var c=a[i];i==="style"?hb(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&ub(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&vl(t,c):typeof c=="number"&&vl(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(yl.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Se("scroll",t):c!=null&&$g(t,i,c,o))}switch(n){case"input":ru(t),Fv(t,r,!1);break;case"textarea":ru(t),Uv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ys(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?yo(t,!!r.multiple,i,!1):r.defaultValue!=null&&yo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ud)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return At(e),null;case 6:if(t&&e.stateNode!=null)O2(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=ii(Cl.current),ii(or.current),hu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Kn]=e,(i=r.nodeValue!==n)&&(t=hn,t!==null))switch(t.tag){case 3:du(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&du(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Kn]=e,e.stateNode=r}return At(e),null;case 13:if(je(Me),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Pe&&un!==null&&e.mode&1&&!(e.flags&128))Zb(),Ro(),e.flags|=98560,i=!1;else if(i=hu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error($(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error($(317));i[Kn]=e}else Ro(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;At(e),i=!1}else Rn!==null&&(jm(Rn),Rn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Me.current&1?it===0&&(it=3):v0())),e.updateQueue!==null&&(e.flags|=4),At(e),null);case 4:return Oo(),_m(t,e),t===null&&El(e.stateNode.containerInfo),At(e),null;case 10:return t0(e.type._context),At(e),null;case 17:return rn(e.type)&&dd(),At(e),null;case 19:if(je(Me),i=e.memoizedState,i===null)return At(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Ta(i,!1);else{if(it!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=vd(t),o!==null){for(e.flags|=128,Ta(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ne(Me,Me.current&1|2),e.child}t=t.sibling}i.tail!==null&&Ke()>Lo&&(e.flags|=128,r=!0,Ta(i,!1),e.lanes=4194304)}else{if(!r)if(t=vd(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ta(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Pe)return At(e),null}else 2*Ke()-i.renderingStartTime>Lo&&n!==1073741824&&(e.flags|=128,r=!0,Ta(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ke(),e.sibling=null,n=Me.current,Ne(Me,r?n&1|2:n&1),e):(At(e),null);case 22:case 23:return y0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ln&1073741824&&(At(e),e.subtreeFlags&6&&(e.flags|=8192)):At(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function vC(t,e){switch(Xg(e),e.tag){case 1:return rn(e.type)&&dd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Oo(),je(nn),je(Mt),o0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return i0(e),null;case 13:if(je(Me),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));Ro()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return je(Me),null;case 4:return Oo(),null;case 10:return t0(e.type._context),null;case 22:case 23:return y0(),null;case 24:return null;default:return null}}var mu=!1,Ot=!1,xC=typeof WeakSet=="function"?WeakSet:Set,H=null;function fo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){qe(t,e,r)}else n.current=null}function Im(t,e,n){try{n()}catch(r){qe(t,e,r)}}var j1=!1;function wC(t,e){if(om=ad,t=Vb(),Qg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++u===s&&(a=o),f===i&&++d===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=a===-1||c===-1?null:{start:a,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(am={focusedElem:t,selectionRange:n},ad=!1,H=e;H!==null;)if(e=H,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,H=t;else for(;H!==null;){e=H;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var x=y.memoizedProps,w=y.memoizedState,g=e.stateNode,p=g.getSnapshotBeforeUpdate(e.elementType===e.type?x:Dn(e.type,x),w);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var v=e.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(b){qe(e,e.return,b)}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}return y=j1,j1=!1,y}function sl(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Im(e,n,i)}s=s.next}while(s!==r)}}function dh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Nm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function $2(t){var e=t.alternate;e!==null&&(t.alternate=null,$2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Kn],delete e[Sl],delete e[um],delete e[nC],delete e[rC])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function L2(t){return t.tag===5||t.tag===3||t.tag===4}function D1(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||L2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Em(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ud));else if(r!==4&&(t=t.child,t!==null))for(Em(t,e,n),t=t.sibling;t!==null;)Em(t,e,n),t=t.sibling}function km(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(km(t,e,n),t=t.sibling;t!==null;)km(t,e,n),t=t.sibling}var bt=null,An=!1;function Hr(t,e,n){for(n=n.child;n!==null;)M2(t,e,n),n=n.sibling}function M2(t,e,n){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(rh,n)}catch{}switch(n.tag){case 5:Ot||fo(n,e);case 6:var r=bt,s=An;bt=null,Hr(t,e,n),bt=r,An=s,bt!==null&&(An?(t=bt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):bt.removeChild(n.stateNode));break;case 18:bt!==null&&(An?(t=bt,n=n.stateNode,t.nodeType===8?ep(t.parentNode,n):t.nodeType===1&&ep(t,n),_l(t)):ep(bt,n.stateNode));break;case 4:r=bt,s=An,bt=n.stateNode.containerInfo,An=!0,Hr(t,e,n),bt=r,An=s;break;case 0:case 11:case 14:case 15:if(!Ot&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Im(n,e,o),s=s.next}while(s!==r)}Hr(t,e,n);break;case 1:if(!Ot&&(fo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){qe(n,e,a)}Hr(t,e,n);break;case 21:Hr(t,e,n);break;case 22:n.mode&1?(Ot=(r=Ot)||n.memoizedState!==null,Hr(t,e,n),Ot=r):Hr(t,e,n);break;default:Hr(t,e,n)}}function A1(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new xC),e.forEach(function(r){var s=CC.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function jn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:bt=a.stateNode,An=!1;break e;case 3:bt=a.stateNode.containerInfo,An=!0;break e;case 4:bt=a.stateNode.containerInfo,An=!0;break e}a=a.return}if(bt===null)throw Error($(160));M2(i,o,s),bt=null,An=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){qe(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)F2(e,t),e=e.sibling}function F2(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(jn(e,t),Wn(t),r&4){try{sl(3,t,t.return),dh(3,t)}catch(x){qe(t,t.return,x)}try{sl(5,t,t.return)}catch(x){qe(t,t.return,x)}}break;case 1:jn(e,t),Wn(t),r&512&&n!==null&&fo(n,n.return);break;case 5:if(jn(e,t),Wn(t),r&512&&n!==null&&fo(n,n.return),t.flags&32){var s=t.stateNode;try{vl(s,"")}catch(x){qe(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&ab(s,i),Yp(a,o);var u=Yp(a,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?hb(s,h):d==="dangerouslySetInnerHTML"?ub(s,h):d==="children"?vl(s,h):$g(s,d,h,u)}switch(a){case"input":Wp(s,i);break;case"textarea":lb(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?yo(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?yo(s,!!i.multiple,i.defaultValue,!0):yo(s,!!i.multiple,i.multiple?[]:"",!1))}s[Sl]=i}catch(x){qe(t,t.return,x)}}break;case 6:if(jn(e,t),Wn(t),r&4){if(t.stateNode===null)throw Error($(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){qe(t,t.return,x)}}break;case 3:if(jn(e,t),Wn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{_l(e.containerInfo)}catch(x){qe(t,t.return,x)}break;case 4:jn(e,t),Wn(t);break;case 13:jn(e,t),Wn(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(m0=Ke())),r&4&&A1(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Ot=(u=Ot)||d,jn(e,t),Ot=u):jn(e,t),Wn(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(H=t,d=t.child;d!==null;){for(h=H=d;H!==null;){switch(f=H,m=f.child,f.tag){case 0:case 11:case 14:case 15:sl(4,f,f.return);break;case 1:fo(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(x){qe(r,n,x)}}break;case 5:fo(f,f.return);break;case 22:if(f.memoizedState!==null){P1(h);continue}}m!==null?(m.return=f,H=m):P1(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=db("display",o))}catch(x){qe(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){qe(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:jn(e,t),Wn(t),r&4&&A1(t);break;case 21:break;default:jn(e,t),Wn(t)}}function Wn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(L2(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(vl(s,""),r.flags&=-33);var i=D1(t);km(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=D1(t);Em(t,a,o);break;default:throw Error($(161))}}catch(c){qe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function bC(t,e,n){H=t,V2(t)}function V2(t,e,n){for(var r=(t.mode&1)!==0;H!==null;){var s=H,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||mu;if(!o){var a=s.alternate,c=a!==null&&a.memoizedState!==null||Ot;a=mu;var u=Ot;if(mu=o,(Ot=c)&&!u)for(H=s;H!==null;)o=H,c=o.child,o.tag===22&&o.memoizedState!==null?O1(s):c!==null?(c.return=o,H=c):O1(s);for(;i!==null;)H=i,V2(i),i=i.sibling;H=s,mu=a,Ot=u}R1(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,H=i):R1(t)}}function R1(t){for(;H!==null;){var e=H;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ot||dh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ot)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Dn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&y1(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}y1(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&_l(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}Ot||e.flags&512&&Nm(e)}catch(f){qe(e,e.return,f)}}if(e===t){H=null;break}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}}function P1(t){for(;H!==null;){var e=H;if(e===t){H=null;break}var n=e.sibling;if(n!==null){n.return=e.return,H=n;break}H=e.return}}function O1(t){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{dh(4,e)}catch(c){qe(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){qe(e,s,c)}}var i=e.return;try{Nm(e)}catch(c){qe(e,i,c)}break;case 5:var o=e.return;try{Nm(e)}catch(c){qe(e,o,c)}}}catch(c){qe(e,e.return,c)}if(e===t){H=null;break}var a=e.sibling;if(a!==null){a.return=e.return,H=a;break}H=e.return}}var _C=Math.ceil,bd=Mr.ReactCurrentDispatcher,f0=Mr.ReactCurrentOwner,Nn=Mr.ReactCurrentBatchConfig,ue=0,dt=null,nt=null,Et=0,ln=0,po=Rs(0),it=0,Rl=null,bi=0,hh=0,p0=0,il=null,Xt=null,m0=0,Lo=1/0,vr=null,_d=!1,Sm=null,hs=null,gu=!1,ss=null,Id=0,ol=0,Tm=null,Vu=-1,Uu=0;function qt(){return ue&6?Ke():Vu!==-1?Vu:Vu=Ke()}function fs(t){return t.mode&1?ue&2&&Et!==0?Et&-Et:iC.transition!==null?(Uu===0&&(Uu=Nb()),Uu):(t=ve,t!==0||(t=window.event,t=t===void 0?16:Db(t.type)),t):1}function $n(t,e,n,r){if(50<ol)throw ol=0,Tm=null,Error($(185));cc(t,n,r),(!(ue&2)||t!==dt)&&(t===dt&&(!(ue&2)&&(hh|=n),it===4&&es(t,Et)),sn(t,r),n===1&&ue===0&&!(e.mode&1)&&(Lo=Ke()+500,lh&&Ps()))}function sn(t,e){var n=t.callbackNode;iT(t,e);var r=od(t,t===dt?Et:0);if(r===0)n!==null&&qv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&qv(n),e===1)t.tag===0?sC($1.bind(null,t)):Yb($1.bind(null,t)),eC(function(){!(ue&6)&&Ps()}),n=null;else{switch(Eb(r)){case 1:n=Ug;break;case 4:n=_b;break;case 16:n=id;break;case 536870912:n=Ib;break;default:n=id}n=K2(n,U2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function U2(t,e){if(Vu=-1,Uu=0,ue&6)throw Error($(327));var n=t.callbackNode;if(_o()&&t.callbackNode!==n)return null;var r=od(t,t===dt?Et:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Nd(t,r);else{e=r;var s=ue;ue|=2;var i=B2();(dt!==t||Et!==e)&&(vr=null,Lo=Ke()+500,di(t,e));do try{EC();break}catch(a){z2(t,a)}while(1);e0(),bd.current=i,ue=s,nt!==null?e=0:(dt=null,Et=0,e=it)}if(e!==0){if(e===2&&(s=tm(t),s!==0&&(r=s,e=Cm(t,s))),e===1)throw n=Rl,di(t,0),es(t,r),sn(t,Ke()),n;if(e===6)es(t,r);else{if(s=t.current.alternate,!(r&30)&&!IC(s)&&(e=Nd(t,r),e===2&&(i=tm(t),i!==0&&(r=i,e=Cm(t,i))),e===1))throw n=Rl,di(t,0),es(t,r),sn(t,Ke()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:Qs(t,Xt,vr);break;case 3:if(es(t,r),(r&130023424)===r&&(e=m0+500-Ke(),10<e)){if(od(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){qt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=cm(Qs.bind(null,t,Xt,vr),e);break}Qs(t,Xt,vr);break;case 4:if(es(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-On(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Ke()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_C(r/1960))-r,10<r){t.timeoutHandle=cm(Qs.bind(null,t,Xt,vr),r);break}Qs(t,Xt,vr);break;case 5:Qs(t,Xt,vr);break;default:throw Error($(329))}}}return sn(t,Ke()),t.callbackNode===n?U2.bind(null,t):null}function Cm(t,e){var n=il;return t.current.memoizedState.isDehydrated&&(di(t,e).flags|=256),t=Nd(t,e),t!==2&&(e=Xt,Xt=n,e!==null&&jm(e)),t}function jm(t){Xt===null?Xt=t:Xt.push.apply(Xt,t)}function IC(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Ln(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function es(t,e){for(e&=~p0,e&=~hh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-On(e),r=1<<n;t[n]=-1,e&=~r}}function $1(t){if(ue&6)throw Error($(327));_o();var e=od(t,0);if(!(e&1))return sn(t,Ke()),null;var n=Nd(t,e);if(t.tag!==0&&n===2){var r=tm(t);r!==0&&(e=r,n=Cm(t,r))}if(n===1)throw n=Rl,di(t,0),es(t,e),sn(t,Ke()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qs(t,Xt,vr),sn(t,Ke()),null}function g0(t,e){var n=ue;ue|=1;try{return t(e)}finally{ue=n,ue===0&&(Lo=Ke()+500,lh&&Ps())}}function _i(t){ss!==null&&ss.tag===0&&!(ue&6)&&_o();var e=ue;ue|=1;var n=Nn.transition,r=ve;try{if(Nn.transition=null,ve=1,t)return t()}finally{ve=r,Nn.transition=n,ue=e,!(ue&6)&&Ps()}}function y0(){ln=po.current,je(po)}function di(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,ZT(n)),nt!==null)for(n=nt.return;n!==null;){var r=n;switch(Xg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&dd();break;case 3:Oo(),je(nn),je(Mt),o0();break;case 5:i0(r);break;case 4:Oo();break;case 13:je(Me);break;case 19:je(Me);break;case 10:t0(r.type._context);break;case 22:case 23:y0()}n=n.return}if(dt=t,nt=t=ps(t.current,null),Et=ln=e,it=0,Rl=null,p0=hh=bi=0,Xt=il=null,si!==null){for(e=0;e<si.length;e++)if(n=si[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}si=null}return t}function z2(t,e){do{var n=nt;try{if(e0(),Lu.current=wd,xd){for(var r=Fe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}xd=!1}if(wi=0,ct=st=Fe=null,rl=!1,jl=0,f0.current=null,n===null||n.return===null){it=1,Rl=e,nt=null;break}e:{var i=t,o=n.return,a=n,c=e;if(e=Et,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=I1(o);if(m!==null){m.flags&=-257,N1(m,o,a,i,e),m.mode&1&&_1(i,u,e),e=m,c=u;var y=e.updateQueue;if(y===null){var x=new Set;x.add(c),e.updateQueue=x}else y.add(c);break e}else{if(!(e&1)){_1(i,u,e),v0();break e}c=Error($(426))}}else if(Pe&&a.mode&1){var w=I1(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),N1(w,o,a,i,e),Jg($o(c,a));break e}}i=c=$o(c,a),it!==4&&(it=2),il===null?il=[i]:il.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=E2(i,c,e);g1(i,g);break e;case 1:a=c;var p=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(hs===null||!hs.has(v)))){i.flags|=65536,e&=-e,i.lanes|=e;var b=k2(i,a,e);g1(i,b);break e}}i=i.return}while(i!==null)}W2(n)}catch(I){e=I,nt===n&&n!==null&&(nt=n=n.return);continue}break}while(1)}function B2(){var t=bd.current;return bd.current=wd,t===null?wd:t}function v0(){(it===0||it===3||it===2)&&(it=4),dt===null||!(bi&268435455)&&!(hh&268435455)||es(dt,Et)}function Nd(t,e){var n=ue;ue|=2;var r=B2();(dt!==t||Et!==e)&&(vr=null,di(t,e));do try{NC();break}catch(s){z2(t,s)}while(1);if(e0(),ue=n,bd.current=r,nt!==null)throw Error($(261));return dt=null,Et=0,it}function NC(){for(;nt!==null;)q2(nt)}function EC(){for(;nt!==null&&!YS();)q2(nt)}function q2(t){var e=G2(t.alternate,t,ln);t.memoizedProps=t.pendingProps,e===null?W2(t):nt=e,f0.current=null}function W2(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=vC(n,e),n!==null){n.flags&=32767,nt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{it=6,nt=null;return}}else if(n=yC(n,e,ln),n!==null){nt=n;return}if(e=e.sibling,e!==null){nt=e;return}nt=e=t}while(e!==null);it===0&&(it=5)}function Qs(t,e,n){var r=ve,s=Nn.transition;try{Nn.transition=null,ve=1,kC(t,e,n,r)}finally{Nn.transition=s,ve=r}return null}function kC(t,e,n,r){do _o();while(ss!==null);if(ue&6)throw Error($(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(oT(t,i),t===dt&&(nt=dt=null,Et=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||gu||(gu=!0,K2(id,function(){return _o(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Nn.transition,Nn.transition=null;var o=ve;ve=1;var a=ue;ue|=4,f0.current=null,wC(t,n),F2(n,t),HT(am),ad=!!om,am=om=null,t.current=n,bC(n),XS(),ue=a,ve=o,Nn.transition=i}else t.current=n;if(gu&&(gu=!1,ss=t,Id=s),i=t.pendingLanes,i===0&&(hs=null),eT(n.stateNode),sn(t,Ke()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(_d)throw _d=!1,t=Sm,Sm=null,t;return Id&1&&t.tag!==0&&_o(),i=t.pendingLanes,i&1?t===Tm?ol++:(ol=0,Tm=t):ol=0,Ps(),null}function _o(){if(ss!==null){var t=Eb(Id),e=Nn.transition,n=ve;try{if(Nn.transition=null,ve=16>t?16:t,ss===null)var r=!1;else{if(t=ss,ss=null,Id=0,ue&6)throw Error($(331));var s=ue;for(ue|=4,H=t.current;H!==null;){var i=H,o=i.child;if(H.flags&16){var a=i.deletions;if(a!==null){for(var c=0;c<a.length;c++){var u=a[c];for(H=u;H!==null;){var d=H;switch(d.tag){case 0:case 11:case 15:sl(8,d,i)}var h=d.child;if(h!==null)h.return=d,H=h;else for(;H!==null;){d=H;var f=d.sibling,m=d.return;if($2(d),d===u){H=null;break}if(f!==null){f.return=m,H=f;break}H=m}}}var y=i.alternate;if(y!==null){var x=y.child;if(x!==null){y.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}H=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,H=o;else e:for(;H!==null;){if(i=H,i.flags&2048)switch(i.tag){case 0:case 11:case 15:sl(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,H=g;break e}H=i.return}}var p=t.current;for(H=p;H!==null;){o=H;var v=o.child;if(o.subtreeFlags&2064&&v!==null)v.return=o,H=v;else e:for(o=p;H!==null;){if(a=H,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:dh(9,a)}}catch(I){qe(a,a.return,I)}if(a===o){H=null;break e}var b=a.sibling;if(b!==null){b.return=a.return,H=b;break e}H=a.return}}if(ue=s,Ps(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(rh,t)}catch{}r=!0}return r}finally{ve=n,Nn.transition=e}}return!1}function L1(t,e,n){e=$o(n,e),e=E2(t,e,1),t=ds(t,e,1),e=qt(),t!==null&&(cc(t,1,e),sn(t,e))}function qe(t,e,n){if(t.tag===3)L1(t,t,n);else for(;e!==null;){if(e.tag===3){L1(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(hs===null||!hs.has(r))){t=$o(n,t),t=k2(e,t,1),e=ds(e,t,1),t=qt(),e!==null&&(cc(e,1,t),sn(e,t));break}}e=e.return}}function SC(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=qt(),t.pingedLanes|=t.suspendedLanes&n,dt===t&&(Et&n)===n&&(it===4||it===3&&(Et&130023424)===Et&&500>Ke()-m0?di(t,0):p0|=n),sn(t,e)}function H2(t,e){e===0&&(t.mode&1?(e=ou,ou<<=1,!(ou&130023424)&&(ou=4194304)):e=1);var n=qt();t=Ar(t,e),t!==null&&(cc(t,e,n),sn(t,n))}function TC(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),H2(t,n)}function CC(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),H2(t,n)}var G2;G2=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||nn.current)Jt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Jt=!1,gC(t,e,n);Jt=!!(t.flags&131072)}else Jt=!1,Pe&&e.flags&1048576&&Xb(e,pd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Fu(t,e),t=e.pendingProps;var s=Ao(e,Mt.current);bo(e,n),s=l0(null,e,r,t,s,n);var i=c0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,rn(r)?(i=!0,hd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,r0(e),s.updater=uh,e.stateNode=s,s._reactInternals=e,gm(e,r,t,n),e=xm(null,e,r,!0,i,n)):(e.tag=0,Pe&&i&&Yg(e),Vt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Fu(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=DC(r),t=Dn(r,t),s){case 0:e=vm(null,e,r,t,n);break e;case 1:e=S1(null,e,r,t,n);break e;case 11:e=E1(null,e,r,t,n);break e;case 14:e=k1(null,e,r,Dn(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dn(r,s),vm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dn(r,s),S1(t,e,r,s,n);case 3:e:{if(j2(e),t===null)throw Error($(387));r=e.pendingProps,i=e.memoizedState,s=i.element,r2(t,e),yd(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=$o(Error($(423)),e),e=T1(t,e,r,n,s);break e}else if(r!==s){s=$o(Error($(424)),e),e=T1(t,e,r,n,s);break e}else for(un=us(e.stateNode.containerInfo.firstChild),hn=e,Pe=!0,Rn=null,n=t2(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ro(),r===s){e=Rr(t,e,n);break e}Vt(t,e,r,n)}e=e.child}return e;case 5:return s2(e),t===null&&fm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,lm(r,s)?o=null:i!==null&&lm(r,i)&&(e.flags|=32),C2(t,e),Vt(t,e,o,n),e.child;case 6:return t===null&&fm(e),null;case 13:return D2(t,e,n);case 4:return s0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Po(e,null,r,n):Vt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dn(r,s),E1(t,e,r,s,n);case 7:return Vt(t,e,e.pendingProps,n),e.child;case 8:return Vt(t,e,e.pendingProps.children,n),e.child;case 12:return Vt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Ne(md,r._currentValue),r._currentValue=o,i!==null)if(Ln(i.value,o)){if(i.children===s.children&&!nn.current){e=Rr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var c=a.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Sr(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),pm(i.return,n,e),a.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error($(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),pm(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Vt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,bo(e,n),s=En(s),r=r(s),e.flags|=1,Vt(t,e,r,n),e.child;case 14:return r=e.type,s=Dn(r,e.pendingProps),s=Dn(r.type,s),k1(t,e,r,s,n);case 15:return S2(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Dn(r,s),Fu(t,e),e.tag=1,rn(r)?(t=!0,hd(e)):t=!1,bo(e,n),N2(e,r,s),gm(e,r,s,n),xm(null,e,r,!0,t,n);case 19:return A2(t,e,n);case 22:return T2(t,e,n)}throw Error($(156,e.tag))};function K2(t,e){return bb(t,e)}function jC(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _n(t,e,n,r){return new jC(t,e,n,r)}function x0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function DC(t){if(typeof t=="function")return x0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Mg)return 11;if(t===Fg)return 14}return 2}function ps(t,e){var n=t.alternate;return n===null?(n=_n(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function zu(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")x0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ro:return hi(n.children,s,i,e);case Lg:o=8,s|=8;break;case Vp:return t=_n(12,n,e,s|2),t.elementType=Vp,t.lanes=i,t;case Up:return t=_n(13,n,e,s),t.elementType=Up,t.lanes=i,t;case zp:return t=_n(19,n,e,s),t.elementType=zp,t.lanes=i,t;case sb:return fh(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case nb:o=10;break e;case rb:o=9;break e;case Mg:o=11;break e;case Fg:o=14;break e;case Xr:o=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=_n(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function hi(t,e,n,r){return t=_n(7,t,r,e),t.lanes=n,t}function fh(t,e,n,r){return t=_n(22,t,r,e),t.elementType=sb,t.lanes=n,t.stateNode={isHidden:!1},t}function lp(t,e,n){return t=_n(6,t,null,e),t.lanes=n,t}function cp(t,e,n){return e=_n(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AC(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bf(0),this.expirationTimes=Bf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bf(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function w0(t,e,n,r,s,i,o,a,c){return t=new AC(t,e,n,a,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=_n(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},r0(i),t}function RC(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:no,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Q2(t){if(!t)return vs;t=t._reactInternals;e:{if(Li(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(rn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(rn(n))return Qb(t,n,e)}return e}function Y2(t,e,n,r,s,i,o,a,c){return t=w0(n,r,!0,t,s,i,o,a,c),t.context=Q2(null),n=t.current,r=qt(),s=fs(n),i=Sr(r,s),i.callback=e??null,ds(n,i,s),t.current.lanes=s,cc(t,s,r),sn(t,r),t}function ph(t,e,n,r){var s=e.current,i=qt(),o=fs(s);return n=Q2(n),e.context===null?e.context=n:e.pendingContext=n,e=Sr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ds(s,e,o),t!==null&&($n(t,s,o,i),$u(t,s,o)),o}function Ed(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function M1(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function b0(t,e){M1(t,e),(t=t.alternate)&&M1(t,e)}function PC(){return null}var X2=typeof reportError=="function"?reportError:function(t){console.error(t)};function _0(t){this._internalRoot=t}mh.prototype.render=_0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));ph(t,e,null,null)};mh.prototype.unmount=_0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;_i(function(){ph(null,t,null,null)}),e[Dr]=null}};function mh(t){this._internalRoot=t}mh.prototype.unstable_scheduleHydration=function(t){if(t){var e=Tb();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Zr.length&&e!==0&&e<Zr[n].priority;n++);Zr.splice(n,0,t),n===0&&jb(t)}};function I0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function gh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function F1(){}function OC(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Ed(o);i.call(u)}}var o=Y2(e,r,t,0,null,!1,!1,"",F1);return t._reactRootContainer=o,t[Dr]=o.current,El(t.nodeType===8?t.parentNode:t),_i(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=Ed(c);a.call(u)}}var c=w0(t,0,!1,null,null,!1,!1,"",F1);return t._reactRootContainer=c,t[Dr]=c.current,El(t.nodeType===8?t.parentNode:t),_i(function(){ph(e,c,n,r)}),c}function yh(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var c=Ed(o);a.call(c)}}ph(e,o,t,s)}else o=OC(n,e,t,s,r);return Ed(o)}kb=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ba(e.pendingLanes);n!==0&&(zg(e,n|1),sn(e,Ke()),!(ue&6)&&(Lo=Ke()+500,Ps()))}break;case 13:_i(function(){var r=Ar(t,1);if(r!==null){var s=qt();$n(r,t,1,s)}}),b0(t,1)}};Bg=function(t){if(t.tag===13){var e=Ar(t,134217728);if(e!==null){var n=qt();$n(e,t,134217728,n)}b0(t,134217728)}};Sb=function(t){if(t.tag===13){var e=fs(t),n=Ar(t,e);if(n!==null){var r=qt();$n(n,t,e,r)}b0(t,e)}};Tb=function(){return ve};Cb=function(t,e){var n=ve;try{return ve=t,e()}finally{ve=n}};Jp=function(t,e,n){switch(e){case"input":if(Wp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=ah(r);if(!s)throw Error($(90));ob(r),Wp(r,s)}}}break;case"textarea":lb(t,n);break;case"select":e=n.value,e!=null&&yo(t,!!n.multiple,e,!1)}};mb=g0;gb=_i;var $C={usingClientEntryPoint:!1,Events:[dc,ao,ah,fb,pb,g0]},Ca={findFiberByHostInstance:ri,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LC={bundleType:Ca.bundleType,version:Ca.version,rendererPackageName:Ca.rendererPackageName,rendererConfig:Ca.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Mr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=xb(t),t===null?null:t.stateNode},findFiberByHostInstance:Ca.findFiberByHostInstance||PC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yu.isDisabled&&yu.supportsFiber)try{rh=yu.inject(LC),ir=yu}catch{}}gn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=$C;gn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I0(e))throw Error($(200));return RC(t,e,null,n)};gn.createRoot=function(t,e){if(!I0(t))throw Error($(299));var n=!1,r="",s=X2;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=w0(t,1,!1,null,null,n,!1,r,s),t[Dr]=e.current,El(t.nodeType===8?t.parentNode:t),new _0(e)};gn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=xb(e),t=t===null?null:t.stateNode,t};gn.flushSync=function(t){return _i(t)};gn.hydrate=function(t,e,n){if(!gh(e))throw Error($(200));return yh(null,t,e,!0,n)};gn.hydrateRoot=function(t,e,n){if(!I0(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=X2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Y2(e,null,t,1,n??null,s,!1,i,o),t[Dr]=e.current,El(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new mh(e)};gn.render=function(t,e,n){if(!gh(e))throw Error($(200));return yh(null,t,e,!1,n)};gn.unmountComponentAtNode=function(t){if(!gh(t))throw Error($(40));return t._reactRootContainer?(_i(function(){yh(null,null,t,!1,function(){t._reactRootContainer=null,t[Dr]=null})}),!0):!1};gn.unstable_batchedUpdates=g0;gn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!gh(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return yh(t,e,n,!1,r)};gn.version="18.3.1-next-f1338f8080-20240426";function J2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(J2)}catch(t){console.error(t)}}J2(),Jw.exports=gn;var MC=Jw.exports,V1=MC;Mp.createRoot=V1.createRoot,Mp.hydrateRoot=V1.hydrateRoot;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z2=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},FC=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],a=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},e_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,a=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|a>>4;let f=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Z2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):FC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],a=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||a==null||u==null||h==null)throw new VC;const f=i<<2|a>>4;if(r.push(f),u!==64){const m=a<<4&240|u>>2;if(r.push(m),h!==64){const y=u<<6&192|h;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class VC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const UC=function(t){const e=Z2(t);return e_.encodeByteArray(e,!0)},kd=function(t){return UC(t).replace(/\./g,"")},t_=function(t){try{return e_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Sd(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!zC(n)||(t[n]=Sd(t[n],e[n]));return t}function zC(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qC=()=>BC().__FIREBASE_DEFAULTS__,WC=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},HC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&t_(t[1]);return e&&JSON.parse(e)},N0=()=>{try{return qC()||WC()||HC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},n_=()=>{var t;return(t=N0())===null||t===void 0?void 0:t.config},GC=t=>{var e;return(e=N0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[kd(JSON.stringify(n)),kd(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function YC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())}function E0(){var t;const e=(t=N0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function XC(){return typeof self=="object"&&self.self===self}function r_(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function k0(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function s_(){const t=Ue();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function JC(){return!E0()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Pl(){try{return typeof indexedDB=="object"}catch{return!1}}function ZC(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej="FirebaseError";class Wt extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=ej,Object.setPrototypeOf(this,Wt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Mi.prototype.create)}}class Mi{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?tj(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Wt(s,a,r)}}function tj(t,e){return t.replace(nj,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const nj=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U1(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function rj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Dm(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(z1(i)&&z1(o)){if(!Dm(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function z1(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function na(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function mo(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Wa(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function i_(t,e){const n=new sj(t,e);return n.subscribe.bind(n)}class sj{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");ij(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=up),s.error===void 0&&(s.error=up),s.complete===void 0&&(s.complete=up);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ij(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function up(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y(t){return t&&t._delegate?t._delegate:t}class ur{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oj{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new KC;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lj(e))try{this.getOrInitializeService({instanceIdentifier:Ys})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ys){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ys){return this.instances.has(e)}getOptions(e=Ys){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:aj(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ys){return this.component?this.component.multipleInstances?e:Ys:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function aj(t){return t===Ys?void 0:t}function lj(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new oj(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=[];var le;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(le||(le={}));const o_={debug:le.DEBUG,verbose:le.VERBOSE,info:le.INFO,warn:le.WARN,error:le.ERROR,silent:le.SILENT},uj=le.INFO,dj={[le.DEBUG]:"log",[le.VERBOSE]:"log",[le.INFO]:"info",[le.WARN]:"warn",[le.ERROR]:"error"},hj=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=dj[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class vh{constructor(e){this.name=e,this._logLevel=uj,this._logHandler=hj,this._userLogHandler=null,S0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in le))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?o_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,le.DEBUG,...e),this._logHandler(this,le.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,le.VERBOSE,...e),this._logHandler(this,le.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,le.INFO,...e),this._logHandler(this,le.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,le.WARN,...e),this._logHandler(this,le.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,le.ERROR,...e),this._logHandler(this,le.ERROR,...e)}}function fj(t){S0.forEach(e=>{e.setLogLevel(t)})}function pj(t,e){for(const n of S0){let r=null;e&&e.level&&(r=o_[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(s,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(r??s.logLevel)&&t({level:le[i].toLowerCase(),message:a,args:o,type:s.name})}}}const mj=(t,e)=>e.some(n=>t instanceof n);let B1,q1;function gj(){return B1||(B1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yj(){return q1||(q1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const a_=new WeakMap,Am=new WeakMap,l_=new WeakMap,dp=new WeakMap,T0=new WeakMap;function vj(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ms(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&a_.set(n,t)}).catch(()=>{}),T0.set(e,t),e}function xj(t){if(Am.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Am.set(t,e)}let Rm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Am.get(t);if(e==="objectStoreNames")return t.objectStoreNames||l_.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ms(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function wj(t){Rm=t(Rm)}function bj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(hp(this),e,...n);return l_.set(r,e.sort?e.sort():[e]),ms(r)}:yj().includes(t)?function(...e){return t.apply(hp(this),e),ms(a_.get(this))}:function(...e){return ms(t.apply(hp(this),e))}}function _j(t){return typeof t=="function"?bj(t):(t instanceof IDBTransaction&&xj(t),mj(t,gj())?new Proxy(t,Rm):t)}function ms(t){if(t instanceof IDBRequest)return vj(t);if(dp.has(t))return dp.get(t);const e=_j(t);return e!==t&&(dp.set(t,e),T0.set(e,t)),e}const hp=t=>T0.get(t);function Ij(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=ms(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ms(o.result),c.oldVersion,c.newVersion,ms(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),a.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}const Nj=["get","getKey","getAll","getAllKeys","count"],Ej=["put","add","delete","clear"],fp=new Map;function W1(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(fp.get(e))return fp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Ej.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Nj.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[n](...a),s&&c.done]))[0]};return fp.set(e,i),i}wj(t=>({...t,get:(e,n,r)=>W1(e,n)||t.get(e,n,r),has:(e,n)=>!!W1(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Sj(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Sj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Pm="@firebase/app",H1="0.9.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new vh("@firebase/app"),Tj="@firebase/app-compat",Cj="@firebase/analytics-compat",jj="@firebase/analytics",Dj="@firebase/app-check-compat",Aj="@firebase/app-check",Rj="@firebase/auth",Pj="@firebase/auth-compat",Oj="@firebase/database",$j="@firebase/database-compat",Lj="@firebase/functions",Mj="@firebase/functions-compat",Fj="@firebase/installations",Vj="@firebase/installations-compat",Uj="@firebase/messaging",zj="@firebase/messaging-compat",Bj="@firebase/performance",qj="@firebase/performance-compat",Wj="@firebase/remote-config",Hj="@firebase/remote-config-compat",Gj="@firebase/storage",Kj="@firebase/storage-compat",Qj="@firebase/firestore",Yj="@firebase/firestore-compat",Xj="firebase",Jj="9.23.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xs="[DEFAULT]",Zj={[Pm]:"fire-core",[Tj]:"fire-core-compat",[jj]:"fire-analytics",[Cj]:"fire-analytics-compat",[Aj]:"fire-app-check",[Dj]:"fire-app-check-compat",[Rj]:"fire-auth",[Pj]:"fire-auth-compat",[Oj]:"fire-rtdb",[$j]:"fire-rtdb-compat",[Lj]:"fire-fn",[Mj]:"fire-fn-compat",[Fj]:"fire-iid",[Vj]:"fire-iid-compat",[Uj]:"fire-fcm",[zj]:"fire-fcm-compat",[Bj]:"fire-perf",[qj]:"fire-perf-compat",[Wj]:"fire-rc",[Hj]:"fire-rc-compat",[Gj]:"fire-gcs",[Kj]:"fire-gcs-compat",[Qj]:"fire-fst",[Yj]:"fire-fst-compat","fire-js":"fire-js",[Xj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ws=new Map,Ol=new Map;function Td(t,e){try{t.container.addComponent(e)}catch(n){Ii.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function c_(t,e){t.container.addOrOverwriteComponent(e)}function bs(t){const e=t.name;if(Ol.has(e))return Ii.debug(`There were multiple attempts to register component ${e}.`),!1;Ol.set(e,t);for(const n of ws.values())Td(n,t);return!0}function u_(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function eD(t,e,n=xs){u_(t,e).clearInstance(n)}function tD(){Ol.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Tr=new Mi("app","Firebase",nD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rD=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ur("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Tr.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Os=Jj;function C0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:xs,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Tr.create("bad-app-name",{appName:String(s)});if(n||(n=n_()),!n)throw Tr.create("no-options");const i=ws.get(s);if(i){if(Dm(n,i.options)&&Dm(r,i.config))return i;throw Tr.create("duplicate-app",{appName:s})}const o=new cj(s);for(const c of Ol.values())o.addComponent(c);const a=new rD(n,r,o);return ws.set(s,a),a}function sD(t=xs){const e=ws.get(t);if(!e&&t===xs&&n_())return C0();if(!e)throw Tr.create("no-app",{appName:t});return e}function iD(){return Array.from(ws.values())}async function d_(t){const e=t.name;ws.has(e)&&(ws.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function ar(t,e,n){var r;let s=(r=Zj[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ii.warn(a.join(" "));return}bs(new ur(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}function h_(t,e){if(t!==null&&typeof t!="function")throw Tr.create("invalid-log-argument");pj(t,e)}function f_(t){fj(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oD="firebase-heartbeat-database",aD=1,$l="firebase-heartbeat-store";let pp=null;function p_(){return pp||(pp=Ij(oD,aD,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore($l)}}}).catch(t=>{throw Tr.create("idb-open",{originalErrorMessage:t.message})})),pp}async function lD(t){try{return await(await p_()).transaction($l).objectStore($l).get(m_(t))}catch(e){if(e instanceof Wt)Ii.warn(e.message);else{const n=Tr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ii.warn(n.message)}}}async function G1(t,e){try{const r=(await p_()).transaction($l,"readwrite");await r.objectStore($l).put(e,m_(t)),await r.done}catch(n){if(n instanceof Wt)Ii.warn(n.message);else{const r=Tr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ii.warn(r.message)}}}function m_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=1024,uD=30*24*60*60*1e3;class dD{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new fD(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=K1();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(s=>s.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const i=new Date(s.date).valueOf();return Date.now()-i<=uD}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=K1(),{heartbeatsToSend:n,unsentEntries:r}=hD(this._heartbeatsCache.heartbeats),s=kd(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function K1(){return new Date().toISOString().substring(0,10)}function hD(t,e=cD){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Q1(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Q1(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class fD{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Pl()?ZC().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await lD(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return G1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return G1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Q1(t){return kd(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pD(t){bs(new ur("platform-logger",e=>new kj(e),"PRIVATE")),bs(new ur("heartbeat",e=>new dD(e),"PRIVATE")),ar(Pm,H1,t),ar(Pm,H1,"esm2017"),ar("fire-js","")}pD("");const mD=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Wt,SDK_VERSION:Os,_DEFAULT_ENTRY_NAME:xs,_addComponent:Td,_addOrOverwriteComponent:c_,_apps:ws,_clearComponents:tD,_components:Ol,_getProvider:u_,_registerComponent:bs,_removeServiceInstance:eD,deleteApp:d_,getApp:sD,getApps:iD,initializeApp:C0,onLog:h_,registerVersion:ar,setLogLevel:f_},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gD{constructor(e,n){this._delegate=e,this.firebase=n,Td(e,new ur("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),d_(this._delegate)))}_getService(e,n=xs){var r;this._delegate.checkDestroyed();const s=this._delegate.container.getProvider(e);return!s.isInitialized()&&((r=s.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&s.initialize(),s.getImmediate({identifier:n})}_removeServiceInstance(e,n=xs){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Td(this._delegate,e)}_addOrOverwriteComponent(e){c_(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yD={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},Y1=new Mi("app-compat","Firebase",yD);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vD(t){const e={},n={__esModule:!0,initializeApp:i,app:s,registerVersion:ar,setLogLevel:f_,onLog:h_,apps:null,SDK_VERSION:Os,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:mD}};n.default=n,Object.defineProperty(n,"apps",{get:o});function r(u){delete e[u]}function s(u){if(u=u||xs,!U1(e,u))throw Y1.create("no-app",{appName:u});return e[u]}s.App=t;function i(u,d={}){const h=C0(u,d);if(U1(e,h.name))return e[h.name];const f=new t(h,n);return e[h.name]=f,f}function o(){return Object.keys(e).map(u=>e[u])}function a(u){const d=u.name,h=d.replace("-compat","");if(bs(u)&&u.type==="PUBLIC"){const f=(m=s())=>{if(typeof m[h]!="function")throw Y1.create("invalid-app-argument",{appName:d});return m[h]()};u.serviceProps!==void 0&&Sd(f,u.serviceProps),n[h]=f,t.prototype[h]=function(...m){return this._getService.bind(this,d).apply(this,u.multipleInstances?m:[])}}return u.type==="PUBLIC"?n[h]:null}function c(u,d){return d==="serverAuth"?null:d}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g_(){const t=vD(gD);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:g_,extendNamespace:e,createSubscribe:i_,ErrorFactory:Mi,deepExtend:Sd});function e(n){Sd(t,n)}return t}const xD=g_();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X1=new vh("@firebase/app-compat"),wD="@firebase/app-compat",bD="0.2.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(t){ar(wD,bD,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(XC()&&self.firebase!==void 0){X1.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&X1.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const Ie=xD;_D();var ID="firebase",ND="9.23.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ie.registerVersion(ID,ND,"app-compat");function j0(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}const ja={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Qi={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ED(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}}function y_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const kD=ED,SD=y_,v_=new Mi("auth","Firebase",y_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cd=new vh("@firebase/auth");function TD(t,...e){Cd.logLevel<=le.WARN&&Cd.warn(`Auth (${Os}): ${t}`,...e)}function Bu(t,...e){Cd.logLevel<=le.ERROR&&Cd.error(`Auth (${Os}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(t,...e){throw D0(t,...e)}function kt(t,...e){return D0(t,...e)}function x_(t,e,n){const r=Object.assign(Object.assign({},SD()),{[e]:n});return new Mi("auth","Firebase",r).create(e,{appName:t.name})}function ra(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ct(t,"argument-error"),x_(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function D0(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return v_.create(t,...e)}function L(t,e,...n){if(!t)throw D0(e,...n)}function er(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Bu(e),new Error(e)}function Mn(t,e){t||er(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ll(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function A0(){return J1()==="http:"||J1()==="https:"}function J1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(A0()||r_()||"connection"in navigator)?navigator.onLine:!0}function jD(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fc{constructor(e,n){this.shortDelay=e,this.longDelay=n,Mn(n>e,"Short delay should be less than long delay!"),this.isMobile=YC()||k0()}get(){return CD()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R0(t,e){Mn(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;er("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;er("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;er("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DD={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD=new fc(3e4,6e4);function rt(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function at(t,e,n,r,s={}){return b_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=na(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),w_.fetch()(__(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function b_(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},DD),e);try{const s=new RD(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Ha(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ha(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Ha(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Ha(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw x_(t,d,u);Ct(t,d)}}catch(s){if(s instanceof Wt)throw s;Ct(t,"network-request-failed",{message:String(s)})}}async function Fr(t,e,n,r,s={}){const i=await at(t,e,n,r,s);return"mfaPendingCredential"in i&&Ct(t,"multi-factor-auth-required",{_serverResponse:i}),i}function __(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?R0(t.config,s):`${t.config.apiScheme}://${s}`}class RD{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(kt(this.auth,"network-request-failed")),AD.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Ha(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=kt(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PD(t,e){return at(t,"POST","/v1/accounts:delete",e)}async function OD(t,e){return at(t,"POST","/v1/accounts:update",e)}async function $D(t,e){return at(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function al(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function LD(t,e=!1){const n=Y(t),r=await n.getIdToken(e),s=xh(r);L(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:al(mp(s.auth_time)),issuedAtTime:al(mp(s.iat)),expirationTime:al(mp(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function mp(t){return Number(t)*1e3}function xh(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Bu("JWT malformed, contained fewer than 3 sections"),null;try{const s=t_(n);return s?JSON.parse(s):(Bu("Failed to decode base64 JWT payload"),null)}catch(s){return Bu("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function MD(t){const e=xh(t);return L(e,"internal-error"),L(typeof e.exp<"u","internal-error"),L(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pr(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Wt&&FD(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function FD({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I_{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=al(this.lastLoginAt),this.creationTime=al(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Pr(t,$D(n,{idToken:r}));L(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?BD(i.providerUserInfo):[],a=zD(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new I_(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function UD(t){const e=Y(t);await Ml(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function zD(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function BD(t){return t.map(e=>{var{providerId:n}=e,r=j0(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qD(t,e){const n=await b_(t,{},async()=>{const r=na({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=__(t,s,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",w_.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){L(e.idToken,"internal-error"),L(typeof e.idToken<"u","internal-error"),L(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):MD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return L(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await qD(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Fl;return r&&(L(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(L(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(L(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Fl,this.toJSON())}_performRefresh(){return er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gr(t,e){L(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class fi{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=j0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new VD(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new I_(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Pr(this,this.stsTokenManager.getToken(this.auth,e));return L(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return LD(this,e)}reload(){return UD(this)}_assign(e){this!==e&&(L(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new fi(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){L(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Ml(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Pr(this,PD(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,a,c,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,y=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,w=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,g=(u=n.createdAt)!==null&&u!==void 0?u:void 0,p=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:v,emailVerified:b,isAnonymous:I,providerData:_,stsTokenManager:N}=n;L(v&&N,e,"internal-error");const C=Fl.fromJSON(this.name,N);L(typeof v=="string",e,"internal-error"),Gr(h,e.name),Gr(f,e.name),L(typeof b=="boolean",e,"internal-error"),L(typeof I=="boolean",e,"internal-error"),Gr(m,e.name),Gr(y,e.name),Gr(x,e.name),Gr(w,e.name),Gr(g,e.name),Gr(p,e.name);const R=new fi({uid:v,auth:e,email:f,emailVerified:b,displayName:h,isAnonymous:I,photoURL:y,phoneNumber:m,tenantId:x,stsTokenManager:C,createdAt:g,lastLoginAt:p});return _&&Array.isArray(_)&&(R.providerData=_.map(j=>Object.assign({},j))),w&&(R._redirectEventId=w),R}static async _fromIdTokenResponse(e,n,r=!1){const s=new Fl;s.updateFromServerResponse(n);const i=new fi({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Ml(i),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z1=new Map;function dn(t){Mn(t instanceof Function,"Expected a class definition");let e=Z1.get(t);return e?(Mn(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Z1.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}N_.type="NONE";const Mo=N_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pi(t,e,n){return`firebase:${t}:${e}:${n}`}class Io{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=pi(this.userKey,s.apiKey,i),this.fullPersistenceKey=pi("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?fi._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Io(dn(Mo),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||dn(Mo);const o=pi(r,e.config.apiKey,e.name);let a=null;for(const u of n)try{const d=await u._get(o);if(d){const h=fi._fromJSON(e,d);u!==i&&(a=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Io(i,e,r):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Io(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(S_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(E_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(T_(e))return"Blackberry";if(C_(e))return"Webos";if(P0(e))return"Safari";if((e.includes("chrome/")||k_(e))&&!e.includes("edge/"))return"Chrome";if(pc(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function E_(t=Ue()){return/firefox\//i.test(t)}function P0(t=Ue()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function k_(t=Ue()){return/crios\//i.test(t)}function S_(t=Ue()){return/iemobile/i.test(t)}function pc(t=Ue()){return/android/i.test(t)}function T_(t=Ue()){return/blackberry/i.test(t)}function C_(t=Ue()){return/webos/i.test(t)}function sa(t=Ue()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function WD(t=Ue()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function HD(t=Ue()){var e;return sa(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function GD(){return s_()&&document.documentMode===10}function j_(t=Ue()){return sa(t)||pc(t)||C_(t)||T_(t)||/windows phone/i.test(t)||S_(t)}function KD(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D_(t,e=[]){let n;switch(t){case"Browser":n=ex(Ue());break;case"Worker":n=`${ex(Ue())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Os}/${r}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QD(t){return(await at(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function A_(t,e){return at(t,"GET","/v2/recaptchaConfig",rt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tx(t){return t!==void 0&&t.getResponse!==void 0}function nx(t){return t!==void 0&&t.enterprise!==void 0}class R_{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(n=>n.provider==="EMAIL_PASSWORD_PROVIDER"&&n.enforcementState!=="OFF")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function O0(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=kt("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",YD().appendChild(r)})}function P_(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const XD="https://www.google.com/recaptcha/enterprise.js?render=",JD="recaptcha-enterprise",ZD="NO_RECAPTCHA";class O_{constructor(e){this.type=JD,this.auth=Je(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{A_(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const u=new R_(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})})}function s(i,o,a){const c=window.grecaptcha;nx(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(ZD)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!n&&nx(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}O0(XD+a).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function _s(t,e,n,r=!1){const s=new O_(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new rx(this),this.idTokenSubscription=new rx(this),this.beforeStateQueue=new eA(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=v_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=dn(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Io.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return L(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ml(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=jD()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?Y(e):null;return n&&L(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&L(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(dn(e))})}async initializeRecaptchaConfig(){const e=await A_(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),n=new R_(e);this.tenantId==null?this._agentRecaptchaConfig=n:this._tenantRecaptchaConfigs[this.tenantId]=n,n.emailPasswordEnabled&&new O_(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Mi("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&dn(e)||this._popupRedirectResolver;L(n,this,"argument-error"),this.redirectPersistenceManager=await Io.create(this,[dn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return L(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,r,s):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return L(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=D_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&TD(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Je(t){return Y(t)}class rx{constructor(e){this.auth=e,this.observer=null,this.addObserver=i_(n=>this.observer=n)}get next(){return L(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function nA(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(dn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function rA(t,e,n){const r=Je(t);L(r._canInitEmulator,r,"emulator-config-failed"),L(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=$_(e),{host:o,port:a}=sA(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||iA()}function $_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function sA(t){const e=$_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:sx(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:sx(o)}}}function sx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function iA(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return er("not implemented")}_getIdTokenResponse(e){return er("not implemented")}_linkToIdToken(e,n){return er("not implemented")}_getReauthenticationResolver(e){return er("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L_(t,e){return at(t,"POST","/v1/accounts:resetPassword",rt(t,e))}async function M_(t,e){return at(t,"POST","/v1/accounts:update",e)}async function oA(t,e){return at(t,"POST","/v1/accounts:update",rt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gp(t,e){return Fr(t,"POST","/v1/accounts:signInWithPassword",rt(t,e))}async function wh(t,e){return at(t,"POST","/v1/accounts:sendOobCode",rt(t,e))}async function aA(t,e){return wh(t,e)}async function yp(t,e){return wh(t,e)}async function vp(t,e){return wh(t,e)}async function lA(t,e){return wh(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cA(t,e){return Fr(t,"POST","/v1/accounts:signInWithEmailLink",rt(t,e))}async function uA(t,e){return Fr(t,"POST","/v1/accounts:signInWithEmailLink",rt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl extends ia{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Vl(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Vl(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){var n;switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((n=e._getRecaptchaConfig())===null||n===void 0)&&n.emailPasswordEnabled){const s=await _s(e,r,"signInWithPassword");return gp(e,s)}else return gp(e,r).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const i=await _s(e,r,"signInWithPassword");return gp(e,i)}else return Promise.reject(s)});case"emailLink":return cA(e,{email:this._email,oobCode:this._password});default:Ct(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return M_(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return uA(e,{idToken:n,email:this._email,oobCode:this._password});default:Ct(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cr(t,e){return Fr(t,"POST","/v1/accounts:signInWithIdp",rt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dA="http://localhost";class dr extends ia{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new dr(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Ct("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=j0(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new dr(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Cr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Cr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Cr(e,n)}buildRequest(){const e={requestUri:dA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=na(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hA(t,e){return at(t,"POST","/v1/accounts:sendVerificationCode",rt(t,e))}async function fA(t,e){return Fr(t,"POST","/v1/accounts:signInWithPhoneNumber",rt(t,e))}async function pA(t,e){const n=await Fr(t,"POST","/v1/accounts:signInWithPhoneNumber",rt(t,e));if(n.temporaryProof)throw Ha(t,"account-exists-with-different-credential",n);return n}const mA={USER_NOT_FOUND:"user-not-found"};async function gA(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Fr(t,"POST","/v1/accounts:signInWithPhoneNumber",rt(t,n),mA)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends ia{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new mi({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new mi({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return fA(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return pA(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return gA(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:r,verificationCode:s}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:r,code:s}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i}=e;return!r&&!n&&!s&&!i?null:new mi({verificationId:n,verificationCode:r,phoneNumber:s,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function vA(t){const e=mo(Wa(t)).link,n=e?mo(Wa(e)).deep_link_id:null,r=mo(Wa(t)).deep_link_id;return(r?mo(Wa(r)).link:null)||r||n||e||t}class bh{constructor(e){var n,r,s,i,o,a;const c=mo(Wa(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=yA((s=c.mode)!==null&&s!==void 0?s:null);L(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=vA(e);try{return new bh(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s{constructor(){this.providerId=$s.PROVIDER_ID}static credential(e,n){return Vl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=bh.parseLink(n);return L(r,"argument-error"),Vl._fromEmailAndCode(e,r.code,r.tenantId)}}$s.PROVIDER_ID="password";$s.EMAIL_PASSWORD_SIGN_IN_METHOD="password";$s.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oa extends Vr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class No extends oa{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return L("providerId"in n&&"signInMethod"in n,"argument-error"),dr._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return L(e.idToken||e.accessToken,"argument-error"),dr._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return No.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return No.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:s,pendingToken:i,nonce:o,providerId:a}=e;if(!r&&!s&&!n&&!i||!a)return null;try{return new No(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn extends oa{constructor(){super("facebook.com")}static credential(e){return dr._fromParams({providerId:Qn.PROVIDER_ID,signInMethod:Qn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qn.credentialFromTaggedObject(e)}static credentialFromError(e){return Qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qn.credential(e.oauthAccessToken)}catch{return null}}}Qn.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn extends oa{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return dr._fromParams({providerId:Yn.PROVIDER_ID,signInMethod:Yn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Yn.credentialFromTaggedObject(e)}static credentialFromError(e){return Yn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Yn.credential(n,r)}catch{return null}}}Yn.GOOGLE_SIGN_IN_METHOD="google.com";Yn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn extends oa{constructor(){super("github.com")}static credential(e){return dr._fromParams({providerId:Xn.PROVIDER_ID,signInMethod:Xn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xn.credentialFromTaggedObject(e)}static credentialFromError(e){return Xn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xn.credential(e.oauthAccessToken)}catch{return null}}}Xn.GITHUB_SIGN_IN_METHOD="github.com";Xn.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xA="http://localhost";class Fo extends ia{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return Cr(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Cr(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Cr(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s,pendingToken:i}=n;return!r||!s||!i||r!==s?null:new Fo(r,i)}static _create(e,n){return new Fo(e,n)}buildRequest(){return{requestUri:xA,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA="saml.";class jd extends Vr{constructor(e){L(e.startsWith(wA),"argument-error"),super(e)}static credentialFromResult(e){return jd.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return jd.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=Fo.fromJSON(e);return L(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:r}=e;if(!n||!r)return null;try{return Fo._create(r,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn extends oa{constructor(){super("twitter.com")}static credential(e,n){return dr._fromParams({providerId:Jn.PROVIDER_ID,signInMethod:Jn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Jn.credentialFromTaggedObject(e)}static credentialFromError(e){return Jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Jn.credential(n,r)}catch{return null}}}Jn.TWITTER_SIGN_IN_METHOD="twitter.com";Jn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qu(t,e){return Fr(t,"POST","/v1/accounts:signUp",rt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await fi._fromIdTokenResponse(e,r,s),o=ix(r);return new Sn({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=ix(r);return new Sn({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function ix(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bA(t){var e;const n=Je(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new Sn({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await qu(n,{returnSecureToken:!0}),s=await Sn._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dd extends Wt{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Dd.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Dd(e,n,r,s)}}function F_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Dd._fromErrorAndOperation(t,i,e,r):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V_(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _A(t,e){const n=Y(t);await _h(!0,n,e);const{providerUserInfo:r}=await OD(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),s=V_(r||[]);return n.providerData=n.providerData.filter(i=>s.has(i.providerId)),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function $0(t,e,n=!1){const r=await Pr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Sn._forOperation(t,"link",r)}async function _h(t,e,n){await Ml(e);const r=V_(e.providerData),s=t===!1?"provider-already-linked":"no-such-provider";L(r.has(n)===t,e.auth,s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U_(t,e,n=!1){const{auth:r}=t,s="reauthenticate";try{const i=await Pr(t,F_(r,s,e,t),n);L(i.idToken,r,"internal-error");const o=xh(i.idToken);L(o,r,"internal-error");const{sub:a}=o;return L(t.uid===a,r,"user-mismatch"),Sn._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Ct(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function z_(t,e,n=!1){const r="signIn",s=await F_(t,r,e),i=await Sn._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Ih(t,e){return z_(Je(t),e)}async function B_(t,e){const n=Y(t);return await _h(!1,n,e.providerId),$0(n,e)}async function q_(t,e){return U_(Y(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function IA(t,e){return Fr(t,"POST","/v1/accounts:signInWithCustomToken",rt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NA(t,e){const n=Je(t),r=await IA(n,{token:e,returnSecureToken:!0}),s=await Sn._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(s.user),s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mc{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?L0._fromServerResponse(e,n):"totpInfo"in n?M0._fromServerResponse(e,n):Ct(e,"internal-error")}}class L0 extends mc{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new L0(n)}}class M0 extends mc{constructor(e){super("totp",e)}static _fromServerResponse(e,n){return new M0(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eo(t,e,n){var r;L(((r=n.url)===null||r===void 0?void 0:r.length)>0,t,"invalid-continue-uri"),L(typeof n.dynamicLinkDomain>"u"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(L(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(L(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function EA(t,e,n){var r;const s=Je(t),i={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(!((r=s._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const o=await _s(s,i,"getOobCode",!0);n&&Eo(s,o,n),await yp(s,o)}else n&&Eo(s,i,n),await yp(s,i).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");const a=await _s(s,i,"getOobCode",!0);n&&Eo(s,a,n),await yp(s,a)}else return Promise.reject(o)})}async function kA(t,e,n){await L_(Y(t),{oobCode:e,newPassword:n})}async function SA(t,e){await oA(Y(t),{oobCode:e})}async function W_(t,e){const n=Y(t),r=await L_(n,{oobCode:e}),s=r.requestType;switch(L(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":L(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":L(r.mfaInfo,n,"internal-error");default:L(r.email,n,"internal-error")}let i=null;return r.mfaInfo&&(i=mc._fromServerResponse(Je(n),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:i},operation:s}}async function TA(t,e){const{data:n}=await W_(Y(t),e);return n.email}async function CA(t,e,n){var r;const s=Je(t),i={returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"};let o;if(!((r=s._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const u=await _s(s,i,"signUpPassword");o=qu(s,u)}else o=qu(s,i).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");const d=await _s(s,i,"signUpPassword");return qu(s,d)}else return Promise.reject(u)});const a=await o.catch(u=>Promise.reject(u)),c=await Sn._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(c.user),c}function jA(t,e,n){return Ih(Y(t),$s.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DA(t,e,n){var r;const s=Je(t),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(a,c){L(c.handleCodeInApp,s,"argument-error"),c&&Eo(s,a,c)}if(!((r=s._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){const a=await _s(s,i,"getOobCode",!0);o(a,n),await vp(s,a)}else o(i,n),await vp(s,i).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");const c=await _s(s,i,"getOobCode",!0);o(c,n),await vp(s,c)}else return Promise.reject(a)})}function AA(t,e){const n=bh.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function RA(t,e,n){const r=Y(t),s=$s.credentialWithLink(e,n||Ll());return L(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Ih(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PA(t,e){return at(t,"POST","/v1/accounts:createAuthUri",rt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OA(t,e){const n=A0()?Ll():"http://localhost",r={identifier:e,continueUri:n},{signinMethods:s}=await PA(Y(t),r);return s||[]}async function $A(t,e){const n=Y(t),s={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};e&&Eo(n.auth,s,e);const{email:i}=await aA(n.auth,s);i!==t.email&&await t.reload()}async function LA(t,e,n){const r=Y(t),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:e};n&&Eo(r.auth,i,n);const{email:o}=await lA(r.auth,i);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MA(t,e){return at(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FA(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Y(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Pr(r,MA(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function VA(t,e){return H_(Y(t),e,null)}function UA(t,e){return H_(Y(t),null,e)}async function H_(t,e,n){const{auth:r}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await Pr(t,M_(r,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(t){var e,n;if(!t)return null;const{providerId:r}=t,s=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},i=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&(t!=null&&t.idToken)){const o=(n=(e=xh(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new ko(i,a)}}if(!r)return null;switch(r){case"facebook.com":return new BA(i,s);case"github.com":return new qA(i,s);case"google.com":return new WA(i,s);case"twitter.com":return new HA(i,s,t.screenName||null);case"custom":case"anonymous":return new ko(i,null);default:return new ko(i,r,s)}}class ko{constructor(e,n,r={}){this.isNewUser=e,this.providerId=n,this.profile=r}}class G_ extends ko{constructor(e,n,r,s){super(e,n,r),this.username=s}}class BA extends ko{constructor(e,n){super(e,"facebook.com",n)}}class qA extends G_{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class WA extends ko{constructor(e,n){super(e,"google.com",n)}}class HA extends G_{constructor(e,n,r){super(e,"twitter.com",n,r)}}function GA(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:zA(n)}class oi{constructor(e,n,r){this.type=e,this.credential=n,this.auth=r}static _fromIdtoken(e,n){return new oi("enroll",e,n)}static _fromMfaPendingCredential(e){return new oi("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,r;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return oi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return oi._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,n,r){this.session=e,this.hints=n,this.signInResolver=r}static _fromError(e,n){const r=Je(e),s=n.customData._serverResponse,i=(s.mfaInfo||[]).map(a=>mc._fromServerResponse(r,a));L(s.mfaPendingCredential,r,"internal-error");const o=oi._fromMfaPendingCredential(s.mfaPendingCredential);return new F0(o,i,async a=>{const c=await a._process(r,o);delete s.mfaInfo,delete s.mfaPendingCredential;const u=Object.assign(Object.assign({},s),{idToken:c.idToken,refreshToken:c.refreshToken});switch(n.operationType){case"signIn":const d=await Sn._fromIdTokenResponse(r,n.operationType,u);return await r._updateCurrentUser(d.user),d;case"reauthenticate":return L(n.user,r,"internal-error"),Sn._forOperation(n.user,n.operationType,u);default:Ct(r,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function KA(t,e){var n;const r=Y(t),s=e;return L(e.customData.operationType,r,"argument-error"),L((n=s.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,r,"argument-error"),F0._fromError(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QA(t,e){return at(t,"POST","/v2/accounts/mfaEnrollment:start",rt(t,e))}function YA(t,e){return at(t,"POST","/v2/accounts/mfaEnrollment:finalize",rt(t,e))}function XA(t,e){return at(t,"POST","/v2/accounts/mfaEnrollment:withdraw",rt(t,e))}class V0{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(r=>mc._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new V0(e)}async getSession(){return oi._fromIdtoken(await this.user.getIdToken(),this.user.auth)}async enroll(e,n){const r=e,s=await this.getSession(),i=await Pr(this.user,r._process(this.user.auth,s,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{const s=await Pr(this.user,XA(this.user.auth,{idToken:r,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==n),await this.user._updateTokensIfNecessary(s),await this.user.reload()}catch(s){throw s}}}const xp=new WeakMap;function JA(t){const e=Y(t);return xp.has(e)||xp.set(e,V0._fromUser(e)),xp.get(e)}const Ad="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Ad,"1"),this.storage.removeItem(Ad),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZA(){const t=Ue();return P0(t)||sa(t)}const e4=1e3,t4=10;class Q_ extends K_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=ZA()&&KD(),this.fallbackToPolling=j_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);GD()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,t4):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},e4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Q_.type="LOCAL";const U0=Q_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_ extends K_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Y_.type="SESSION";const Ni=Y_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n4(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new Nh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async u=>u(n.origin,i)),c=await n4(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gc(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const u=gc("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tt(){return window}function s4(t){tt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z0(){return typeof tt().WorkerGlobalScope<"u"&&typeof tt().importScripts=="function"}async function i4(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function o4(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function a4(){return z0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_="firebaseLocalStorageDb",l4=1,Rd="firebaseLocalStorage",J_="fbase_key";class yc{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Eh(t,e){return t.transaction([Rd],e?"readwrite":"readonly").objectStore(Rd)}function c4(){const t=indexedDB.deleteDatabase(X_);return new yc(t).toPromise()}function Om(){const t=indexedDB.open(X_,l4);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Rd,{keyPath:J_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Rd)?e(r):(r.close(),await c4(),e(await Om()))})})}async function ox(t,e,n){const r=Eh(t,!0).put({[J_]:e,value:n});return new yc(r).toPromise()}async function u4(t,e){const n=Eh(t,!1).get(e),r=await new yc(n).toPromise();return r===void 0?null:r.value}function ax(t,e){const n=Eh(t,!0).delete(e);return new yc(n).toPromise()}const d4=800,h4=3;class Z_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Om(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>h4)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return z0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nh._getInstance(a4()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await i4(),!this.activeServiceWorker)return;this.sender=new r4(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||o4()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Om();return await ox(e,Ad,"1"),await ax(e,Ad),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ox(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>u4(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>ax(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Eh(s,!1).getAll();return new yc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),d4)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Z_.type="LOCAL";const Ul=Z_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f4(t,e){return at(t,"POST","/v2/accounts/mfaSignIn:start",rt(t,e))}function p4(t,e){return at(t,"POST","/v2/accounts/mfaSignIn:finalize",rt(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4=500,g4=6e4,vu=1e12;class y4{constructor(e){this.auth=e,this.counter=vu,this._widgets=new Map}render(e,n){const r=this.counter;return this._widgets.set(r,new v4(e,this.auth.name,n||{})),this.counter++,r}reset(e){var n;const r=e||vu;(n=this._widgets.get(r))===null||n===void 0||n.delete(),this._widgets.delete(r)}getResponse(e){var n;const r=e||vu;return((n=this._widgets.get(r))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const r=e||vu;return(n=this._widgets.get(r))===null||n===void 0||n.execute(),""}}class v4{constructor(e,n,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const s=typeof e=="string"?document.getElementById(e):e;L(s,"argument-error",{appName:n}),this.container=s,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=x4(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},g4)},m4))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function x4(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<t;r++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wp=P_("rcb"),w4=new fc(3e4,6e4),b4="https://www.google.com/recaptcha/api.js?";class _4{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=tt().grecaptcha)===null||e===void 0)&&e.render)}load(e,n=""){return L(I4(n),e,"argument-error"),this.shouldResolveImmediately(n)&&tx(tt().grecaptcha)?Promise.resolve(tt().grecaptcha):new Promise((r,s)=>{const i=tt().setTimeout(()=>{s(kt(e,"network-request-failed"))},w4.get());tt()[wp]=()=>{tt().clearTimeout(i),delete tt()[wp];const a=tt().grecaptcha;if(!a||!tx(a)){s(kt(e,"internal-error"));return}const c=a.render;a.render=(u,d)=>{const h=c(u,d);return this.counter++,h},this.hostLanguage=n,r(a)};const o=`${b4}?${na({onload:wp,render:"explicit",hl:n})}`;O0(o).catch(()=>{clearTimeout(i),s(kt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var n;return!!(!((n=tt().grecaptcha)===null||n===void 0)&&n.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function I4(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class N4{async load(e){return new y4(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI="recaptcha",E4={theme:"light",type:"image"};let k4=class{constructor(e,n=Object.assign({},E4),r){this.parameters=n,this.type=eI,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Je(r),this.isInvisible=this.parameters.size==="invisible",L(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const s=typeof e=="string"?document.getElementById(e):e;L(s,this.auth,"argument-error"),this.container=s,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new N4:new _4,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),r=n.getResponse(e);return r||new Promise(s=>{const i=o=>{o&&(this.tokenChangeListeners.delete(i),s(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){L(!this.parameters.sitekey,this.auth,"argument-error"),L(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),L(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(r=>r(n)),typeof e=="function")e(n);else if(typeof e=="string"){const r=tt()[e];typeof r=="function"&&r(n)}}}assertNotDestroyed(){L(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){L(A0()&&!z0(),this.auth,"internal-error"),await S4(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await QD(this.auth);L(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return L(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function S4(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B0{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=mi._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function T4(t,e,n){const r=Je(t),s=await kh(r,e,Y(n));return new B0(s,i=>Ih(r,i))}async function C4(t,e,n){const r=Y(t);await _h(!1,r,"phone");const s=await kh(r.auth,e,Y(n));return new B0(s,i=>B_(r,i))}async function j4(t,e,n){const r=Y(t),s=await kh(r.auth,e,Y(n));return new B0(s,i=>q_(r,i))}async function kh(t,e,n){var r;const s=await n.verify();try{L(typeof s=="string",t,"argument-error"),L(n.type===eI,t,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return L(o.type==="enroll",t,"internal-error"),(await QA(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:s}})).phoneSessionInfo.sessionInfo;{L(o.type==="signin",t,"internal-error");const a=((r=i.multiFactorHint)===null||r===void 0?void 0:r.uid)||i.multiFactorUid;return L(a,t,"missing-multi-factor-info"),(await f4(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:s}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await hA(t,{phoneNumber:i.phoneNumber,recaptchaToken:s});return o}}finally{n._reset()}}async function D4(t,e){await $0(Y(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ei=class Wu{constructor(e){this.providerId=Wu.PROVIDER_ID,this.auth=Je(e)}verifyPhoneNumber(e,n){return kh(this.auth,e,Y(n))}static credential(e,n){return mi._fromVerification(e,n)}static credentialFromResult(e){const n=e;return Wu.credentialFromTaggedObject(n)}static credentialFromError(e){return Wu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:r}=e;return n&&r?mi._fromTokenResponse(n,r):null}};Ei.PROVIDER_ID="phone";Ei.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fi(t,e){return e?dn(e):(L(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0 extends ia{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Cr(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Cr(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Cr(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function A4(t){return z_(t.auth,new q0(t),t.bypassAuthState)}function R4(t){const{auth:e,user:n}=t;return L(n,e,"internal-error"),U_(n,new q0(t),t.bypassAuthState)}async function P4(t){const{auth:e,user:n}=t;return L(n,e,"internal-error"),$0(n,new q0(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return A4;case"linkViaPopup":case"linkViaRedirect":return P4;case"reauthViaPopup":case"reauthViaRedirect":return R4;default:Ct(this.auth,"internal-error")}}resolve(e){Mn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Mn(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4=new fc(2e3,1e4);async function $4(t,e,n){const r=Je(t);ra(t,e,Vr);const s=Fi(r,n);return new _r(r,"signInViaPopup",e,s).executeNotNull()}async function L4(t,e,n){const r=Y(t);ra(r.auth,e,Vr);const s=Fi(r.auth,n);return new _r(r.auth,"reauthViaPopup",e,s,r).executeNotNull()}async function M4(t,e,n){const r=Y(t);ra(r.auth,e,Vr);const s=Fi(r.auth,n);return new _r(r.auth,"linkViaPopup",e,s,r).executeNotNull()}class _r extends tI{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,_r.currentPopupAction&&_r.currentPopupAction.cancel(),_r.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return L(e,this.auth,"internal-error"),e}async onExecution(){Mn(this.filter.length===1,"Popup operations only handle one event");const e=gc();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(kt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(kt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_r.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(kt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,O4.get())};e()}}_r.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F4="pendingRedirect",ll=new Map;class V4 extends tI{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ll.get(this.auth._key());if(!e){try{const r=await U4(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ll.set(this.auth._key(),e)}return this.bypassAuthState||ll.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function U4(t,e){const n=rI(e),r=nI(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}async function W0(t,e){return nI(t)._set(rI(e),"true")}function z4(){ll.clear()}function H0(t,e){ll.set(t._key(),e)}function nI(t){return dn(t._redirectPersistence)}function rI(t){return pi(F4,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B4(t,e,n){return q4(t,e,n)}async function q4(t,e,n){const r=Je(t);ra(t,e,Vr),await r._initializationPromise;const s=Fi(r,n);return await W0(s,r),s._openRedirect(r,e,"signInViaRedirect")}function W4(t,e,n){return H4(t,e,n)}async function H4(t,e,n){const r=Y(t);ra(r.auth,e,Vr),await r.auth._initializationPromise;const s=Fi(r.auth,n);await W0(s,r.auth);const i=await sI(r);return s._openRedirect(r.auth,e,"reauthViaRedirect",i)}function G4(t,e,n){return K4(t,e,n)}async function K4(t,e,n){const r=Y(t);ra(r.auth,e,Vr),await r.auth._initializationPromise;const s=Fi(r.auth,n);await _h(!1,r,e.providerId),await W0(s,r.auth);const i=await sI(r);return s._openRedirect(r.auth,e,"linkViaRedirect",i)}async function Q4(t,e){return await Je(t)._initializationPromise,Sh(t,e,!1)}async function Sh(t,e,n=!1){const r=Je(t),s=Fi(r,e),o=await new V4(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function sI(t){const e=gc(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y4=10*60*1e3;class iI{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!X4(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!oI(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(kt(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Y4&&this.cachedEventUids.clear(),this.cachedEventUids.has(lx(e))}saveEventToCache(e){this.cachedEventUids.add(lx(e)),this.lastProcessedEventTime=Date.now()}}function lx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function oI({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function X4(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return oI(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aI(t,e={}){return at(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J4=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Z4=/^https?/;async function eR(t){if(t.config.emulator)return;const{authorizedDomains:e}=await aI(t);for(const n of e)try{if(tR(n))return}catch{}Ct(t,"unauthorized-domain")}function tR(t){const e=Ll(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!Z4.test(n))return!1;if(J4.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nR=new fc(3e4,6e4);function cx(){const t=tt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function rR(t){return new Promise((e,n)=>{var r,s,i;function o(){cx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cx(),n(kt(t,"network-request-failed"))},timeout:nR.get()})}if(!((s=(r=tt().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=tt().gapi)===null||i===void 0)&&i.load)o();else{const a=P_("iframefcb");return tt()[a]=()=>{gapi.load?o():n(kt(t,"network-request-failed"))},O0(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Hu=null,e})}let Hu=null;function sR(t){return Hu=Hu||rR(t),Hu}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iR=new fc(5e3,15e3),oR="__/auth/iframe",aR="emulator/auth/iframe",lR={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},cR=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function uR(t){const e=t.config;L(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?R0(e,aR):`https://${t.config.authDomain}/${oR}`,r={apiKey:e.apiKey,appName:t.name,v:Os},s=cR.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${na(r).slice(1)}`}async function dR(t){const e=await sR(t),n=tt().gapi;return L(n,t,"internal-error"),e.open({where:document.body,url:uR(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:lR,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=kt(t,"network-request-failed"),a=tt().setTimeout(()=>{i(o)},iR.get());function c(){tt().clearTimeout(a),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},fR=500,pR=600,mR="_blank",gR="http://localhost";class ux{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function yR(t,e,n,r=fR,s=pR){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c=Object.assign(Object.assign({},hR),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Ue().toLowerCase();n&&(a=k_(u)?mR:n),E_(u)&&(e=e||gR,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[m,y])=>`${f}${m}=${y},`,"");if(HD(u)&&a!=="_self")return vR(e||"",a),new ux(null);const h=window.open(e||"",a,d);L(h,t,"popup-blocked");try{h.focus()}catch{}return new ux(h)}function vR(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xR="__/auth/handler",wR="emulator/auth/handler",bR=encodeURIComponent("fac");async function $m(t,e,n,r,s,i){L(t.config.authDomain,t,"auth-domain-config-required"),L(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Os,eventId:s};if(e instanceof Vr){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",rj(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof oa){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const c=await t._getAppCheckToken(),u=c?`#${bR}=${encodeURIComponent(c)}`:"";return`${_R(t)}?${na(a).slice(1)}${u}`}function _R({config:t}){return t.emulator?R0(t,wR):`https://${t.authDomain}/${xR}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bp="webStorageSupport";class IR{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ni,this._completeRedirectFn=Sh,this._overrideRedirectResult=H0}async _openPopup(e,n,r,s){var i;Mn((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await $m(e,n,r,Ll(),s);return yR(e,o,gc())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await $m(e,n,r,Ll(),s);return s4(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Mn(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await dR(e),r=new iI(e);return n.register("authEvent",s=>(L(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(bp,{type:bp},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[bp];o!==void 0&&n(!!o),Ct(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=eR(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return j_()||P0()||sa()}}const NR=IR;class ER{constructor(e){this.factorId=e}_process(e,n,r){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,r);case"signin":return this._finalizeSignIn(e,n.credential);default:return er("unexpected MultiFactorSessionType")}}}class G0 extends ER{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new G0(e)}_finalizeEnroll(e,n,r){return YA(e,{idToken:n,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return p4(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class lI{constructor(){}static assertion(e){return G0._fromCredential(e)}}lI.FACTOR_ID="phone";var dx="@firebase/auth",hx="0.23.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){L(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function TR(t){bs(new ur("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;L(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:D_(t)},u=new tA(r,s,i,c);return nA(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),bs(new ur("auth-internal",e=>{const n=Je(e.getProvider("auth").getImmediate());return(r=>new kR(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ar(dx,hx,SR(t)),ar(dx,hx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CR=5*60;GC("authIdTokenMaxAge");TR("Browser");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ki(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jR=2e3;async function DR(t,e,n){var r;const{BuildInfo:s}=ki();Mn(e.sessionId,"AuthEvent did not contain a session ID");const i=await $R(e.sessionId),o={};return sa()?o.ibi=s.packageName:pc()?o.apn=s.packageName:Ct(t,"operation-not-supported-in-this-environment"),s.displayName&&(o.appDisplayName=s.displayName),o.sessionId=i,$m(t,n,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function AR(t){const{BuildInfo:e}=ki(),n={};sa()?n.iosBundleId=e.packageName:pc()?n.androidPackageName=e.packageName:Ct(t,"operation-not-supported-in-this-environment"),await aI(t,n)}function RR(t){const{cordova:e}=ki();return new Promise(n=>{e.plugins.browsertab.isAvailable(r=>{let s=null;r?e.plugins.browsertab.openUrl(t):s=e.InAppBrowser.open(t,WD()?"_blank":"_system","location=yes"),n(s)})})}async function PR(t,e,n){const{cordova:r}=ki();let s=()=>{};try{await new Promise((i,o)=>{let a=null;function c(){var h;i();const f=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof f=="function"&&f(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function u(){a||(a=window.setTimeout(()=>{o(kt(t,"redirect-cancelled-by-user"))},jR))}function d(){(document==null?void 0:document.visibilityState)==="visible"&&u()}e.addPassiveListener(c),document.addEventListener("resume",u,!1),pc()&&document.addEventListener("visibilitychange",d,!1),s=()=>{e.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",d,!1),a&&window.clearTimeout(a)}})}finally{s()}}function OR(t){var e,n,r,s,i,o,a,c,u,d;const h=ki();L(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),L(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)<"u",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),L(typeof((i=(s=(r=h==null?void 0:h.cordova)===null||r===void 0?void 0:r.plugins)===null||s===void 0?void 0:s.browsertab)===null||i===void 0?void 0:i.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),L(typeof((c=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),L(typeof((d=(u=h==null?void 0:h.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||d===void 0?void 0:d.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function $R(t){const e=LR(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(s=>s.toString(16).padStart(2,"0")).join("")}function LR(t){if(Mn(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MR=20;class FR extends iI{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function VR(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:BR(),postBody:null,tenantId:t.tenantId,error:kt(t,"no-auth-event")}}function UR(t,e){return Lm()._set(Mm(t),e)}async function fx(t){const e=await Lm()._get(Mm(t));return e&&await Lm()._remove(Mm(t)),e}function zR(t,e){var n,r;const s=WR(e);if(s.includes("/__/auth/callback")){const i=Gu(s),o=i.firebaseError?qR(decodeURIComponent(i.firebaseError)):null,a=(r=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||r===void 0?void 0:r[1],c=a?kt(a):null;return c?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:s,postBody:null}}return null}function BR(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<MR;n++){const r=Math.floor(Math.random()*e.length);t.push(e.charAt(r))}return t.join("")}function Lm(){return dn(U0)}function Mm(t){return pi("authEvent",t.config.apiKey,t.name)}function qR(t){try{return JSON.parse(t)}catch{return null}}function WR(t){const e=Gu(t),n=e.link?decodeURIComponent(e.link):void 0,r=Gu(n).link,s=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Gu(s).link||s||r||n||t}function Gu(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return mo(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HR=500;class GR{constructor(){this._redirectPersistence=Ni,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Sh,this._overrideRedirectResult=H0}async _initialize(e){const n=e._key();let r=this.eventManagers.get(n);return r||(r=new FR(e),this.eventManagers.set(n,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){Ct(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,r,s){OR(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),z4(),await this._originValidation(e);const o=VR(e,r,s);await UR(e,o);const a=await DR(e,o,n),c=await RR(a);return PR(e,i,c)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=AR(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:r,handleOpenURL:s,BuildInfo:i}=ki(),o=setTimeout(async()=>{await fx(e),n.onEvent(px())},HR),a=async d=>{clearTimeout(o);const h=await fx(e);let f=null;h&&(d!=null&&d.url)&&(f=zR(h,d.url)),n.onEvent(f||px())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);const c=s,u=`${i.packageName.toLowerCase()}://`;ki().handleOpenURL=async d=>{if(d.toLowerCase().startsWith(u)&&a({url:d}),typeof c=="function")try{c(d)}catch(h){console.error(h)}}}}const KR=GR;function px(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:kt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(t,e){Je(t)._logFramework(e)}var YR="@firebase/auth-compat",XR="0.4.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JR=1e3;function cl(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function ZR(){return cl()==="http:"||cl()==="https:"}function cI(t=Ue()){return!!((cl()==="file:"||cl()==="ionic:"||cl()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function e3(){return k0()||E0()}function t3(){return s_()&&(document==null?void 0:document.documentMode)===11}function n3(t=Ue()){return/Edge\/\d+/.test(t)}function r3(t=Ue()){return t3()||n3(t)}function uI(){try{const t=self.localStorage,e=gc();if(t)return t.setItem(e,"1"),t.removeItem(e),r3()?Pl():!0}catch{return K0()&&Pl()}return!1}function K0(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function _p(){return(ZR()||r_()||cI())&&!e3()&&uI()&&!K0()}function dI(){return cI()&&typeof document<"u"}async function s3(){return dI()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},JR);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function i3(){return typeof window<"u"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cn={LOCAL:"local",NONE:"none",SESSION:"session"},Da=L,hI="persistence";function o3(t,e){if(Da(Object.values(cn).includes(e),t,"invalid-persistence-type"),k0()){Da(e!==cn.SESSION,t,"unsupported-persistence-type");return}if(E0()){Da(e===cn.NONE,t,"unsupported-persistence-type");return}if(K0()){Da(e===cn.NONE||e===cn.LOCAL&&Pl(),t,"unsupported-persistence-type");return}Da(e===cn.NONE||uI(),t,"unsupported-persistence-type")}async function Fm(t){await t._initializationPromise;const e=fI(),n=pi(hI,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function a3(t,e){const n=fI();if(!n)return[];const r=pi(hI,t,e);switch(n.getItem(r)){case cn.NONE:return[Mo];case cn.LOCAL:return[Ul,Ni];case cn.SESSION:return[Ni];default:return[]}}function fI(){var t;try{return((t=i3())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l3=L;class is{constructor(){this.browserResolver=dn(NR),this.cordovaResolver=dn(KR),this.underlyingResolver=null,this._redirectPersistence=Ni,this._completeRedirectFn=Sh,this._overrideRedirectResult=H0}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,r,s)}async _openRedirect(e,n,r,s){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,r,s)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return dI()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return l3(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await s3();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pI(t){return t.unwrap()}function c3(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u3(t){return mI(t)}function d3(t,e){var n;const r=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if((e==null?void 0:e.code)==="auth/multi-factor-auth-required"){const s=e;s.resolver=new h3(t,KA(t,e))}else if(r){const s=mI(e),i=e;s&&(i.credential=s,i.tenantId=r.tenantId||void 0,i.email=r.email||void 0,i.phoneNumber=r.phoneNumber||void 0)}}function mI(t){const{_tokenResponse:e}=t instanceof Wt?t.customData:t;if(!e)return null;if(!(t instanceof Wt)&&"temporaryProof"in e&&"phoneNumber"in e)return Ei.credentialFromResult(t);const n=e.providerId;if(!n||n===ja.PASSWORD)return null;let r;switch(n){case ja.GOOGLE:r=Yn;break;case ja.FACEBOOK:r=Qn;break;case ja.GITHUB:r=Xn;break;case ja.TWITTER:r=Jn;break;default:const{oauthIdToken:s,oauthAccessToken:i,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!i&&!o&&!s&&!a?null:a?n.startsWith("saml.")?Fo._create(n,a):dr._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:s,accessToken:i}):new No(n).credential({idToken:s,accessToken:i,rawNonce:c})}return t instanceof Wt?r.credentialFromError(t):r.credentialFromResult(t)}function Qt(t,e){return e.catch(n=>{throw n instanceof Wt&&d3(t,n),n}).then(n=>{const r=n.operationType,s=n.user;return{operationType:r,credential:u3(n),additionalUserInfo:GA(n),user:Ir.getOrCreate(s)}})}async function Vm(t,e){const n=await e;return{verificationId:n.verificationId,confirm:r=>Qt(t,n.confirm(r))}}class h3{constructor(e,n){this.resolver=n,this.auth=c3(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Qt(pI(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ir{constructor(e){this._delegate=e,this.multiFactor=JA(e)}static getOrCreate(e){return Ir.USER_MAP.has(e)||Ir.USER_MAP.set(e,new Ir(e)),Ir.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Qt(this.auth,B_(this._delegate,e))}async linkWithPhoneNumber(e,n){return Vm(this.auth,C4(this._delegate,e,n))}async linkWithPopup(e){return Qt(this.auth,M4(this._delegate,e,is))}async linkWithRedirect(e){return await Fm(Je(this.auth)),G4(this._delegate,e,is)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Qt(this.auth,q_(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return Vm(this.auth,j4(this._delegate,e,n))}reauthenticateWithPopup(e){return Qt(this.auth,L4(this._delegate,e,is))}async reauthenticateWithRedirect(e){return await Fm(Je(this.auth)),W4(this._delegate,e,is)}sendEmailVerification(e){return $A(this._delegate,e)}async unlink(e){return await _A(this._delegate,e),this}updateEmail(e){return VA(this._delegate,e)}updatePassword(e){return UA(this._delegate,e)}updatePhoneNumber(e){return D4(this._delegate,e)}updateProfile(e){return FA(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return LA(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Ir.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa=L;class Um{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:r}=e.options;Aa(r,"invalid-api-key",{appName:e.name}),Aa(r,"invalid-api-key",{appName:e.name});const s=typeof window<"u"?is:void 0;this._delegate=n.initialize({options:{persistence:f3(r,e.name),popupRedirectResolver:s}}),this._delegate._updateErrorMap(kD),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Ir.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){rA(this._delegate,e,n)}applyActionCode(e){return SA(this._delegate,e)}checkActionCode(e){return W_(this._delegate,e)}confirmPasswordReset(e,n){return kA(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return Qt(this._delegate,CA(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return OA(this._delegate,e)}isSignInWithEmailLink(e){return AA(this._delegate,e)}async getRedirectResult(){Aa(_p(),this._delegate,"operation-not-supported-in-this-environment");const e=await Q4(this._delegate,is);return e?Qt(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){QR(this._delegate,e)}onAuthStateChanged(e,n,r){const{next:s,error:i,complete:o}=mx(e,n,r);return this._delegate.onAuthStateChanged(s,i,o)}onIdTokenChanged(e,n,r){const{next:s,error:i,complete:o}=mx(e,n,r);return this._delegate.onIdTokenChanged(s,i,o)}sendSignInLinkToEmail(e,n){return DA(this._delegate,e,n)}sendPasswordResetEmail(e,n){return EA(this._delegate,e,n||void 0)}async setPersistence(e){o3(this._delegate,e);let n;switch(e){case cn.SESSION:n=Ni;break;case cn.LOCAL:n=await dn(Ul)._isAvailable()?Ul:U0;break;case cn.NONE:n=Mo;break;default:return Ct("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Qt(this._delegate,bA(this._delegate))}signInWithCredential(e){return Qt(this._delegate,Ih(this._delegate,e))}signInWithCustomToken(e){return Qt(this._delegate,NA(this._delegate,e))}signInWithEmailAndPassword(e,n){return Qt(this._delegate,jA(this._delegate,e,n))}signInWithEmailLink(e,n){return Qt(this._delegate,RA(this._delegate,e,n))}signInWithPhoneNumber(e,n){return Vm(this._delegate,T4(this._delegate,e,n))}async signInWithPopup(e){return Aa(_p(),this._delegate,"operation-not-supported-in-this-environment"),Qt(this._delegate,$4(this._delegate,e,is))}async signInWithRedirect(e){return Aa(_p(),this._delegate,"operation-not-supported-in-this-environment"),await Fm(this._delegate),B4(this._delegate,e,is)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return TA(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Um.Persistence=cn;function mx(t,e,n){let r=t;typeof t!="function"&&({next:r,error:e,complete:n}=t);const s=r;return{next:o=>s(o&&Ir.getOrCreate(o)),error:e,complete:n}}function f3(t,e){const n=a3(t,e);if(typeof self<"u"&&!n.includes(Ul)&&n.push(Ul),typeof window<"u")for(const r of[U0,Ni])n.includes(r)||n.push(r);return n.includes(Mo)||n.push(Mo),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q0{constructor(){this.providerId="phone",this._delegate=new Ei(pI(Ie.auth()))}static credential(e,n){return Ei.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}Q0.PHONE_SIGN_IN_METHOD=Ei.PHONE_SIGN_IN_METHOD;Q0.PROVIDER_ID=Ei.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3=L;class m3{constructor(e,n,r=Ie.app()){var s;p3((s=r.options)===null||s===void 0?void 0:s.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new k4(e,n,r.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g3="auth-compat";function y3(t){t.INTERNAL.registerComponent(new ur(g3,e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new Um(n,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Qi.EMAIL_SIGNIN,PASSWORD_RESET:Qi.PASSWORD_RESET,RECOVER_EMAIL:Qi.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Qi.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Qi.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Qi.VERIFY_EMAIL}},EmailAuthProvider:$s,FacebookAuthProvider:Qn,GithubAuthProvider:Xn,GoogleAuthProvider:Yn,OAuthProvider:No,SAMLAuthProvider:jd,PhoneAuthProvider:Q0,PhoneMultiFactorGenerator:lI,RecaptchaVerifier:m3,TwitterAuthProvider:Jn,Auth:Um,AuthCredential:ia,Error:Wt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(YR,XR)}y3(Ie);var v3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z,Y0=Y0||{},J=v3||self;function Th(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function vc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function x3(t){return Object.prototype.hasOwnProperty.call(t,Ip)&&t[Ip]||(t[Ip]=++w3)}var Ip="closure_uid_"+(1e9*Math.random()>>>0),w3=0;function b3(t,e,n){return t.call.apply(t.bind,arguments)}function _3(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,r),t.apply(e,s)}}return function(){return t.apply(e,arguments)}}function $t(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?$t=b3:$t=_3,$t.apply(null,arguments)}function xu(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function pt(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,s,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[s].apply(r,o)}}function Ls(){this.s=this.s,this.o=this.o}var I3=0;Ls.prototype.s=!1;Ls.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),I3!=0)&&x3(this)};Ls.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const gI=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function X0(t){const e=t.length;if(0<e){const n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function gx(t,e){for(let n=1;n<arguments.length;n++){const r=arguments[n];if(Th(r)){const s=t.length||0,i=r.length||0;t.length=s+i;for(let o=0;o<i;o++)t[s+o]=r[o]}else t.push(r)}}function Lt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Lt.prototype.h=function(){this.defaultPrevented=!0};var N3=function(){if(!J.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{J.addEventListener("test",()=>{},e),J.removeEventListener("test",()=>{},e)}catch{}return t}();function zl(t){return/^[\s\xa0]*$/.test(t)}function Ch(){var t=J.navigator;return t&&(t=t.userAgent)?t:""}function Zn(t){return Ch().indexOf(t)!=-1}function J0(t){return J0[" "](t),t}J0[" "]=function(){};function E3(t,e){var n=yP;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var k3=Zn("Opera"),Vo=Zn("Trident")||Zn("MSIE"),yI=Zn("Edge"),zm=yI||Vo,vI=Zn("Gecko")&&!(Ch().toLowerCase().indexOf("webkit")!=-1&&!Zn("Edge"))&&!(Zn("Trident")||Zn("MSIE"))&&!Zn("Edge"),S3=Ch().toLowerCase().indexOf("webkit")!=-1&&!Zn("Edge");function xI(){var t=J.document;return t?t.documentMode:void 0}var Bm;e:{var Np="",Ep=function(){var t=Ch();if(vI)return/rv:([^\);]+)(\)|;)/.exec(t);if(yI)return/Edge\/([\d\.]+)/.exec(t);if(Vo)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(S3)return/WebKit\/(\S+)/.exec(t);if(k3)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Ep&&(Np=Ep?Ep[1]:""),Vo){var kp=xI();if(kp!=null&&kp>parseFloat(Np)){Bm=String(kp);break e}}Bm=Np}var qm;if(J.document&&Vo){var yx=xI();qm=yx||parseInt(Bm,10)||void 0}else qm=void 0;var T3=qm;function Bl(t,e){if(Lt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(vI){e:{try{J0(e.nodeName);var s=!0;break e}catch{}s=!1}s||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:C3[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Bl.$.h.call(this)}}pt(Bl,Lt);var C3={2:"touch",3:"pen",4:"mouse"};Bl.prototype.h=function(){Bl.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var xc="closure_listenable_"+(1e6*Math.random()|0),j3=0;function D3(t,e,n,r,s){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=s,this.key=++j3,this.fa=this.ia=!1}function jh(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function Z0(t,e,n){for(const r in t)e.call(n,t[r],r,t)}function A3(t,e){for(const n in t)e.call(void 0,t[n],n,t)}function wI(t){const e={};for(const n in t)e[n]=t[n];return e}const vx="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function bI(t,e){let n,r;for(let s=1;s<arguments.length;s++){r=arguments[s];for(n in r)t[n]=r[n];for(let i=0;i<vx.length;i++)n=vx[i],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Dh(t){this.src=t,this.g={},this.h=0}Dh.prototype.add=function(t,e,n,r,s){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Hm(t,e,r,s);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new D3(e,this.src,i,!!r,s),e.ia=n,t.push(e)),e};function Wm(t,e){var n=e.type;if(n in t.g){var r=t.g[n],s=gI(r,e),i;(i=0<=s)&&Array.prototype.splice.call(r,s,1),i&&(jh(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Hm(t,e,n,r){for(var s=0;s<t.length;++s){var i=t[s];if(!i.fa&&i.listener==e&&i.capture==!!n&&i.la==r)return s}return-1}var ey="closure_lm_"+(1e6*Math.random()|0),Sp={};function _I(t,e,n,r,s){if(r&&r.once)return NI(t,e,n,r,s);if(Array.isArray(e)){for(var i=0;i<e.length;i++)_I(t,e[i],n,r,s);return null}return n=ry(n),t&&t[xc]?t.O(e,n,vc(r)?!!r.capture:!!r,s):II(t,e,n,!1,r,s)}function II(t,e,n,r,s,i){if(!e)throw Error("Invalid event type");var o=vc(s)?!!s.capture:!!s,a=ny(t);if(a||(t[ey]=a=new Dh(t)),n=a.add(e,n,r,o,i),n.proxy)return n;if(r=R3(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)N3||(s=o),s===void 0&&(s=!1),t.addEventListener(e.toString(),r,s);else if(t.attachEvent)t.attachEvent(kI(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function R3(){function t(n){return e.call(t.src,t.listener,n)}const e=P3;return t}function NI(t,e,n,r,s){if(Array.isArray(e)){for(var i=0;i<e.length;i++)NI(t,e[i],n,r,s);return null}return n=ry(n),t&&t[xc]?t.P(e,n,vc(r)?!!r.capture:!!r,s):II(t,e,n,!0,r,s)}function EI(t,e,n,r,s){if(Array.isArray(e))for(var i=0;i<e.length;i++)EI(t,e[i],n,r,s);else r=vc(r)?!!r.capture:!!r,n=ry(n),t&&t[xc]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Hm(i,n,r,s),-1<n&&(jh(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=ny(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Hm(e,n,r,s)),(n=-1<t?e[t]:null)&&ty(n))}function ty(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[xc])Wm(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kI(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ny(e))?(Wm(n,t),n.h==0&&(n.src=null,e[ey]=null)):jh(t)}}}function kI(t){return t in Sp?Sp[t]:Sp[t]="on"+t}function P3(t,e){if(t.fa)t=!0;else{e=new Bl(e,this);var n=t.listener,r=t.la||t.src;t.ia&&ty(t),t=n.call(r,e)}return t}function ny(t){return t=t[ey],t instanceof Dh?t:null}var Tp="__closure_events_fn_"+(1e9*Math.random()>>>0);function ry(t){return typeof t=="function"?t:(t[Tp]||(t[Tp]=function(e){return t.handleEvent(e)}),t[Tp])}function ft(){Ls.call(this),this.i=new Dh(this),this.S=this,this.J=null}pt(ft,Ls);ft.prototype[xc]=!0;ft.prototype.removeEventListener=function(t,e,n,r){EI(this,t,e,n,r)};function St(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Lt(e,t);else if(e instanceof Lt)e.target=e.target||t;else{var s=e;e=new Lt(r,t),bI(e,s)}if(s=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];s=wu(o,r,!0,e)&&s}if(o=e.g=t,s=wu(o,r,!0,e)&&s,s=wu(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)o=e.g=n[i],s=wu(o,r,!1,e)&&s}ft.prototype.N=function(){if(ft.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)jh(n[r]);delete t.g[e],t.h--}}this.J=null};ft.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};ft.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function wu(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var s=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&Wm(t.i,o),s=a.call(c,r)!==!1&&s}}return s&&!r.defaultPrevented}var sy=J.JSON.stringify;class O3{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}function $3(){var t=iy;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class L3{constructor(){this.h=this.g=null}add(e,n){const r=SI.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}}var SI=new O3(()=>new M3,t=>t.reset());class M3{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function F3(t){var e=1;t=t.split(":");const n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function V3(t){J.setTimeout(()=>{throw t},0)}let ql,Wl=!1,iy=new L3,TI=()=>{const t=J.Promise.resolve(void 0);ql=()=>{t.then(U3)}};var U3=()=>{for(var t;t=$3();){try{t.h.call(t.g)}catch(n){V3(n)}var e=SI;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Wl=!1};function Ah(t,e){ft.call(this),this.h=t||1,this.g=e||J,this.j=$t(this.qb,this),this.l=Date.now()}pt(Ah,ft);z=Ah.prototype;z.ga=!1;z.T=null;z.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),St(this,"tick"),this.ga&&(oy(this),this.start()))}};z.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function oy(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}z.N=function(){Ah.$.N.call(this),oy(this),delete this.g};function ay(t,e,n){if(typeof t=="function")n&&(t=$t(t,n));else if(t&&typeof t.handleEvent=="function")t=$t(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:J.setTimeout(t,e||0)}function CI(t){t.g=ay(()=>{t.g=null,t.i&&(t.i=!1,CI(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class z3 extends Ls{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:CI(this)}N(){super.N(),this.g&&(J.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Hl(t){Ls.call(this),this.h=t,this.g={}}pt(Hl,Ls);var xx=[];function jI(t,e,n,r){Array.isArray(n)||(n&&(xx[0]=n.toString()),n=xx);for(var s=0;s<n.length;s++){var i=_I(e,n[s],r||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function DI(t){Z0(t.g,function(e,n){this.g.hasOwnProperty(n)&&ty(e)},t),t.g={}}Hl.prototype.N=function(){Hl.$.N.call(this),DI(this)};Hl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Rh(){this.g=!0}Rh.prototype.Ea=function(){this.g=!1};function B3(t,e,n,r,s,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var d=u[0];u=u[1];var h=d.split("_");o=2<=h.length&&h[1]=="type"?o+(d+"="+u+"&"):o+(d+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+e+`
`+n+`
`+o})}function q3(t,e,n,r,s,i,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+e+`
`+n+`
`+i+" "+o})}function go(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+H3(t,n)+(r?" "+r:"")})}function W3(t,e){t.info(function(){return"TIMEOUT: "+e})}Rh.prototype.info=function(){};function H3(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var s=r[1];if(Array.isArray(s)&&!(1>s.length)){var i=s[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<s.length;o++)s[o]=""}}}}return sy(n)}catch{return e}}var Vi={},wx=null;function Ph(){return wx=wx||new ft}Vi.Ta="serverreachability";function AI(t){Lt.call(this,Vi.Ta,t)}pt(AI,Lt);function Gl(t){const e=Ph();St(e,new AI(e))}Vi.STAT_EVENT="statevent";function RI(t,e){Lt.call(this,Vi.STAT_EVENT,t),this.stat=e}pt(RI,Lt);function Bt(t){const e=Ph();St(e,new RI(e,t))}Vi.Ua="timingevent";function PI(t,e){Lt.call(this,Vi.Ua,t),this.size=e}pt(PI,Lt);function wc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return J.setTimeout(function(){t()},e)}var Oh={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},OI={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function ly(){}ly.prototype.h=null;function bx(t){return t.h||(t.h=t.i())}function $I(){}var bc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function cy(){Lt.call(this,"d")}pt(cy,Lt);function uy(){Lt.call(this,"c")}pt(uy,Lt);var Gm;function $h(){}pt($h,ly);$h.prototype.g=function(){return new XMLHttpRequest};$h.prototype.i=function(){return{}};Gm=new $h;function _c(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Hl(this),this.P=G3,t=zm?125:void 0,this.V=new Ah(t),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new LI}function LI(){this.i=null,this.g="",this.h=!1}var G3=45e3,Km={},Pd={};z=_c.prototype;z.setTimeout=function(t){this.P=t};function Qm(t,e,n){t.L=1,t.v=Mh(Or(e)),t.s=n,t.S=!0,MI(t,null)}function MI(t,e){t.G=Date.now(),Ic(t),t.A=Or(t.v);var n=t.A,r=t.W;Array.isArray(r)||(r=[String(r)]),HI(n.i,"t",r),t.C=0,n=t.l.J,t.h=new LI,t.g=fN(t.l,n?e:null,!t.s),0<t.O&&(t.M=new z3($t(t.Pa,t,t.g),t.O)),jI(t.U,t.g,"readystatechange",t.nb),e=t.I?wI(t.I):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.A,t.u,t.s,e)):(t.u="GET",t.g.ha(t.A,t.u,null,e)),Gl(),B3(t.j,t.u,t.A,t.m,t.W,t.s)}z.nb=function(t){t=t.target;const e=this.M;e&&tr(t)==3?e.l():this.Pa(t)};z.Pa=function(t){try{if(t==this.g)e:{const d=tr(this.g);var e=this.g.Ia();const h=this.g.da();if(!(3>d)&&(d!=3||zm||this.g&&(this.h.h||this.g.ja()||Ex(this.g)))){this.J||d!=4||e==7||(e==8||0>=h?Gl(3):Gl(2)),Lh(this);var n=this.g.da();this.ca=n;t:if(FI(this)){var r=Ex(this.g);t="";var s=r.length,i=tr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ai(this),ul(this);var o="";break t}this.h.i=new J.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:i&&e==s-1});r.splice(0,s),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,q3(this.j,this.u,this.A,this.m,this.W,d,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!zl(a)){var u=a;break t}}u=null}if(n=u)go(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ym(this,n);else{this.i=!1,this.o=3,Bt(12),ai(this),ul(this);break e}}this.S?(VI(this,d,o),zm&&this.i&&d==3&&(jI(this.U,this.V,"tick",this.mb),this.V.start())):(go(this.j,this.m,o,null),Ym(this,o)),d==4&&ai(this),this.i&&!this.J&&(d==4?cN(this.l,this):(this.i=!1,Ic(this)))}else pP(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.o=3,Bt(12)):(this.o=0,Bt(13)),ai(this),ul(this)}}}catch{}finally{}};function FI(t){return t.g?t.u=="GET"&&t.L!=2&&t.l.Ha:!1}function VI(t,e,n){let r=!0,s;for(;!t.J&&t.C<n.length;)if(s=K3(t,n),s==Pd){e==4&&(t.o=4,Bt(14),r=!1),go(t.j,t.m,null,"[Incomplete Response]");break}else if(s==Km){t.o=4,Bt(15),go(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else go(t.j,t.m,s,null),Ym(t,s);FI(t)&&s!=Pd&&s!=Km&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,Bt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),gy(e),e.M=!0,Bt(11))):(go(t.j,t.m,n,"[Invalid Chunked Response]"),ai(t),ul(t))}z.mb=function(){if(this.g){var t=tr(this.g),e=this.g.ja();this.C<e.length&&(Lh(this),VI(this,t,e),this.i&&t!=4&&Ic(this))}};function K3(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?Pd:(n=Number(e.substring(n,r)),isNaN(n)?Km:(r+=1,r+n>e.length?Pd:(e=e.slice(r,r+n),t.C=r+n,e)))}z.cancel=function(){this.J=!0,ai(this)};function Ic(t){t.Y=Date.now()+t.P,UI(t,t.P)}function UI(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=wc($t(t.lb,t),e)}function Lh(t){t.B&&(J.clearTimeout(t.B),t.B=null)}z.lb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(W3(this.j,this.A),this.L!=2&&(Gl(),Bt(17)),ai(this),this.o=2,ul(this)):UI(this,this.Y-t)};function ul(t){t.l.H==0||t.J||cN(t.l,t)}function ai(t){Lh(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,oy(t.V),DI(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Ym(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||Xm(n.i,t))){if(!t.K&&Xm(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var s=r;if(s[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Ld(n),Uh(n);else break e;my(n),Bt(18)}}else n.Fa=s[1],0<n.Fa-n.V&&37500>s[2]&&n.G&&n.A==0&&!n.v&&(n.v=wc($t(n.ib,n),6e3));if(1>=QI(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else li(n,11)}else if((t.K||n.g==t)&&Ld(n),!zl(e))for(s=n.Ja.g.parse(e),e=0;e<s.length;e++){let u=s[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];const d=u[3];d!=null&&(n.ra=d,n.l.info("VER="+n.ra));const h=u[4];h!=null&&(n.Ga=h,n.l.info("SVER="+n.Ga));const f=u[5];f!=null&&typeof f=="number"&&0<f&&(r=1.5*f,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;const m=t.g;if(m){const y=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(y){var i=r.i;i.g||y.indexOf("spdy")==-1&&y.indexOf("quic")==-1&&y.indexOf("h2")==-1||(i.j=i.l,i.g=new Set,i.h&&(dy(i,i.h),i.h=null))}if(r.F){const x=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;x&&(r.Da=x,Te(r.I,r.F,x))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=hN(r,r.J?r.pa:null,r.Y),o.K){YI(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.B&&(Lh(a),Ic(a)),r.g=o}else aN(r);0<n.j.length&&zh(n)}else u[0]!="stop"&&u[0]!="close"||li(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?li(n,7):py(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}Gl(4)}catch{}}function Q3(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Th(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Y3(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Th(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(const r in t)e[n++]=r;return e}}}function zI(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Th(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=Y3(t),r=Q3(t),s=r.length,i=0;i<s;i++)e.call(void 0,r[i],n&&n[i],t)}var BI=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function X3(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),s=null;if(0<=r){var i=t[n].substring(0,r);s=t[n].substring(r+1)}else i=t[n];e(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}function gi(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof gi){this.h=t.h,Od(this,t.j),this.s=t.s,this.g=t.g,$d(this,t.m),this.l=t.l;var e=t.i,n=new Kl;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),_x(this,n),this.o=t.o}else t&&(e=String(t).match(BI))?(this.h=!1,Od(this,e[1]||"",!0),this.s=Ga(e[2]||""),this.g=Ga(e[3]||"",!0),$d(this,e[4]),this.l=Ga(e[5]||"",!0),_x(this,e[6]||"",!0),this.o=Ga(e[7]||"")):(this.h=!1,this.i=new Kl(null,this.h))}gi.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ka(e,Ix,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Ka(e,Ix,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Ka(n,n.charAt(0)=="/"?eP:Z3,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ka(n,nP)),t.join("")};function Or(t){return new gi(t)}function Od(t,e,n){t.j=n?Ga(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function $d(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function _x(t,e,n){e instanceof Kl?(t.i=e,rP(t.i,t.h)):(n||(e=Ka(e,tP)),t.i=new Kl(e,t.h))}function Te(t,e,n){t.i.set(e,n)}function Mh(t){return Te(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ga(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ka(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,J3),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function J3(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Ix=/[#\/\?@]/g,Z3=/[#\?:]/g,eP=/[#\?]/g,tP=/[#\?@]/g,nP=/#/g;function Kl(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ms(t){t.g||(t.g=new Map,t.h=0,t.i&&X3(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}z=Kl.prototype;z.add=function(t,e){Ms(this),this.i=null,t=aa(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function qI(t,e){Ms(t),e=aa(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function WI(t,e){return Ms(t),e=aa(t,e),t.g.has(e)}z.forEach=function(t,e){Ms(this),this.g.forEach(function(n,r){n.forEach(function(s){t.call(e,s,r,this)},this)},this)};z.ta=function(){Ms(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){const s=t[r];for(let i=0;i<s.length;i++)n.push(e[r])}return n};z.Z=function(t){Ms(this);let e=[];if(typeof t=="string")WI(this,t)&&(e=e.concat(this.g.get(aa(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};z.set=function(t,e){return Ms(this),this.i=null,t=aa(this,t),WI(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};z.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function HI(t,e,n){qI(t,e),0<n.length&&(t.i=null,t.g.set(aa(t,e),X0(n)),t.h+=n.length)}z.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];const i=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var s=i;o[r]!==""&&(s+="="+encodeURIComponent(String(o[r]))),t.push(s)}}return this.i=t.join("&")};function aa(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function rP(t,e){e&&!t.j&&(Ms(t),t.i=null,t.g.forEach(function(n,r){var s=r.toLowerCase();r!=s&&(qI(this,r),HI(this,s,n))},t)),t.j=e}var sP=class{constructor(t,e){this.g=t,this.map=e}};function GI(t){this.l=t||iP,J.PerformanceNavigationTiming?(t=J.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(J.g&&J.g.Ka&&J.g.Ka()&&J.g.Ka().ec),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var iP=10;function KI(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function QI(t){return t.h?1:t.g?t.g.size:0}function Xm(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function dy(t,e){t.g?t.g.add(e):t.h=e}function YI(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}GI.prototype.cancel=function(){if(this.i=XI(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function XI(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.F);return e}return X0(t.i)}var oP=class{stringify(t){return J.JSON.stringify(t,void 0)}parse(t){return J.JSON.parse(t,void 0)}};function aP(){this.g=new oP}function lP(t,e,n){const r=n||"";try{zI(t,function(s,i){let o=s;vc(s)&&(o=sy(s)),e.push(r+i+"="+encodeURIComponent(o))})}catch(s){throw e.push(r+"type="+encodeURIComponent("_badmap")),s}}function cP(t,e){const n=new Rh;if(J.Image){const r=new Image;r.onload=xu(bu,n,r,"TestLoadImage: loaded",!0,e),r.onerror=xu(bu,n,r,"TestLoadImage: error",!1,e),r.onabort=xu(bu,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=xu(bu,n,r,"TestLoadImage: timeout",!1,e),J.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function bu(t,e,n,r,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(r)}catch{}}function Nc(t){this.l=t.fc||null,this.j=t.ob||!1}pt(Nc,ly);Nc.prototype.g=function(){return new Fh(this.l,this.j)};Nc.prototype.i=function(t){return function(){return t}}({});function Fh(t,e){ft.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=hy,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}pt(Fh,ft);var hy=0;z=Fh.prototype;z.open=function(t,e){if(this.readyState!=hy)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ql(this)};z.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||J).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};z.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ec(this)),this.readyState=hy};z.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ql(this)),this.g&&(this.readyState=3,Ql(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof J.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;JI(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function JI(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}z.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Ec(this):Ql(this),this.readyState==3&&JI(this)}};z.Za=function(t){this.g&&(this.response=this.responseText=t,Ec(this))};z.Ya=function(t){this.g&&(this.response=t,Ec(this))};z.ka=function(){this.g&&Ec(this)};function Ec(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ql(t)}z.setRequestHeader=function(t,e){this.v.append(t,e)};z.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};z.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Ql(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(Fh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var uP=J.JSON.parse;function He(t){ft.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=ZI,this.L=this.M=!1}pt(He,ft);var ZI="",dP=/^https?$/i,hP=["POST","PUT"];z=He.prototype;z.Oa=function(t){this.M=t};z.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():Gm.g(),this.C=this.u?bx(this.u):bx(Gm),this.g.onreadystatechange=$t(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(i){Nx(this,i);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(const i of r.keys())n.set(i,r.get(i));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(i=>i.toLowerCase()=="content-type"),s=J.FormData&&t instanceof J.FormData,!(0<=gI(hP,e))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{nN(this),0<this.B&&((this.L=fP(this.g))?(this.g.timeout=this.B,this.g.ontimeout=$t(this.ua,this)):this.A=ay(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){Nx(this,i)}};function fP(t){return Vo&&typeof t.timeout=="number"&&t.ontimeout!==void 0}z.ua=function(){typeof Y0<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,St(this,"timeout"),this.abort(8))};function Nx(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,eN(t),Vh(t)}function eN(t){t.F||(t.F=!0,St(t,"complete"),St(t,"error"))}z.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,St(this,"complete"),St(this,"abort"),Vh(this))};z.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Vh(this,!0)),He.$.N.call(this)};z.La=function(){this.s||(this.G||this.v||this.l?tN(this):this.kb())};z.kb=function(){tN(this)};function tN(t){if(t.h&&typeof Y0<"u"&&(!t.C[1]||tr(t)!=4||t.da()!=2)){if(t.v&&tr(t)==4)ay(t.La,0,t);else if(St(t,"readystatechange"),tr(t)==4){t.h=!1;try{const o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var s=String(t.I).match(BI)[1]||null;!s&&J.self&&J.self.location&&(s=J.self.location.protocol.slice(0,-1)),r=!dP.test(s?s.toLowerCase():"")}n=r}if(n)St(t,"complete"),St(t,"success");else{t.m=6;try{var i=2<tr(t)?t.g.statusText:""}catch{i=""}t.j=i+" ["+t.da()+"]",eN(t)}}finally{Vh(t)}}}}function Vh(t,e){if(t.g){nN(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||St(t,"ready");try{n.onreadystatechange=r}catch{}}}function nN(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(J.clearTimeout(t.A),t.A=null)}z.isActive=function(){return!!this.g};function tr(t){return t.g?t.g.readyState:0}z.da=function(){try{return 2<tr(this)?this.g.status:-1}catch{return-1}};z.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};z.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),uP(e)}};function Ex(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case ZI:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function pP(t){const e={};t=(t.g&&2<=tr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(zl(t[r]))continue;var n=F3(t[r]);const s=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();const i=e[s]||[];e[s]=i,i.push(n)}A3(e,function(r){return r.join(", ")})}z.Ia=function(){return this.m};z.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function rN(t){let e="";return Z0(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function fy(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=rN(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Te(t,e,n))}function Ra(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function sN(t){this.Ga=0,this.j=[],this.l=new Rh,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Ra("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Ra("baseRetryDelayMs",5e3,t),this.hb=Ra("retryDelaySeedMs",1e4,t),this.eb=Ra("forwardChannelMaxRetries",2,t),this.xa=Ra("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.dc||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new GI(t&&t.concurrentRequestLimit),this.Ja=new aP,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}z=sN.prototype;z.ra=8;z.H=1;function py(t){if(iN(t),t.H==3){var e=t.W++,n=Or(t.I);if(Te(n,"SID",t.K),Te(n,"RID",e),Te(n,"TYPE","terminate"),kc(t,n),e=new _c(t,t.l,e),e.L=2,e.v=Mh(Or(n)),n=!1,J.navigator&&J.navigator.sendBeacon)try{n=J.navigator.sendBeacon(e.v.toString(),"")}catch{}!n&&J.Image&&(new Image().src=e.v,n=!0),n||(e.g=fN(e.l,null),e.g.ha(e.v)),e.G=Date.now(),Ic(e)}dN(t)}function Uh(t){t.g&&(gy(t),t.g.cancel(),t.g=null)}function iN(t){Uh(t),t.u&&(J.clearTimeout(t.u),t.u=null),Ld(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&J.clearTimeout(t.m),t.m=null)}function zh(t){if(!KI(t.i)&&!t.m){t.m=!0;var e=t.Na;ql||TI(),Wl||(ql(),Wl=!0),iy.add(e,t),t.C=0}}function mP(t,e){return QI(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=wc($t(t.Na,t,e),uN(t,t.C)),t.C++,!0)}z.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const s=new _c(this,this.l,t);let i=this.s;if(this.U&&(i?(i=wI(i),bI(i,this.U)):i=this.U),this.o!==null||this.O||(s.I=i,i=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=oN(this,s,e),n=Or(this.I),Te(n,"RID",t),Te(n,"CVER",22),this.F&&Te(n,"X-HTTP-Session-Id",this.F),kc(this,n),i&&(this.O?e="headers="+encodeURIComponent(String(rN(i)))+"&"+e:this.o&&fy(n,this.o,i)),dy(this.i,s),this.bb&&Te(n,"TYPE","init"),this.P?(Te(n,"$req",e),Te(n,"SID","null"),s.aa=!0,Qm(s,n,null)):Qm(s,n,e),this.H=2}}else this.H==3&&(t?kx(this,t):this.j.length==0||KI(this.i)||kx(this))};function kx(t,e){var n;e?n=e.m:n=t.W++;const r=Or(t.I);Te(r,"SID",t.K),Te(r,"RID",n),Te(r,"AID",t.V),kc(t,r),t.o&&t.s&&fy(r,t.o,t.s),n=new _c(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=oN(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),dy(t.i,n),Qm(n,r,e)}function kc(t,e){t.na&&Z0(t.na,function(n,r){Te(e,r,n)}),t.h&&zI({},function(n,r){Te(e,r,n)})}function oN(t,e,n){n=Math.min(t.j.length,n);var r=t.h?$t(t.h.Va,t.h,t):null;e:{var s=t.j;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=s[0].g,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let u=s[c].g;const d=s[c].map;if(u-=i,0>u)i=Math.max(0,s[c].g-100),a=!1;else try{lP(d,o,"req"+u+"_")}catch{r&&r(d)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function aN(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;ql||TI(),Wl||(ql(),Wl=!0),iy.add(e,t),t.A=0}}function my(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=wc($t(t.Ma,t),uN(t,t.A)),t.A++,!0)}z.Ma=function(){if(this.u=null,lN(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=wc($t(this.jb,this),t)}};z.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Bt(10),Uh(this),lN(this))};function gy(t){t.B!=null&&(J.clearTimeout(t.B),t.B=null)}function lN(t){t.g=new _c(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=Or(t.wa);Te(e,"RID","rpc"),Te(e,"SID",t.K),Te(e,"AID",t.V),Te(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Te(e,"TO",t.qa),Te(e,"TYPE","xmlhttp"),kc(t,e),t.o&&t.s&&fy(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.v=Mh(Or(e)),n.s=null,n.S=!0,MI(n,t)}z.ib=function(){this.v!=null&&(this.v=null,Uh(this),my(this),Bt(19))};function Ld(t){t.v!=null&&(J.clearTimeout(t.v),t.v=null)}function cN(t,e){var n=null;if(t.g==e){Ld(t),gy(t),t.g=null;var r=2}else if(Xm(t.i,e))n=e.F,YI(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.G;var s=t.C;r=Ph(),St(r,new PI(r,n)),zh(t)}else aN(t);else if(s=e.o,s==3||s==0&&0<e.ca||!(r==1&&mP(t,e)||r==2&&my(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),s){case 1:li(t,5);break;case 4:li(t,10);break;case 3:li(t,6);break;default:li(t,2)}}}function uN(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function li(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=$t(t.pb,t);n||(n=new gi("//www.google.com/images/cleardot.gif"),J.location&&J.location.protocol=="http"||Od(n,"https"),Mh(n)),cP(n.toString(),r)}else Bt(2);t.H=0,t.h&&t.h.za(e),dN(t),iN(t)}z.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Bt(2)):(this.l.info("Failed to ping google.com"),Bt(1))};function dN(t){if(t.H=0,t.ma=[],t.h){const e=XI(t.i);(e.length!=0||t.j.length!=0)&&(gx(t.ma,e),gx(t.ma,t.j),t.i.i.length=0,X0(t.j),t.j.length=0),t.h.ya()}}function hN(t,e,n){var r=n instanceof gi?Or(n):new gi(n);if(r.g!="")e&&(r.g=e+"."+r.g),$d(r,r.m);else{var s=J.location;r=s.protocol,e=e?e+"."+s.hostname:s.hostname,s=+s.port;var i=new gi(null);r&&Od(i,r),e&&(i.g=e),s&&$d(i,s),n&&(i.l=n),r=i}return n=t.F,e=t.Da,n&&e&&Te(r,n,e),Te(r,"VER",t.ra),kc(t,r),r}function fN(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ha&&!t.va?new He(new Nc({ob:!0})):new He(t.va),e.Oa(t.J),e}z.isActive=function(){return!!this.h&&this.h.isActive(this)};function pN(){}z=pN.prototype;z.Ba=function(){};z.Aa=function(){};z.za=function(){};z.ya=function(){};z.isActive=function(){return!0};z.Va=function(){};function Md(){if(Vo&&!(10<=Number(T3)))throw Error("Environmental error: no available transport.")}Md.prototype.g=function(t,e){return new pn(t,e)};function pn(t,e){ft.call(this),this.g=new sN(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!zl(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!zl(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new la(this)}pt(pn,ft);pn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Bt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=hN(t,null,t.Y),zh(t)};pn.prototype.close=function(){py(this.g)};pn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=sy(t),t=n);e.j.push(new sP(e.fb++,t)),e.H==3&&zh(e)};pn.prototype.N=function(){this.g.h=null,delete this.j,py(this.g),delete this.g,pn.$.N.call(this)};function mN(t){cy.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}pt(mN,cy);function gN(){uy.call(this),this.status=1}pt(gN,uy);function la(t){this.g=t}pt(la,pN);la.prototype.Ba=function(){St(this.g,"a")};la.prototype.Aa=function(t){St(this.g,new mN(t))};la.prototype.za=function(t){St(this.g,new gN)};la.prototype.ya=function(){St(this.g,"b")};function gP(){this.blockSize=-1}function Fn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}pt(Fn,gP);Fn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Cp(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var s=0;16>s;++s)r[s]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(s=0;16>s;++s)r[s]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],s=t.g[2];var i=t.g[3],o=e+(i^n&(s^i))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[1]+3905402710&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[2]+606105819&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[3]+3250441966&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[5]+1200080426&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[6]+2821735955&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[7]+4249261313&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[9]+2336552879&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[10]+4294925233&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[11]+2304563134&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(i^n&(s^i))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=i+(s^e&(n^s))+r[13]+4254626195&4294967295,i=e+(o<<12&4294967295|o>>>20),o=s+(n^i&(e^n))+r[14]+2792965006&4294967295,s=i+(o<<17&4294967295|o>>>15),o=n+(e^s&(i^e))+r[15]+1236535329&4294967295,n=s+(o<<22&4294967295|o>>>10),o=e+(s^i&(n^s))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[6]+3225465664&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[11]+643717713&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[0]+3921069994&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[10]+38016083&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[15]+3634488961&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[4]+3889429448&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[14]+3275163606&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[3]+4107603335&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[8]+1163531501&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(s^i&(n^s))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=i+(n^s&(e^n))+r[2]+4243563512&4294967295,i=e+(o<<9&4294967295|o>>>23),o=s+(e^n&(i^e))+r[7]+1735328473&4294967295,s=i+(o<<14&4294967295|o>>>18),o=n+(i^e&(s^i))+r[12]+2368359562&4294967295,n=s+(o<<20&4294967295|o>>>12),o=e+(n^s^i)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[8]+2272392833&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[11]+1839030562&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[14]+4259657740&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[4]+1272893353&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[7]+4139469664&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[10]+3200236656&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[0]+3936430074&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[3]+3572445317&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[6]+76029189&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(n^s^i)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=i+(e^n^s)+r[12]+3873151461&4294967295,i=e+(o<<11&4294967295|o>>>21),o=s+(i^e^n)+r[15]+530742520&4294967295,s=i+(o<<16&4294967295|o>>>16),o=n+(s^i^e)+r[2]+3299628645&4294967295,n=s+(o<<23&4294967295|o>>>9),o=e+(s^(n|~i))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[7]+1126891415&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[14]+2878612391&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[5]+4237533241&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[3]+2399980690&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[10]+4293915773&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[1]+2240044497&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[15]+4264355552&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[6]+2734768916&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[13]+1309151649&4294967295,n=s+(o<<21&4294967295|o>>>11),o=e+(s^(n|~i))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=i+(n^(e|~s))+r[11]+3174756917&4294967295,i=e+(o<<10&4294967295|o>>>22),o=s+(e^(i|~n))+r[2]+718787259&4294967295,s=i+(o<<15&4294967295|o>>>17),o=n+(i^(s|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(s+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+s&4294967295,t.g[3]=t.g[3]+i&4294967295}Fn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,s=this.h,i=0;i<e;){if(s==0)for(;i<=n;)Cp(this,t,i),i+=this.blockSize;if(typeof t=="string"){for(;i<e;)if(r[s++]=t.charCodeAt(i++),s==this.blockSize){Cp(this,r),s=0;break}}else for(;i<e;)if(r[s++]=t[i++],s==this.blockSize){Cp(this,r),s=0;break}}this.h=s,this.i+=e};Fn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function xe(t,e){this.h=e;for(var n=[],r=!0,s=t.length-1;0<=s;s--){var i=t[s]|0;r&&i==e||(n[s]=i,r=!1)}this.g=n}var yP={};function yy(t){return-128<=t&&128>t?E3(t,function(e){return new xe([e|0],0>e?-1:0)}):new xe([t|0],0>t?-1:0)}function nr(t){if(isNaN(t)||!isFinite(t))return So;if(0>t)return It(nr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=Jm;return new xe(e,0)}function yN(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return It(yN(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=nr(Math.pow(e,8)),r=So,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+i),e);8>i?(i=nr(Math.pow(e,i)),r=r.R(i).add(nr(o))):(r=r.R(n),r=r.add(nr(o)))}return r}var Jm=4294967296,So=yy(0),Zm=yy(1),Sx=yy(16777216);z=xe.prototype;z.ea=function(){if(bn(this))return-It(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:Jm+r)*e,e*=Jm}return t};z.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Nr(this))return"0";if(bn(this))return"-"+It(this).toString(t);for(var e=nr(Math.pow(t,6)),n=this,r="";;){var s=Vd(n,e).g;n=Fd(n,s.R(e));var i=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=s,Nr(n))return i+r;for(;6>i.length;)i="0"+i;r=i+r}};z.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Nr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function bn(t){return t.h==-1}z.X=function(t){return t=Fd(this,t),bn(t)?-1:Nr(t)?0:1};function It(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new xe(n,~t.h).add(Zm)}z.abs=function(){return bn(this)?It(this):this};z.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,s=0;s<=e;s++){var i=r+(this.D(s)&65535)+(t.D(s)&65535),o=(i>>>16)+(this.D(s)>>>16)+(t.D(s)>>>16);r=o>>>16,i&=65535,o&=65535,n[s]=o<<16|i}return new xe(n,n[n.length-1]&-2147483648?-1:0)};function Fd(t,e){return t.add(It(e))}z.R=function(t){if(Nr(this)||Nr(t))return So;if(bn(this))return bn(t)?It(this).R(It(t)):It(It(this).R(t));if(bn(t))return It(this.R(It(t)));if(0>this.X(Sx)&&0>t.X(Sx))return nr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var s=0;s<t.g.length;s++){var i=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(s)>>>16,c=t.D(s)&65535;n[2*r+2*s]+=o*c,_u(n,2*r+2*s),n[2*r+2*s+1]+=i*c,_u(n,2*r+2*s+1),n[2*r+2*s+1]+=o*a,_u(n,2*r+2*s+1),n[2*r+2*s+2]+=i*a,_u(n,2*r+2*s+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new xe(n,0)};function _u(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Pa(t,e){this.g=t,this.h=e}function Vd(t,e){if(Nr(e))throw Error("division by zero");if(Nr(t))return new Pa(So,So);if(bn(t))return e=Vd(It(t),e),new Pa(It(e.g),It(e.h));if(bn(e))return e=Vd(t,It(e)),new Pa(It(e.g),e.h);if(30<t.g.length){if(bn(t)||bn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=Zm,r=e;0>=r.X(t);)n=Tx(n),r=Tx(r);var s=Yi(n,1),i=Yi(r,1);for(r=Yi(r,2),n=Yi(n,2);!Nr(r);){var o=i.add(r);0>=o.X(t)&&(s=s.add(n),i=o),r=Yi(r,1),n=Yi(n,1)}return e=Fd(t,s.R(e)),new Pa(s,e)}for(s=So;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),i=nr(n),o=i.R(e);bn(o)||0<o.X(t);)n-=r,i=nr(n),o=i.R(e);Nr(i)&&(i=Zm),s=s.add(i),t=Fd(t,o)}return new Pa(s,t)}z.gb=function(t){return Vd(this,t).h};z.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new xe(n,this.h&t.h)};z.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new xe(n,this.h|t.h)};z.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new xe(n,this.h^t.h)};function Tx(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new xe(n,t.h)}function Yi(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,s=[],i=0;i<r;i++)s[i]=0<e?t.D(i+n)>>>e|t.D(i+n+1)<<32-e:t.D(i+n);return new xe(s,t.h)}Md.prototype.createWebChannel=Md.prototype.g;pn.prototype.send=pn.prototype.u;pn.prototype.open=pn.prototype.m;pn.prototype.close=pn.prototype.close;Oh.NO_ERROR=0;Oh.TIMEOUT=8;Oh.HTTP_ERROR=6;OI.COMPLETE="complete";$I.EventType=bc;bc.OPEN="a";bc.CLOSE="b";bc.ERROR="c";bc.MESSAGE="d";ft.prototype.listen=ft.prototype.O;He.prototype.listenOnce=He.prototype.P;He.prototype.getLastError=He.prototype.Sa;He.prototype.getLastErrorCode=He.prototype.Ia;He.prototype.getStatus=He.prototype.da;He.prototype.getResponseJson=He.prototype.Wa;He.prototype.getResponseText=He.prototype.ja;He.prototype.send=He.prototype.ha;He.prototype.setWithCredentials=He.prototype.Oa;Fn.prototype.digest=Fn.prototype.l;Fn.prototype.reset=Fn.prototype.reset;Fn.prototype.update=Fn.prototype.j;xe.prototype.add=xe.prototype.add;xe.prototype.multiply=xe.prototype.R;xe.prototype.modulo=xe.prototype.gb;xe.prototype.compare=xe.prototype.X;xe.prototype.toNumber=xe.prototype.ea;xe.prototype.toString=xe.prototype.toString;xe.prototype.getBits=xe.prototype.D;xe.fromNumber=nr;xe.fromString=yN;var vP=function(){return new Md},xP=function(){return Ph()},jp=Oh,wP=OI,bP=Vi,Cx={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},_P=Nc,Iu=$I,IP=He,NP=Fn,To=xe;const jx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ut.UNAUTHENTICATED=new ut(null),ut.GOOGLE_CREDENTIALS=new ut("google-credentials-uid"),ut.FIRST_PARTY=new ut("first-party-uid"),ut.MOCK_USER=new ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ca="9.23.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Is=new vh("@firebase/firestore");function eg(){return Is.logLevel}function EP(t){Is.setLogLevel(t)}function P(t,...e){if(Is.logLevel<=le.DEBUG){const n=e.map(vy);Is.debug(`Firestore (${ca}): ${t}`,...n)}}function Qe(t,...e){if(Is.logLevel<=le.ERROR){const n=e.map(vy);Is.error(`Firestore (${ca}): ${t}`,...n)}}function Vn(t,...e){if(Is.logLevel<=le.WARN){const n=e.map(vy);Is.warn(`Firestore (${ca}): ${t}`,...n)}}function vy(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q(t="Unexpected state"){const e=`FIRESTORE (${ca}) INTERNAL ASSERTION FAILED: `+t;throw Qe(e),new Error(e)}function K(t,e){t||q()}function kP(t,e){t||q()}function U(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class D extends Wt{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vN{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class SP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(ut.UNAUTHENTICATED))}shutdown(){}}class TP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class CP{constructor(e){this.t=e,this.currentUser=ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new ht;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ht,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},a=c=>{P("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(P("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ht)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(P("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(K(typeof r.accessToken=="string"),new vN(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return K(e===null||typeof e=="string"),new ut(e)}}class jP{constructor(e,n,r){this.h=e,this.l=n,this.m=r,this.type="FirstParty",this.user=ut.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);const e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class DP{constructor(e,n,r){this.h=e,this.l=n,this.m=r}getToken(){return Promise.resolve(new jP(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(ut.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RP{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,n){const r=i=>{i.error!=null&&P("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.T;return this.T=i.token,P("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{P("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.I.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.I.getImmediate({optional:!0});i?s(i):P("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(K(typeof n.token=="string"),this.T=n.token,new AP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xN{static A(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=PP(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function ee(t,e){return t<e?-1:t>e?1:0}function Uo(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function wN(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new D(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new D(k.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new D(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(k.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $e.fromMillis(Date.now())}static fromDate(e){return $e.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new $e(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.timestamp=e}static fromTimestamp(e){return new G(e)}static min(){return new G(new $e(0,0))}static max(){return new G(new $e(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n,r){n===void 0?n=0:n>e.length&&q(),r===void 0?r=e.length-n:r>e.length-n&&q(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Yl.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Yl?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ce extends Yl{construct(e,n,r){return new ce(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new D(k.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new ce(n)}static emptyPath(){return new ce([])}}const OP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ye extends Yl{construct(e,n,r){return new Ye(e,n,r)}static isValidIdentifier(e){return OP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ye.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ye(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new D(k.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new D(k.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new D(k.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new D(k.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ye(n)}static emptyPath(){return new Ye([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F{constructor(e){this.path=e}static fromPath(e){return new F(ce.fromString(e))}static fromName(e){return new F(ce.fromString(e).popFirst(5))}static empty(){return new F(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new F(new ce(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function tg(t){return t.fields.find(e=>e.kind===2)}function Xs(t){return t.fields.filter(e=>e.kind!==2)}bN.UNKNOWN_ID=-1;class $P{constructor(e,n){this.fieldPath=e,this.kind=n}}class Ud{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Ud(0,mn.min())}}function _N(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=G.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new mn(s,F.empty(),e)}function IN(t){return new mn(t.readTime,t.key,-1)}class mn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new mn(G.min(),F.empty(),-1)}static max(){return new mn(G.max(),F.empty(),-1)}}function xy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=F.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class EN{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fs(t){if(t.code!==k.FAILED_PRECONDITION||t.message!==NN)throw t;P("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new E((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof E?n:E.resolve(n)}catch(n){return E.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):E.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):E.reject(n)}static resolve(e){return new E((n,r)=>{n(e)})}static reject(e){return new E((n,r)=>{r(e)})}static waitFor(e){return new E((n,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=E.resolve(!1);for(const r of e)n=n.next(s=>s?E.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new E((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++a,a===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new E((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.v=new ht,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{n.error?this.v.reject(new dl(e,n.error)):this.v.resolve()},this.transaction.onerror=r=>{const s=wy(r.target.error);this.v.reject(new dl(e,s))}}static open(e,n,r,s){try{return new Bh(n,e.transaction(s,r))}catch(i){throw new dl(n,i)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(P("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new MP(n)}}class Pn{constructor(e,n,r){this.name=e,this.version=n,this.V=r,Pn.S(Ue())===12.2&&Qe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return P("SimpleDb","Removing database:",e),Js(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Pl())return!1;if(Pn.C())return!0;const e=Ue(),n=Pn.S(e),r=0<n&&n<10,s=Pn.N(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.k)==="YES"}static M(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static N(e){const n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async $(e){return this.db||(P("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new dl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new D(k.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new D(k.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new dl(e,o))},s.onupgradeneeded=i=>{P("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.V.O(o,s.transaction,i.oldVersion,this.version).next(()=>{P("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.F&&(this.db.onversionchange=n=>this.F(n)),this.db}B(e){this.F=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.$(e);const a=Bh.open(this.db,e,i?"readonly":"readwrite",r),c=s(a).next(u=>(a.P(),u)).catch(u=>(a.abort(u),E.reject(u))).toPromise();return c.catch(()=>{}),await a.R,c}catch(a){const c=a,u=c.name!=="FirebaseError"&&o<3;if(P("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}class LP{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return Js(this.L.delete())}}class dl extends D{constructor(e,n){super(k.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Vs(t){return t.name==="IndexedDbTransactionError"}class MP{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(P("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(P("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Js(r)}add(e){return P("SimpleDb","ADD",this.store.name,e,e),Js(this.store.add(e))}get(e){return Js(this.store.get(e)).next(n=>(n===void 0&&(n=null),P("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return P("SimpleDb","DELETE",this.store.name,e),Js(this.store.delete(e))}count(){return P("SimpleDb","COUNT",this.store.name),Js(this.store.count())}j(e,n){const r=this.options(e,n);if(r.index||typeof this.store.getAll!="function"){const s=this.cursor(r),i=[];return this.W(s,(o,a)=>{i.push(a)}).next(()=>i)}{const s=this.store.getAll(r.range);return new E((i,o)=>{s.onerror=a=>{o(a.target.error)},s.onsuccess=a=>{i(a.target.result)}})}}H(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new E((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}J(e,n){P("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.Y=!1;const s=this.cursor(r);return this.W(s,(i,o,a)=>a.delete())}X(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.W(s,n)}Z(e){const n=this.cursor({});return new E((r,s)=>{n.onerror=i=>{const o=wy(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new E((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void s();const c=new LP(a),u=n(a.primaryKey,a.value,c);if(u instanceof E){const d=u.catch(h=>(c.done(),E.reject(h)));r.push(d)}c.isDone?s():c.K===null?a.continue():a.continue(c.K)}}).next(()=>E.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Js(t){return new E((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=wy(r.target.error);n(s)}})}let Dx=!1;function wy(t){const e=Pn.S(Ue());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Dx||(Dx=!0,setTimeout(()=>{throw r},0)),r}}return t}class FP{constructor(e,n){this.asyncQueue=e,this.tt=n,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}et(e){P("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{P("IndexBackiller",`Documents written: ${await this.tt.nt()}`)}catch(n){Vs(n)?P("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await Fs(n)}await this.et(6e4)})}}class VP{constructor(e,n){this.localStore=e,this.persistence=n}async nt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.st(n,e))}st(e,n){const r=new Set;let s=n,i=!0;return E.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return P("IndexBackiller",`Processing collection: ${o}`),this.it(e,o,s).next(a=>{s-=a,r.add(o)});i=!1})).next(()=>n-s)}it(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.rt(s,i)).next(a=>(P("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}rt(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=IN(i);xy(o,r)>0&&(r=o)}),new mn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>n.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ut&&this.ut(e),e}}Zt.ct=-1;function Sc(t){return t==null}function Xl(t){return t===0&&1/t==-1/0}function kN(t){return typeof t=="number"&&Number.isInteger(t)&&!Xl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ht(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Ax(e)),e=UP(t.get(n),e);return Ax(e)}function UP(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function Ax(t){return t+""}function rr(t){const e=t.length;if(K(e>=2),e===2)return K(t.charAt(0)===""&&t.charAt(1)===""),ce.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&q(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;s.length===0?c=a:(s+=a,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:q()}i=o+2}return new ce(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(t,e){return[t,Ht(e)]}function SN(t,e,n){return[t,Ht(e),n]}const zP={},BP=["prefixPath","collectionGroup","readTime","documentId"],qP=["prefixPath","collectionGroup","documentId"],WP=["collectionGroup","readTime","prefixPath","documentId"],HP=["canonicalId","targetId"],GP=["targetId","path"],KP=["path","targetId"],QP=["collectionId","parent"],YP=["indexId","uid"],XP=["uid","sequenceNumber"],JP=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ZP=["indexId","uid","orderedDocumentKey"],e5=["userId","collectionPath","documentId"],t5=["userId","collectionPath","largestBatchId"],n5=["userId","collectionGroup","largestBatchId"],TN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],r5=[...TN,"documentOverlays"],CN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],jN=CN,s5=[...jN,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng extends EN{constructor(e,n){super(),this.ht=e,this.currentSequenceNumber=n}}function mt(t,e){const n=U(t);return Pn.M(n.ht,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Px(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ui(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function DN(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ee{constructor(e,n){this.comparator=e,this.root=n||_t.EMPTY}insert(e,n){return new Ee(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,_t.BLACK,null,null))}remove(e){return new Ee(this.comparator,this.root.remove(e,this.comparator).copy(null,null,_t.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Nu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Nu(this.root,e,this.comparator,!1)}getReverseIterator(){return new Nu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Nu(this.root,e,this.comparator,!0)}}class Nu{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class _t{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??_t.RED,this.left=s??_t.EMPTY,this.right=i??_t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new _t(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return _t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return _t.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,_t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,_t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw q();const e=this.left.check();if(e!==this.right.check())throw q();return e+(this.isRed()?0:1)}}_t.EMPTY=null,_t.RED=!0,_t.BLACK=!1;_t.EMPTY=new class{constructor(){this.size=0}get key(){throw q()}get value(){throw q()}get color(){throw q()}get left(){throw q()}get right(){throw q()}copy(t,e,n,r,s){return this}insert(t,e,n){return new _t(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.comparator=e,this.data=new Ee(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Ox(this.data.getIterator())}getIteratorFrom(e){return new Ox(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof De)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new De(this.comparator);return n.data=e,n}}class Ox{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Xi(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.fields=e,e.sort(Ye.comparator)}static empty(){return new en([])}unionWith(e){let n=new De(Ye.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new en(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Uo(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i5(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new AN("Invalid base64 string: "+s):s}}(e);return new ot(n)}static fromUint8Array(e){const n=function(r){let s="";for(let i=0;i<r.length;++i)s+=String.fromCharCode(r[i]);return s}(e);return new ot(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ot.EMPTY_BYTE_STRING=new ot("");const o5=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ns(t){if(K(!!t),typeof t=="string"){let e=0;const n=o5.exec(t);if(K(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:We(t.seconds),nanos:We(t.nanos)}}function We(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Es(t){return typeof t=="string"?ot.fromBase64String(t):ot.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function by(t){const e=t.mapValue.fields.__previous_value__;return qh(e)?by(e):e}function Jl(t){const e=Ns(t.mapValue.fields.__local_write_time__.timestampValue);return new $e(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a5{constructor(e,n,r,s,i,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}}class ks{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ks("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ks&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Qu={nullValue:"NULL_VALUE"};function Si(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qh(t)?4:RN(t)?9007199254740991:10:q()}function hr(t,e){if(t===e)return!0;const n=Si(t);if(n!==Si(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jl(t).isEqual(Jl(e));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;const i=Ns(r.timestampValue),o=Ns(s.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,s){return Es(r.bytesValue).isEqual(Es(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,s){return We(r.geoPointValue.latitude)===We(s.geoPointValue.latitude)&&We(r.geoPointValue.longitude)===We(s.geoPointValue.longitude)}(t,e);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return We(r.integerValue)===We(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){const i=We(r.doubleValue),o=We(s.doubleValue);return i===o?Xl(i)===Xl(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return Uo(t.arrayValue.values||[],e.arrayValue.values||[],hr);case 10:return function(r,s){const i=r.mapValue.fields||{},o=s.mapValue.fields||{};if(Px(i)!==Px(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!hr(i[a],o[a])))return!1;return!0}(t,e);default:return q()}}function Zl(t,e){return(t.values||[]).find(n=>hr(n,e))!==void 0}function Ss(t,e){if(t===e)return 0;const n=Si(t),r=Si(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(s,i){const o=We(s.integerValue||s.doubleValue),a=We(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return $x(t.timestampValue,e.timestampValue);case 4:return $x(Jl(t),Jl(e));case 5:return ee(t.stringValue,e.stringValue);case 6:return function(s,i){const o=Es(s),a=Es(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(s,i){const o=s.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const u=ee(o[c],a[c]);if(u!==0)return u}return ee(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,i){const o=ee(We(s.latitude),We(i.latitude));return o!==0?o:ee(We(s.longitude),We(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,i){const o=s.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const u=Ss(o[c],a[c]);if(u)return u}return ee(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,i){if(s===os.mapValue&&i===os.mapValue)return 0;if(s===os.mapValue)return 1;if(i===os.mapValue)return-1;const o=s.fields||{},a=Object.keys(o),c=i.fields||{},u=Object.keys(c);a.sort(),u.sort();for(let d=0;d<a.length&&d<u.length;++d){const h=ee(a[d],u[d]);if(h!==0)return h;const f=Ss(o[a[d]],c[u[d]]);if(f!==0)return f}return ee(a.length,u.length)}(t.mapValue,e.mapValue);default:throw q()}}function $x(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);const n=Ns(t),r=Ns(e),s=ee(n.seconds,r.seconds);return s!==0?s:ee(n.nanos,r.nanos)}function zo(t){return rg(t)}function rg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const s=Ns(r);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Es(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,F.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(r){let s="[",i=!0;for(const o of r.values||[])i?i=!1:s+=",",s+=rg(o);return s+"]"}(t.arrayValue):"mapValue"in t?function(r){const s=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const a of s)o?o=!1:i+=",",i+=`${a}:${rg(r.fields[a])}`;return i+"}"}(t.mapValue):q();var e,n}function Ti(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function sg(t){return!!t&&"integerValue"in t}function ec(t){return!!t&&"arrayValue"in t}function Lx(t){return!!t&&"nullValue"in t}function Mx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Yu(t){return!!t&&"mapValue"in t}function hl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ui(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=hl(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=hl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function RN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function l5(t){return"nullValue"in t?Qu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Ti(ks.empty(),F.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:q()}function c5(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Ti(ks.empty(),F.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?os:q()}function Fx(t,e){const n=Ss(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Vx(t,e){const n=Ss(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.value=e}static empty(){return new Nt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Yu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=hl(n)}setAll(e){let n=Ye.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=a.popLast()}o?r[a.lastSegment()]=hl(o):s.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Yu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return hr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Yu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Ui(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Nt(hl(this.value))}}function PN(t){const e=[];return Ui(t.fields,(n,r)=>{const s=new Ye([n]);if(Yu(r)){const i=PN(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new en(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e,n,r,s,i,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ce(e,0,G.min(),G.min(),G.min(),Nt.empty(),0)}static newFoundDocument(e,n,r,s){return new Ce(e,1,n,G.min(),r,s,0)}static newNoDocument(e,n){return new Ce(e,2,n,G.min(),G.min(),Nt.empty(),0)}static newUnknownDocument(e,n){return new Ce(e,3,n,G.min(),G.min(),Nt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(G.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Nt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Nt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=G.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ce&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ce(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,n){this.position=e,this.inclusive=n}}function Ux(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=F.comparator(F.fromName(o.referenceValue),n.key):r=Ss(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function zx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!hr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n="asc"){this.field=e,this.dir=n}}function u5(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{}class ie extends ON{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new d5(e,n,r):n==="array-contains"?new p5(e,r):n==="in"?new UN(e,r):n==="not-in"?new m5(e,r):n==="array-contains-any"?new g5(e,r):new ie(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new h5(e,r):new f5(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ss(n,this.value)):n!==null&&Si(this.value)===Si(n)&&this.matchesComparison(Ss(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class ye extends ON{constructor(e,n){super(),this.filters=e,this.op=n,this.lt=null}static create(e,n){return new ye(e,n)}matches(e){return Bo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){const e=this.ft(n=>n.isInequality());return e!==null?e.field:null}ft(e){for(const n of this.getFlattenedFilters())if(e(n))return n;return null}}function Bo(t){return t.op==="and"}function ig(t){return t.op==="or"}function _y(t){return $N(t)&&Bo(t)}function $N(t){for(const e of t.filters)if(e instanceof ye)return!1;return!0}function og(t){if(t instanceof ie)return t.field.canonicalString()+t.op.toString()+zo(t.value);if(_y(t))return t.filters.map(e=>og(e)).join(",");{const e=t.filters.map(n=>og(n)).join(",");return`${t.op}(${e})`}}function LN(t,e){return t instanceof ie?function(n,r){return r instanceof ie&&n.op===r.op&&n.field.isEqual(r.field)&&hr(n.value,r.value)}(t,e):t instanceof ye?function(n,r){return r instanceof ye&&n.op===r.op&&n.filters.length===r.filters.length?n.filters.reduce((s,i,o)=>s&&LN(i,r.filters[o]),!0):!1}(t,e):void q()}function MN(t,e){const n=t.filters.concat(e);return ye.create(n,t.op)}function FN(t){return t instanceof ie?function(e){return`${e.field.canonicalString()} ${e.op} ${zo(e.value)}`}(t):t instanceof ye?function(e){return e.op.toString()+" {"+e.getFilters().map(FN).join(" ,")+"}"}(t):"Filter"}class d5 extends ie{constructor(e,n,r){super(e,n,r),this.key=F.fromName(r.referenceValue)}matches(e){const n=F.comparator(e.key,this.key);return this.matchesComparison(n)}}class h5 extends ie{constructor(e,n){super(e,"in",n),this.keys=VN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class f5 extends ie{constructor(e,n){super(e,"not-in",n),this.keys=VN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function VN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>F.fromName(r.referenceValue))}class p5 extends ie{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ec(n)&&Zl(n.arrayValue,this.value)}}class UN extends ie{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Zl(this.value.arrayValue,n)}}class m5 extends ie{constructor(e,n){super(e,"not-in",n)}matches(e){if(Zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Zl(this.value.arrayValue,n)}}class g5 extends ie{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ec(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Zl(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y5{constructor(e,n=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.dt=null}}function ag(t,e=null,n=[],r=[],s=null,i=null,o=null){return new y5(t,e,n,r,s,i,o)}function Ci(t){const e=U(t);if(e.dt===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>og(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Sc(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>zo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>zo(r)).join(",")),e.dt=n}return e.dt}function Tc(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!u5(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!LN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!zx(t.startAt,e.startAt)&&zx(t.endAt,e.endAt)}function zd(t){return F.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Bd(t,e){return t.filters.filter(n=>n instanceof ie&&n.field.isEqual(e))}function Bx(t,e,n){let r=Qu,s=!0;for(const i of Bd(t,e)){let o=Qu,a=!0;switch(i.op){case"<":case"<=":o=l5(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=Qu}Fx({value:r,inclusive:s},{value:o,inclusive:a})<0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];Fx({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function qx(t,e,n){let r=os,s=!0;for(const i of Bd(t,e)){let o=os,a=!0;switch(i.op){case">=":case">":o=c5(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=os}Vx({value:r,inclusive:s},{value:o,inclusive:a})>0&&(r=o,s=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];Vx({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,n=null,r=[],s=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.wt=null,this._t=null,this.startAt,this.endAt}}function zN(t,e,n,r,s,i,o,a){return new Ur(t,e,n,r,s,i,o,a)}function ua(t){return new Ur(t)}function Wx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Iy(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Wh(t){for(const e of t.filters){const n=e.getFirstInequalityField();if(n!==null)return n}return null}function Ny(t){return t.collectionGroup!==null}function yi(t){const e=U(t);if(e.wt===null){e.wt=[];const n=Wh(e),r=Iy(e);if(n!==null&&r===null)n.isKeyField()||e.wt.push(new Co(n)),e.wt.push(new Co(Ye.keyField(),"asc"));else{let s=!1;for(const i of e.explicitOrderBy)e.wt.push(i),i.field.isKeyField()&&(s=!0);if(!s){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new Co(Ye.keyField(),i))}}}return e.wt}function on(t){const e=U(t);if(!e._t)if(e.limitType==="F")e._t=ag(e.path,e.collectionGroup,yi(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of yi(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new Co(i.field,o))}const r=e.endAt?new Ts(e.endAt.position,e.endAt.inclusive):null,s=e.startAt?new Ts(e.startAt.position,e.startAt.inclusive):null;e._t=ag(e.path,e.collectionGroup,n,e.filters,e.limit,r,s)}return e._t}function lg(t,e){e.getFirstInequalityField(),Wh(t);const n=t.filters.concat([e]);return new Ur(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function qd(t,e,n){return new Ur(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Cc(t,e){return Tc(on(t),on(e))&&t.limitType===e.limitType}function BN(t){return`${Ci(on(t))}|lt:${t.limitType}`}function cg(t){return`Query(target=${function(e){let n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=`, filters: [${e.filters.map(r=>FN(r)).join(", ")}]`),Sc(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=`, orderBy: [${e.orderBy.map(r=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(r)).join(", ")}]`),e.startAt&&(n+=", startAt: ",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>zo(r)).join(",")),e.endAt&&(n+=", endAt: ",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>zo(r)).join(",")),`Target(${n})`}(on(t))}; limitType=${t.limitType})`}function jc(t,e){return e.isFoundDocument()&&function(n,r){const s=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):F.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,r){for(const s of yi(n))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,r){for(const s of n.filters)if(!s.matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!function(s,i,o){const a=Ux(s,i,o);return s.inclusive?a<=0:a<0}(n.startAt,yi(n),r)||n.endAt&&!function(s,i,o){const a=Ux(s,i,o);return s.inclusive?a>=0:a>0}(n.endAt,yi(n),r))}(t,e)}function qN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function WN(t){return(e,n)=>{let r=!1;for(const s of yi(t)){const i=v5(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function v5(t,e,n){const r=t.field.isKeyField()?F.comparator(e.key,n.key):function(s,i,o){const a=i.data.field(s),c=o.data.field(s);return a!==null&&c!==null?Ss(a,c):q()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Us{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Ui(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return DN(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x5=new Ee(F.comparator);function tn(){return x5}const HN=new Ee(F.comparator);function Qa(...t){let e=HN;for(const n of t)e=e.insert(n.key,n);return e}function GN(t){let e=HN;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function sr(){return fl()}function KN(){return fl()}function fl(){return new Us(t=>t.toString(),(t,e)=>t.isEqual(e))}const w5=new Ee(F.comparator),b5=new De(F.comparator);function ne(...t){let e=b5;for(const n of t)e=e.add(n);return e}const _5=new De(ee);function Ey(){return _5}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xl(e)?"-0":e}}function YN(t){return{integerValue:""+t}}function XN(t,e){return kN(e)?YN(e):QN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(){this._=void 0}}function I5(t,e,n){return t instanceof qo?function(r,s){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&qh(s)&&(s=by(s)),s&&(i.fields.__previous_value__=s),{mapValue:i}}(n,e):t instanceof ji?ZN(t,e):t instanceof Di?eE(t,e):function(r,s){const i=JN(r,s),o=Hx(i)+Hx(r.gt);return sg(i)&&sg(r.gt)?YN(o):QN(r.serializer,o)}(t,e)}function N5(t,e,n){return t instanceof ji?ZN(t,e):t instanceof Di?eE(t,e):n}function JN(t,e){return t instanceof Wo?sg(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}class qo extends Hh{}class ji extends Hh{constructor(e){super(),this.elements=e}}function ZN(t,e){const n=tE(e);for(const r of t.elements)n.some(s=>hr(s,r))||n.push(r);return{arrayValue:{values:n}}}class Di extends Hh{constructor(e){super(),this.elements=e}}function eE(t,e){let n=tE(e);for(const r of t.elements)n=n.filter(s=>!hr(s,r));return{arrayValue:{values:n}}}class Wo extends Hh{constructor(e,n){super(),this.serializer=e,this.gt=n}}function Hx(t){return We(t.integerValue||t.doubleValue)}function tE(t){return ec(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,n){this.field=e,this.transform=n}}function E5(t,e){return t.field.isEqual(e.field)&&function(n,r){return n instanceof ji&&r instanceof ji||n instanceof Di&&r instanceof Di?Uo(n.elements,r.elements,hr):n instanceof Wo&&r instanceof Wo?hr(n.gt,r.gt):n instanceof qo&&r instanceof qo}(t.transform,e.transform)}class k5{constructor(e,n){this.version=e,this.transformResults=n}}class Oe{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Oe}static exists(e){return new Oe(void 0,e)}static updateTime(e){return new Oe(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Gh{}function nE(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ha(t.key,Oe.none()):new da(t.key,t.data,Oe.none());{const n=t.data,r=Nt.empty();let s=new De(Ye.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new zr(t.key,r,new en(s.toArray()),Oe.none())}}function S5(t,e,n){t instanceof da?function(r,s,i){const o=r.value.clone(),a=Kx(r.fieldTransforms,s,i.transformResults);o.setAll(a),s.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof zr?function(r,s,i){if(!Xu(r.precondition,s))return void s.convertToUnknownDocument(i.version);const o=Kx(r.fieldTransforms,s,i.transformResults),a=s.data;a.setAll(rE(r)),a.setAll(o),s.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(r,s,i){s.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function pl(t,e,n,r){return t instanceof da?function(s,i,o,a){if(!Xu(s.precondition,i))return o;const c=s.value.clone(),u=Qx(s.fieldTransforms,a,i);return c.setAll(u),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof zr?function(s,i,o,a){if(!Xu(s.precondition,i))return o;const c=Qx(s.fieldTransforms,a,i),u=i.data;return u.setAll(rE(s)),u.setAll(c),i.convertToFoundDocument(i.version,u).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,i,o){return Xu(s.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function T5(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=JN(r.transform,s||null);i!=null&&(n===null&&(n=Nt.empty()),n.set(r.field,i))}return n||null}function Gx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&Uo(n,r,(s,i)=>E5(s,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class da extends Gh{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class zr extends Gh{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function rE(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Kx(t,e,n){const r=new Map;K(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,N5(o,a,n[s]))}return r}function Qx(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,I5(i,o,e))}return r}class ha extends Gh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class ky extends Gh{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&S5(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=pl(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=pl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=KN();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(s.key)?null:a;const c=nE(o,a);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(G.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ne())}isEqual(e){return this.batchId===e.batchId&&Uo(this.mutations,e.mutations,(n,r)=>Gx(n,r))&&Uo(this.baseMutations,e.baseMutations,(n,r)=>Gx(n,r))}}class Ty{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){K(e.mutations.length===r.length);let s=w5;const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new Ty(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var et,ae;function sE(t){switch(t){default:return q();case k.CANCELLED:case k.UNKNOWN:case k.DEADLINE_EXCEEDED:case k.RESOURCE_EXHAUSTED:case k.INTERNAL:case k.UNAVAILABLE:case k.UNAUTHENTICATED:return!1;case k.INVALID_ARGUMENT:case k.NOT_FOUND:case k.ALREADY_EXISTS:case k.PERMISSION_DENIED:case k.FAILED_PRECONDITION:case k.ABORTED:case k.OUT_OF_RANGE:case k.UNIMPLEMENTED:case k.DATA_LOSS:return!0}}function iE(t){if(t===void 0)return Qe("GRPC error has no .code"),k.UNKNOWN;switch(t){case et.OK:return k.OK;case et.CANCELLED:return k.CANCELLED;case et.UNKNOWN:return k.UNKNOWN;case et.DEADLINE_EXCEEDED:return k.DEADLINE_EXCEEDED;case et.RESOURCE_EXHAUSTED:return k.RESOURCE_EXHAUSTED;case et.INTERNAL:return k.INTERNAL;case et.UNAVAILABLE:return k.UNAVAILABLE;case et.UNAUTHENTICATED:return k.UNAUTHENTICATED;case et.INVALID_ARGUMENT:return k.INVALID_ARGUMENT;case et.NOT_FOUND:return k.NOT_FOUND;case et.ALREADY_EXISTS:return k.ALREADY_EXISTS;case et.PERMISSION_DENIED:return k.PERMISSION_DENIED;case et.FAILED_PRECONDITION:return k.FAILED_PRECONDITION;case et.ABORTED:return k.ABORTED;case et.OUT_OF_RANGE:return k.OUT_OF_RANGE;case et.UNIMPLEMENTED:return k.UNIMPLEMENTED;case et.DATA_LOSS:return k.DATA_LOSS;default:return q()}}(ae=et||(et={}))[ae.OK=0]="OK",ae[ae.CANCELLED=1]="CANCELLED",ae[ae.UNKNOWN=2]="UNKNOWN",ae[ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ae[ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ae[ae.NOT_FOUND=5]="NOT_FOUND",ae[ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",ae[ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",ae[ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",ae[ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ae[ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ae[ae.ABORTED=10]="ABORTED",ae[ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",ae[ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",ae[ae.INTERNAL=13]="INTERNAL",ae[ae.UNAVAILABLE=14]="UNAVAILABLE",ae[ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Eu}static getOrCreateInstance(){return Eu===null&&(Eu=new jy),Eu}onExistenceFilterMismatch(e){const n=Symbol();return this.onExistenceFilterMismatchCallbacks.set(n,e),()=>this.onExistenceFilterMismatchCallbacks.delete(n)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(n=>n(e))}}let Eu=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oE(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j5=new To([4294967295,4294967295],0);function Yx(t){const e=oE().encode(t),n=new NP;return n.update(e),new Uint8Array(n.digest())}function Xx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new To([n,r],0),new To([s,i],0)]}class Dy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ya(`Invalid padding: ${n}`);if(r<0)throw new Ya(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ya(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ya(`Invalid padding when bitmap length is 0: ${n}`);this.It=8*e.length-n,this.Tt=To.fromNumber(this.It)}Et(e,n,r){let s=e.add(n.multiply(To.fromNumber(r)));return s.compare(j5)===1&&(s=new To([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;const n=Yx(e),[r,s]=Xx(n);for(let i=0;i<this.hashCount;i++){const o=this.Et(r,s,i);if(!this.At(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new Dy(i,s,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.It===0)return;const n=Yx(e),[r,s]=Xx(n);for(let i=0;i<this.hashCount;i++){const o=this.Et(r,s,i);this.Rt(o)}}Rt(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Ya extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ac{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Rc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Ac(G.min(),s,new Ee(ee),tn(),ne())}}class Rc{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Rc(r,n,ne(),ne(),ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,n,r,s){this.Pt=e,this.removedTargetIds=n,this.key=r,this.bt=s}}class aE{constructor(e,n){this.targetId=e,this.Vt=n}}class lE{constructor(e,n,r=ot.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Jx{constructor(){this.St=0,this.Dt=ew(),this.Ct=ot.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=ne(),n=ne(),r=ne();return this.Dt.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:q()}}),new Rc(this.Ct,this.xt,e,n,r)}Ft(){this.Nt=!1,this.Dt=ew()}Bt(e,n){this.Nt=!0,this.Dt=this.Dt.insert(e,n)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}}class D5{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=tn(),this.zt=Zx(),this.Wt=new Ee(ee)}Ht(e){for(const n of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(n,e.bt):this.Yt(n,e.key,e.bt);for(const n of e.removedTargetIds)this.Yt(n,e.key,e.bt)}Xt(e){this.forEachTarget(e,n=>{const r=this.Zt(n);switch(e.state){case 0:this.te(n)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(n);break;case 3:this.te(n)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(n)&&(this.ee(n),r.$t(e.resumeToken));break;default:q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Qt.forEach((r,s)=>{this.te(s)&&n(s)})}ne(e){var n;const r=e.targetId,s=e.Vt.count,i=this.se(r);if(i){const o=i.target;if(zd(o))if(s===0){const a=new F(o.path);this.Yt(r,a,Ce.newNoDocument(a,G.min()))}else K(s===1);else{const a=this.ie(r);if(a!==s){const c=this.re(e,a);if(c!==0){this.ee(r);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,u)}(n=jy.instance)===null||n===void 0||n.notifyOnExistenceFilterMismatch(function(u,d,h){var f,m,y,x,w,g;const p={localCacheCount:d,existenceFilterCount:h.count},v=h.unchangedNames;return v&&(p.bloomFilter={applied:u===0,hashCount:(f=v==null?void 0:v.hashCount)!==null&&f!==void 0?f:0,bitmapLength:(x=(y=(m=v==null?void 0:v.bits)===null||m===void 0?void 0:m.bitmap)===null||y===void 0?void 0:y.length)!==null&&x!==void 0?x:0,padding:(g=(w=v==null?void 0:v.bits)===null||w===void 0?void 0:w.padding)!==null&&g!==void 0?g:0}),p}(c,a,e.Vt))}}}}re(e,n){const{unchangedNames:r,count:s}=e.Vt;if(!r||!r.bits)return 1;const{bits:{bitmap:i="",padding:o=0},hashCount:a=0}=r;let c,u;try{c=Es(i).toUint8Array()}catch(d){if(d instanceof AN)return Vn("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw d}try{u=new Dy(c,o,a)}catch(d){return Vn(d instanceof Ya?"BloomFilter error: ":"Applying bloom filter failed: ",d),1}return u.It===0?1:s!==n-this.oe(e.targetId,u)?2:0}oe(e,n){const r=this.Gt.getRemoteKeysForTarget(e);let s=0;return r.forEach(i=>{const o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;n.vt(a)||(this.Yt(e,i,null),s++)}),s}ce(e){const n=new Map;this.Qt.forEach((i,o)=>{const a=this.se(o);if(a){if(i.current&&zd(a.target)){const c=new F(a.target.path);this.jt.get(c)!==null||this.ae(o,c)||this.Yt(o,c,Ce.newNoDocument(c,e))}i.Mt&&(n.set(o,i.Ot()),i.Ft())}});let r=ne();this.zt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const u=this.se(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.jt.forEach((i,o)=>o.setReadTime(e));const s=new Ac(e,n,this.Wt,this.jt,r);return this.jt=tn(),this.zt=Zx(),this.Wt=new Ee(ee),s}Jt(e,n){if(!this.te(e))return;const r=this.ae(e,n.key)?2:0;this.Zt(e).Bt(n.key,r),this.jt=this.jt.insert(n.key,n),this.zt=this.zt.insert(n.key,this.he(n.key).add(e))}Yt(e,n,r){if(!this.te(e))return;const s=this.Zt(e);this.ae(e,n)?s.Bt(n,1):s.Lt(n),this.zt=this.zt.insert(n,this.he(n).delete(e)),r&&(this.jt=this.jt.insert(n,r))}removeTarget(e){this.Qt.delete(e)}ie(e){const n=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let n=this.Qt.get(e);return n||(n=new Jx,this.Qt.set(e,n)),n}he(e){let n=this.zt.get(e);return n||(n=new De(ee),this.zt=this.zt.insert(e,n)),n}te(e){const n=this.se(e)!==null;return n||P("WatchChangeAggregator","Detected inactive target",e),n}se(e){const n=this.Qt.get(e);return n&&n.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new Jx),this.Gt.getRemoteKeysForTarget(e).forEach(n=>{this.Yt(e,n,null)})}ae(e,n){return this.Gt.getRemoteKeysForTarget(e).has(n)}}function Zx(){return new Ee(F.comparator)}function ew(){return new Ee(F.comparator)}const A5=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),R5=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),P5=(()=>({and:"AND",or:"OR"}))();class O5{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ug(t,e){return t.useProto3Json||Sc(e)?e:{value:e}}function Ho(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cE(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function $5(t,e){return Ho(t,e.toTimestamp())}function Xe(t){return K(!!t),G.fromTimestamp(function(e){const n=Ns(e);return new $e(n.seconds,n.nanos)}(t))}function Ay(t,e){return function(n){return new ce(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function uE(t){const e=ce.fromString(t);return K(xE(e)),e}function tc(t,e){return Ay(t.databaseId,e.path)}function lr(t,e){const n=uE(e);if(n.get(1)!==t.databaseId.projectId)throw new D(k.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new D(k.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new F(hE(n))}function dg(t,e){return Ay(t.databaseId,e)}function dE(t){const e=uE(t);return e.length===4?ce.emptyPath():hE(e)}function nc(t){return new ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function hE(t){return K(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function tw(t,e,n){return{name:tc(t,e),fields:n.value.mapValue.fields}}function fE(t,e,n){const r=lr(t,e.name),s=Xe(e.updateTime),i=e.createTime?Xe(e.createTime):G.min(),o=new Nt({mapValue:{fields:e.fields}}),a=Ce.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function L5(t,e){return"found"in e?function(n,r){K(!!r.found),r.found.name,r.found.updateTime;const s=lr(n,r.found.name),i=Xe(r.found.updateTime),o=r.found.createTime?Xe(r.found.createTime):G.min(),a=new Nt({mapValue:{fields:r.found.fields}});return Ce.newFoundDocument(s,i,o,a)}(t,e):"missing"in e?function(n,r){K(!!r.missing),K(!!r.readTime);const s=lr(n,r.missing),i=Xe(r.readTime);return Ce.newNoDocument(s,i)}(t,e):q()}function M5(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:q()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(K(u===void 0||typeof u=="string"),ot.fromBase64String(u||"")):(K(u===void 0||u instanceof Uint8Array),ot.fromUint8Array(u||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?k.UNKNOWN:iE(c.code);return new D(u,c.message||"")}(o);n=new lE(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=lr(t,r.document.name),i=Xe(r.document.updateTime),o=r.document.createTime?Xe(r.document.createTime):G.min(),a=new Nt({mapValue:{fields:r.document.fields}}),c=Ce.newFoundDocument(s,i,o,a),u=r.targetIds||[],d=r.removedTargetIds||[];n=new Ju(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=lr(t,r.document),i=r.readTime?Xe(r.readTime):G.min(),o=Ce.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Ju([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=lr(t,r.document),i=r.removedTargetIds||[];n=new Ju([],i,s,null)}else{if(!("filter"in e))return q();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new C5(s,i),a=r.targetId;n=new aE(a,o)}}return n}function rc(t,e){let n;if(e instanceof da)n={update:tw(t,e.key,e.value)};else if(e instanceof ha)n={delete:tc(t,e.key)};else if(e instanceof zr)n={update:tw(t,e.key,e.data),updateMask:q5(e.fieldMask)};else{if(!(e instanceof ky))return q();n={verify:tc(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,i){const o=i.transform;if(o instanceof qo)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof ji)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Di)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Wo)return{fieldPath:i.field.canonicalString(),increment:o.gt};throw q()}(0,r))),e.precondition.isNone||(n.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:$5(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:q()}(t,e.precondition)),n}function hg(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?Oe.updateTime(Xe(s.updateTime)):s.exists!==void 0?Oe.exists(s.exists):Oe.none()}(e.currentDocument):Oe.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(i,o){let a=null;if("setToServerValue"in o)K(o.setToServerValue==="REQUEST_TIME"),a=new qo;else if("appendMissingElements"in o){const u=o.appendMissingElements.values||[];a=new ji(u)}else if("removeAllFromArray"in o){const u=o.removeAllFromArray.values||[];a=new Di(u)}else"increment"in o?a=new Wo(i,o.increment):q();const c=Ye.fromServerFormat(o.fieldPath);return new Dc(c,a)}(t,s)):[];if(e.update){e.update.name;const s=lr(t,e.update.name),i=new Nt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new en(c.map(u=>Ye.fromServerFormat(u)))}(e.updateMask);return new zr(s,i,o,n,r)}return new da(s,i,n,r)}if(e.delete){const s=lr(t,e.delete);return new ha(s,n)}if(e.verify){const s=lr(t,e.verify);return new ky(s,n)}return q()}function F5(t,e){return t&&t.length>0?(K(e!==void 0),t.map(n=>function(r,s){let i=r.updateTime?Xe(r.updateTime):Xe(s);return i.isEqual(G.min())&&(i=Xe(s)),new k5(i,r.transformResults||[])}(n,e))):[]}function pE(t,e){return{documents:[dg(t,e.path)]}}function mE(t,e){const n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=dg(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=dg(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const s=function(c){if(c.length!==0)return vE(ye.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const i=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:Zi(d.field),direction:U5(d.dir)}}(u))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=ug(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function gE(t){let e=dE(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){K(r===1);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(d){const h=yE(d);return h instanceof ye&&_y(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(d=>function(h){return new Co(eo(h.field),function(f){switch(f){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(d)));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Sc(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){const h=!!d.before,f=d.values||[];return new Ts(f,h)}(n.startAt));let u=null;return n.endAt&&(u=function(d){const h=!d.before,f=d.values||[];return new Ts(f,h)}(n.endAt)),zN(e,s,o,i,a,"F",c,u)}function V5(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return q()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function yE(t){return t.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":const n=eo(e.unaryFilter.field);return ie.create(n,"==",{doubleValue:NaN});case"IS_NULL":const r=eo(e.unaryFilter.field);return ie.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=eo(e.unaryFilter.field);return ie.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=eo(e.unaryFilter.field);return ie.create(i,"!=",{nullValue:"NULL_VALUE"});default:return q()}}(t):t.fieldFilter!==void 0?function(e){return ie.create(eo(e.fieldFilter.field),function(n){switch(n){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return q()}}(e.fieldFilter.op),e.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(e){return ye.create(e.compositeFilter.filters.map(n=>yE(n)),function(n){switch(n){case"AND":return"and";case"OR":return"or";default:return q()}}(e.compositeFilter.op))}(t):q()}function U5(t){return A5[t]}function z5(t){return R5[t]}function B5(t){return P5[t]}function Zi(t){return{fieldPath:t.canonicalString()}}function eo(t){return Ye.fromServerFormat(t.fieldPath)}function vE(t){return t instanceof ie?function(e){if(e.op==="=="){if(Mx(e.value))return{unaryFilter:{field:Zi(e.field),op:"IS_NAN"}};if(Lx(e.value))return{unaryFilter:{field:Zi(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Mx(e.value))return{unaryFilter:{field:Zi(e.field),op:"IS_NOT_NAN"}};if(Lx(e.value))return{unaryFilter:{field:Zi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zi(e.field),op:z5(e.op),value:e.value}}}(t):t instanceof ye?function(e){const n=e.getFilters().map(r=>vE(r));return n.length===1?n[0]:{compositeFilter:{op:B5(e.op),filters:n}}}(t):q()}function q5(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function xE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Er{constructor(e,n,r,s,i=G.min(),o=G.min(),a=ot.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new Er(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Er(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wE{constructor(e){this.fe=e}}function W5(t,e){let n;if(e.document)n=fE(t.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=F.fromSegments(e.noDocument.path),s=Ri(e.noDocument.readTime);n=Ce.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return q();{const r=F.fromSegments(e.unknownDocument.path),s=Ri(e.unknownDocument.version);n=Ce.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(r){const s=new $e(r[0],r[1]);return G.fromTimestamp(s)}(e.readTime)),n}function nw(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Wd(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,i){return{name:tc(s,i.key),fields:i.data.value.mapValue.fields,updateTime:Ho(s,i.version.toTimestamp()),createTime:Ho(s,i.createTime.toTimestamp())}}(t.fe,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ai(e.version)};else{if(!e.isUnknownDocument())return q();r.unknownDocument={path:n.path.toArray(),version:Ai(e.version)}}return r}function Wd(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ai(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Ri(t){const e=new $e(t.seconds,t.nanoseconds);return G.fromTimestamp(e)}function Zs(t,e){const n=(e.baseMutations||[]).map(i=>hg(t.fe,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>hg(t.fe,i)),s=$e.fromMillis(e.localWriteTimeMs);return new Sy(e.batchId,s,n,r)}function Xa(t){const e=Ri(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Ri(t.lastLimboFreeSnapshotVersion):G.min();let r;var s;return t.query.documents!==void 0?(K((s=t.query).documents.length===1),r=on(ua(dE(s.documents[0])))):r=function(i){return on(gE(i))}(t.query),new Er(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,ot.fromBase64String(t.resumeToken))}function bE(t,e){const n=Ai(e.snapshotVersion),r=Ai(e.lastLimboFreeSnapshotVersion);let s;s=zd(e.target)?pE(t.fe,e.target):mE(t.fe,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ci(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Ry(t){const e=gE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?qd(e,e.limit,"L"):e}function Dp(t,e){return new Cy(e.largestBatchId,hg(t.fe,e.overlayMutation))}function rw(t,e){const n=e.path.lastSegment();return[t,Ht(e.path.popLast()),n]}function sw(t,e,n,r){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:Ai(r.readTime),documentKey:Ht(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{getBundleMetadata(e,n){return iw(e).get(n).next(r=>{if(r)return{id:(s=r).bundleId,createTime:Ri(s.createTime),version:s.version};var s})}saveBundleMetadata(e,n){return iw(e).put({bundleId:(r=n).id,createTime:Ai(Xe(r.createTime)),version:r.version});var r}getNamedQuery(e,n){return ow(e).get(n).next(r=>{if(r)return{name:(s=r).name,query:Ry(s.bundledQuery),readTime:Ri(s.readTime)};var s})}saveNamedQuery(e,n){return ow(e).put(function(r){return{name:r.name,readTime:Ai(Xe(r.readTime)),bundledQuery:r.bundledQuery}}(n))}}function iw(t){return mt(t,"bundles")}function ow(t){return mt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e,n){this.serializer=e,this.userId=n}static de(e,n){const r=n.uid||"";return new Kh(e,r)}getOverlay(e,n){return Oa(e).get(rw(this.userId,n)).next(r=>r?Dp(this.serializer,r):null)}getOverlays(e,n){const r=sr();return E.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const a=new Cy(n,o);s.push(this.we(e,a))}),E.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Ht(o.getCollectionPath())));const i=[];return s.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(Oa(e).J("collectionPathOverlayIndex",a))}),E.waitFor(i)}getOverlaysForCollection(e,n,r){const s=sr(),i=Ht(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Oa(e).j("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const u=Dp(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=sr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Oa(e).X({index:"collectionGroupOverlayIndex",range:a},(c,u,d)=>{const h=Dp(this.serializer,u);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>i)}we(e,n){return Oa(e).put(function(r,s,i){const[o,a,c]=rw(s,i.mutation.key);return{userId:s,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:rc(r.fe,i.mutation)}}(this.serializer,this.userId,n))}}function Oa(t){return mt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ei{constructor(){}_e(e,n){this.me(e,n),n.ge()}me(e,n){if("nullValue"in e)this.ye(n,5);else if("booleanValue"in e)this.ye(n,10),n.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(n,15),n.pe(We(e.integerValue));else if("doubleValue"in e){const r=We(e.doubleValue);isNaN(r)?this.ye(n,13):(this.ye(n,15),Xl(r)?n.pe(0):n.pe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.ye(n,20),typeof r=="string"?n.Ie(r):(n.Ie(`${r.seconds||""}`),n.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,n),this.Ee(n);else if("bytesValue"in e)this.ye(n,30),n.Ae(Es(e.bytesValue)),this.Ee(n);else if("referenceValue"in e)this.ve(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.ye(n,45),n.pe(r.latitude||0),n.pe(r.longitude||0)}else"mapValue"in e?RN(e)?this.ye(n,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,n),this.Ee(n)):"arrayValue"in e?(this.Pe(e.arrayValue,n),this.Ee(n)):q()}Te(e,n){this.ye(n,25),this.be(e,n)}be(e,n){n.Ie(e)}Re(e,n){const r=e.fields||{};this.ye(n,55);for(const s of Object.keys(r))this.Te(s,n),this.me(r[s],n)}Pe(e,n){const r=e.values||[];this.ye(n,50);for(const s of r)this.me(s,n)}ve(e,n){this.ye(n,37),F.fromName(e).path.forEach(r=>{this.ye(n,60),this.be(r,n)})}ye(e,n){e.pe(n)}Ee(e){e.pe(2)}}ei.Ve=new ei;function G5(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function aw(t){const e=64-function(n){let r=0;for(let s=0;s<8;++s){const i=G5(255&n[s]);if(r+=i,i!==8)break}return r}(t);return Math.ceil(e/8)}class K5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.De(r.value),r=n.next();this.Ce()}xe(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ne(r.value),r=n.next();this.ke()}Me(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.De(r);else if(r<2048)this.De(960|r>>>6),this.De(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.De(480|r>>>12),this.De(128|63&r>>>6),this.De(128|63&r);else{const s=n.codePointAt(0);this.De(240|s>>>18),this.De(128|63&s>>>12),this.De(128|63&s>>>6),this.De(128|63&s)}}this.Ce()}$e(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ne(r);else if(r<2048)this.Ne(960|r>>>6),this.Ne(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ne(480|r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r);else{const s=n.codePointAt(0);this.Ne(240|s>>>18),this.Ne(128|63&s>>>12),this.Ne(128|63&s>>>6),this.Ne(128|63&s)}}this.ke()}Oe(e){const n=this.Fe(e),r=aw(n);this.Be(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}Le(e){const n=this.Fe(e),r=aw(n);this.Be(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){const n=function(s){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,s,!1),new Uint8Array(i.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}De(e){const n=255&e;n===0?(this.Ue(0),this.Ue(255)):n===255?(this.Ue(255),this.Ue(0)):this.Ue(n)}Ne(e){const n=255&e;n===0?(this.Ge(0),this.Ge(255)):n===255?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Q5{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}}class Y5{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}}class $a{constructor(){this.je=new K5,this.ze=new Q5(this.je),this.We=new Y5(this.je)}seed(e){this.je.seed(e)}He(e){return e===0?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,n,r,s){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=s}Je(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new ti(this.indexId,this.documentKey,this.arrayValue,r)}}function Kr(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=lw(t.arrayValue,e.arrayValue),n!==0?n:(n=lw(t.directionalValue,e.directionalValue),n!==0?n:F.comparator(t.documentKey,e.documentKey)))}function lw(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(const n of e.filters){const r=n;r.isInequality()?this.Ze=r:this.Xe.push(r)}}tn(e){K(e.collectionGroup===this.collectionId);const n=tg(e);if(n!==void 0&&!this.en(n))return!1;const r=Xs(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.en(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.Ze!==void 0){if(!s.has(this.Ze.field.canonicalString())){const a=r[i];if(!this.nn(this.Ze,a)||!this.sn(this.Ye[o++],a))return!1}++i}for(;i<r.length;++i){const a=r[i];if(o>=this.Ye.length||!this.sn(this.Ye[o++],a))return!1}return!0}en(e){for(const n of this.Xe)if(this.nn(n,e))return!0;return!1}nn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _E(t){var e,n;if(K(t instanceof ie||t instanceof ye),t instanceof ie){if(t instanceof UN){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>ie.create(t.field,"==",i)))||[];return ye.create(s,"or")}return t}const r=t.filters.map(s=>_E(s));return ye.create(r,t.op)}function J5(t){if(t.getFilters().length===0)return[];const e=mg(_E(t));return K(IE(e)),fg(e)||pg(e)?[e]:e.getFilters()}function fg(t){return t instanceof ie}function pg(t){return t instanceof ye&&_y(t)}function IE(t){return fg(t)||pg(t)||function(e){if(e instanceof ye&&ig(e)){for(const n of e.getFilters())if(!fg(n)&&!pg(n))return!1;return!0}return!1}(t)}function mg(t){if(K(t instanceof ie||t instanceof ye),t instanceof ie)return t;if(t.filters.length===1)return mg(t.filters[0]);const e=t.filters.map(r=>mg(r));let n=ye.create(e,t.op);return n=Hd(n),IE(n)?n:(K(n instanceof ye),K(Bo(n)),K(n.filters.length>1),n.filters.reduce((r,s)=>Py(r,s)))}function Py(t,e){let n;return K(t instanceof ie||t instanceof ye),K(e instanceof ie||e instanceof ye),n=t instanceof ie?e instanceof ie?function(r,s){return ye.create([r,s],"and")}(t,e):cw(t,e):e instanceof ie?cw(e,t):function(r,s){if(K(r.filters.length>0&&s.filters.length>0),Bo(r)&&Bo(s))return MN(r,s.getFilters());const i=ig(r)?r:s,o=ig(r)?s:r,a=i.filters.map(c=>Py(c,o));return ye.create(a,"or")}(t,e),Hd(n)}function cw(t,e){if(Bo(e))return MN(e,t.getFilters());{const n=e.filters.map(r=>Py(t,r));return ye.create(n,"or")}}function Hd(t){if(K(t instanceof ie||t instanceof ye),t instanceof ie)return t;const e=t.getFilters();if(e.length===1)return Hd(e[0]);if($N(t))return t;const n=e.map(s=>Hd(s)),r=[];return n.forEach(s=>{s instanceof ie?r.push(s):s instanceof ye&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:ye.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(){this.rn=new Oy}addToCollectionParentIndex(e,n){return this.rn.add(n),E.resolve()}getCollectionParents(e,n){return E.resolve(this.rn.getEntries(n))}addFieldIndex(e,n){return E.resolve()}deleteFieldIndex(e,n){return E.resolve()}getDocumentsMatchingTarget(e,n){return E.resolve(null)}getIndexType(e,n){return E.resolve(0)}getFieldIndexes(e,n){return E.resolve([])}getNextCollectionGroupToUpdate(e){return E.resolve(null)}getMinOffset(e,n){return E.resolve(mn.min())}getMinOffsetFromCollectionGroup(e,n){return E.resolve(mn.min())}updateCollectionGroup(e,n,r){return E.resolve()}updateIndexEntries(e,n){return E.resolve()}}class Oy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new De(ce.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new De(ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=new Uint8Array(0);class eO{constructor(e,n){this.user=e,this.databaseId=n,this.on=new Oy,this.un=new Us(r=>Ci(r),(r,s)=>Tc(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.on.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.on.add(n)});const i={collectionId:r,parent:Ht(s)};return uw(e).put(i)}return E.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[wN(n),""],!1,!0);return uw(e).j(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(rr(o.parent))}return r})}addFieldIndex(e,n){const r=Su(e),s=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Ma(e);return i.next(a=>{o.put(sw(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=Su(e),s=Ma(e),i=La(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const r=La(e);let s=!0;const i=new Map;return E.forEach(this.cn(n),o=>this.an(e,o).next(a=>{s&&(s=!!a),i.set(o,a)})).next(()=>{if(s){let o=ne();const a=[];return E.forEach(i,(c,u)=>{var d;P("IndexedDbIndexManager",`Using index ${d=c,`id=${d.indexId}|cg=${d.collectionGroup}|f=${d.fields.map(v=>`${v.fieldPath}:${v.kind}`).join(",")}`} to execute ${Ci(n)}`);const h=function(v,b){const I=tg(b);if(I===void 0)return null;for(const _ of Bd(v,I.fieldPath))switch(_.op){case"array-contains-any":return _.value.arrayValue.values||[];case"array-contains":return[_.value]}return null}(u,c),f=function(v,b){const I=new Map;for(const _ of Xs(b))for(const N of Bd(v,_.fieldPath))switch(N.op){case"==":case"in":I.set(_.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return I.set(_.fieldPath.canonicalString(),N.value),Array.from(I.values())}return null}(u,c),m=function(v,b){const I=[];let _=!0;for(const N of Xs(b)){const C=N.kind===0?Bx(v,N.fieldPath,v.startAt):qx(v,N.fieldPath,v.startAt);I.push(C.value),_&&(_=C.inclusive)}return new Ts(I,_)}(u,c),y=function(v,b){const I=[];let _=!0;for(const N of Xs(b)){const C=N.kind===0?qx(v,N.fieldPath,v.endAt):Bx(v,N.fieldPath,v.endAt);I.push(C.value),_&&(_=C.inclusive)}return new Ts(I,_)}(u,c),x=this.hn(c,u,m),w=this.hn(c,u,y),g=this.ln(c,u,f),p=this.fn(c.indexId,h,x,m.inclusive,w,y.inclusive,g);return E.forEach(p,v=>r.H(v,n.limit).next(b=>{b.forEach(I=>{const _=F.fromSegments(I.documentKey);o.has(_)||(o=o.add(_),a.push(_))})}))}).next(()=>a)}return E.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=J5(ye.create(e.filters,"and")).map(r=>ag(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}fn(e,n,r,s,i,o,a){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),d=[];for(let h=0;h<c;++h){const f=n?this.dn(n[h/u]):ku,m=this.wn(e,f,r[h%u],s),y=this._n(e,f,i[h%u],o),x=a.map(w=>this.wn(e,f,w,!0));d.push(...this.createRange(m,y,x))}return d}wn(e,n,r,s){const i=new ti(e,F.empty(),n,r);return s?i:i.Je()}_n(e,n,r,s){const i=new ti(e,F.empty(),n,r);return s?i.Je():i}an(e,n){const r=new X5(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const a of i)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const s=this.cn(n);return E.forEach(s,i=>this.an(e,i).next(o=>{o?r!==0&&o.fields.length<function(a){let c=new De(Ye.comparator),u=!1;for(const d of a.filters)for(const h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:c=c.add(h.field));for(const d of a.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(u?1:0)}(i)&&(r=1):r=0})).next(()=>function(i){return i.limit!==null}(n)&&s.length>1&&r===2?1:r)}mn(e,n){const r=new $a;for(const s of Xs(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.He(s.kind);ei.Ve._e(i,o)}return r.Qe()}dn(e){const n=new $a;return ei.Ve._e(e,n.He(0)),n.Qe()}gn(e,n){const r=new $a;return ei.Ve._e(Ti(this.databaseId,n),r.He(function(s){const i=Xs(s);return i.length===0?0:i[i.length-1].kind}(e))),r.Qe()}ln(e,n,r){if(r===null)return[];let s=[];s.push(new $a);let i=0;for(const o of Xs(e)){const a=r[i++];for(const c of s)if(this.yn(n,o.fieldPath)&&ec(a))s=this.pn(s,o,a);else{const u=c.He(o.kind);ei.Ve._e(a,u)}}return this.In(s)}hn(e,n,r){return this.ln(e,n,r.position)}In(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Qe();return n}pn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const a of s){const c=new $a;c.seed(a.Qe()),ei.Ve._e(o,c.He(n.kind)),i.push(c)}return i}yn(e,n){return!!e.filters.find(r=>r instanceof ie&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Su(e),s=Ma(e);return(n?r.j("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.j()).next(i=>{const o=[];return E.forEach(i,a=>s.get([a.indexId,this.uid]).next(c=>{o.push(function(u,d){const h=d?new Ud(d.sequenceNumber,new mn(Ri(d.readTime),new F(rr(d.documentKey)),d.largestBatchId)):Ud.empty(),f=u.fields.map(([m,y])=>new $P(Ye.fromServerFormat(m),y));return new bN(u.indexId,u.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:ee(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=Su(e),i=Ma(e);return this.Tn(e).next(o=>s.j("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>E.forEach(a,c=>i.put(sw(c.indexId,this.user,o,r)))))}updateIndexEntries(e,n){const r=new Map;return E.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?E.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(a=>(r.set(s.collectionGroup,a),E.forEach(a,c=>this.En(e,s,c).next(u=>{const d=this.An(i,c);return u.isEqual(d)?E.resolve():this.vn(e,i,c,u,d)}))))})}Rn(e,n,r,s){return La(e).put({indexId:s.indexId,uid:this.uid,arrayValue:s.arrayValue,directionalValue:s.directionalValue,orderedDocumentKey:this.gn(r,n.key),documentKey:n.key.path.toArray()})}Pn(e,n,r,s){return La(e).delete([s.indexId,this.uid,s.arrayValue,s.directionalValue,this.gn(r,n.key),n.key.path.toArray()])}En(e,n,r){const s=La(e);let i=new De(Kr);return s.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,n)])},(o,a)=>{i=i.add(new ti(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}An(e,n){let r=new De(Kr);const s=this.mn(n,e);if(s==null)return r;const i=tg(n);if(i!=null){const o=e.data.field(i.fieldPath);if(ec(o))for(const a of o.arrayValue.values||[])r=r.add(new ti(n.indexId,e.key,this.dn(a),s))}else r=r.add(new ti(n.indexId,e.key,ku,s));return r}vn(e,n,r,s,i){P("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,u,d,h){const f=a.getIterator(),m=c.getIterator();let y=Xi(f),x=Xi(m);for(;y||x;){let w=!1,g=!1;if(y&&x){const p=u(y,x);p<0?g=!0:p>0&&(w=!0)}else y!=null?g=!0:w=!0;w?(d(x),x=Xi(m)):g?(h(y),y=Xi(f)):(y=Xi(f),x=Xi(m))}}(s,i,Kr,a=>{o.push(this.Rn(e,n,r,a))},a=>{o.push(this.Pn(e,n,r,a))}),E.waitFor(o)}Tn(e){let n=1;return Ma(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Kr(o,a)).filter((o,a,c)=>!a||Kr(o,c[a-1])!==0);const s=[];s.push(e);for(const o of r){const a=Kr(o,e),c=Kr(o,n);if(a===0)s[0]=e.Je();else if(a>0&&c<0)s.push(o),s.push(o.Je());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.bn(s[o],s[o+1]))return[];const a=[s[o].indexId,this.uid,s[o].arrayValue,s[o].directionalValue,ku,[]],c=[s[o+1].indexId,this.uid,s[o+1].arrayValue,s[o+1].directionalValue,ku,[]];i.push(IDBKeyRange.bound(a,c))}return i}bn(e,n){return Kr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(dw)}getMinOffset(e,n){return E.mapArray(this.cn(n),r=>this.an(e,r).next(s=>s||q())).next(dw)}}function uw(t){return mt(t,"collectionParents")}function La(t){return mt(t,"indexEntries")}function Su(t){return mt(t,"indexConfiguration")}function Ma(t){return mt(t,"indexState")}function dw(t){K(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;xy(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new mn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Yt{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Yt(e,Yt.DEFAULT_COLLECTION_PERCENTILE,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NE(t,e,n){const r=t.store("mutations"),s=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.X({range:o},(d,h,f)=>(a++,f.delete()));i.push(c.next(()=>{K(a===1)}));const u=[];for(const d of n.mutations){const h=SN(e,d.key.path,n.batchId);i.push(s.delete(h)),u.push(d.key)}return E.waitFor(i).next(()=>u)}function Gd(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw q();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yt.DEFAULT_COLLECTION_PERCENTILE=10,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yt.DEFAULT=new Yt(41943040,Yt.DEFAULT_COLLECTION_PERCENTILE,Yt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yt.DISABLED=new Yt(-1,0,0);class Qh{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.Vn={}}static de(e,n,r,s){K(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new Qh(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Qr(e).X({index:"userMutationsIndex",range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=to(e),o=Qr(e);return o.add({}).next(a=>{K(typeof a=="number");const c=new Sy(a,n,r,s),u=function(f,m,y){const x=y.baseMutations.map(g=>rc(f.fe,g)),w=y.mutations.map(g=>rc(f.fe,g));return{userId:m,batchId:y.batchId,localWriteTimeMs:y.localWriteTime.toMillis(),baseMutations:x,mutations:w}}(this.serializer,this.userId,c),d=[];let h=new De((f,m)=>ee(f.canonicalString(),m.canonicalString()));for(const f of s){const m=SN(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),d.push(o.put(u)),d.push(i.put(m,zP))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Vn[a]=c.keys()}),E.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return Qr(e).get(n).next(r=>r?(K(r.userId===this.userId),Zs(this.serializer,r)):null)}Sn(e,n){return this.Vn[n]?E.resolve(this.Vn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.Vn[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Qr(e).X({index:"userMutationsIndex",range:s},(o,a,c)=>{a.userId===this.userId&&(K(a.batchId>=r),i=Zs(this.serializer,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Qr(e).X({index:"userMutationsIndex",range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Qr(e).j("userMutationsIndex",n).next(r=>r.map(s=>Zs(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ku(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return to(e).X({range:s},(o,a,c)=>{const[u,d,h]=o,f=rr(d);if(u===this.userId&&n.path.isEqual(f))return Qr(e).get(h).next(m=>{if(!m)throw q();K(m.userId===this.userId),i.push(Zs(this.serializer,m))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new De(ee);const s=[];return n.forEach(i=>{const o=Ku(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=to(e).X({range:a},(u,d,h)=>{const[f,m,y]=u,x=rr(m);f===this.userId&&i.path.isEqual(x)?r=r.add(y):h.done()});s.push(c)}),E.waitFor(s).next(()=>this.Dn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Ku(this.userId,r),o=IDBKeyRange.lowerBound(i);let a=new De(ee);return to(e).X({range:o},(c,u,d)=>{const[h,f,m]=c,y=rr(f);h===this.userId&&r.isPrefixOf(y)?y.length===s&&(a=a.add(m)):d.done()}).next(()=>this.Dn(e,a))}Dn(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Qr(e).get(i).next(o=>{if(o===null)throw q();K(o.userId===this.userId),r.push(Zs(this.serializer,o))}))}),E.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return NE(e.ht,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Cn(n.batchId)}),E.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return E.resolve();const r=IDBKeyRange.lowerBound([this.userId]),s=[];return to(e).X({range:r},(i,o,a)=>{if(i[0]===this.userId){const c=rr(i[1]);s.push(c)}else a.done()}).next(()=>{K(s.length===0)})})}containsKey(e,n){return EE(e,this.userId,n)}xn(e){return kE(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function EE(t,e,n){const r=Ku(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return to(t).X({range:i,Y:!0},(a,c,u)=>{const[d,h,f]=a;d===e&&h===s&&(o=!0),u.done()}).next(()=>o)}function Qr(t){return mt(t,"mutations")}function to(t){return mt(t,"documentMutations")}function kE(t){return mt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pi{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new Pi(0)}static Mn(){return new Pi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tO{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.$n(e).next(n=>{const r=new Pi(n.highestTargetId);return n.highestTargetId=r.next(),this.On(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(n=>G.fromTimestamp(new $e(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.$n(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.On(e,s)))}addTargetData(e,n){return this.Fn(e,n).next(()=>this.$n(e).next(r=>(r.targetCount+=1,this.Bn(n,r),this.On(e,r))))}updateTargetData(e,n){return this.Fn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ji(e).delete(n.targetId)).next(()=>this.$n(e)).next(r=>(K(r.targetCount>0),r.targetCount-=1,this.On(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Ji(e).X((o,a)=>{const c=Xa(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>E.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Ji(e).X((r,s)=>{const i=Xa(s);n(i)})}$n(e){return fw(e).get("targetGlobalKey").next(n=>(K(n!==null),n))}On(e,n){return fw(e).put("targetGlobalKey",n)}Fn(e,n){return Ji(e).put(bE(this.serializer,n))}Bn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.$n(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Ci(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Ji(e).X({range:s,index:"queryTargetsIndex"},(o,a,c)=>{const u=Xa(a);Tc(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=ts(e);return n.forEach(o=>{const a=Ht(o.path);s.push(i.put({targetId:r,path:a})),s.push(this.referenceDelegate.addReference(e,r,o))}),E.waitFor(s)}removeMatchingKeys(e,n,r){const s=ts(e);return E.forEach(n,i=>{const o=Ht(i.path);return E.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=ts(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=ts(e);let i=ne();return s.X({range:r,Y:!0},(o,a,c)=>{const u=rr(o[1]),d=new F(u);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=Ht(n.path),s=IDBKeyRange.bound([r],[wN(r)],!1,!0);let i=0;return ts(e).X({index:"documentTargetsIndex",Y:!0,range:s},([o,a],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}le(e,n){return Ji(e).get(n).next(r=>r?Xa(r):null)}}function Ji(t){return mt(t,"targets")}function fw(t){return mt(t,"targetGlobal")}function ts(t){return mt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw([t,e],[n,r]){const s=ee(t,n);return s===0?ee(e,r):s}class nO{constructor(e){this.Ln=e,this.buffer=new De(pw),this.qn=0}Un(){return++this.qn}Kn(e){const n=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();pw(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class rO{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}Qn(e){P("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Vs(n)?P("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Fs(n)}await this.Qn(3e5)})}}class sO{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.zn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return E.resolve(Zt.ct);const r=new nO(n);return this.jn.forEachTarget(e,s=>r.Kn(s.sequenceNumber)).next(()=>this.jn.Wn(e,s=>r.Kn(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(P("LruGarbageCollector","Garbage collection skipped; disabled"),E.resolve(hw)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(P("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hw):this.Hn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,n){let r,s,i,o,a,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(P("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),eg()<=le.DEBUG&&P("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),E.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function iO(t,e){return new sO(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e,n){this.db=e,this.garbageCollector=iO(this,n)}zn(e){const n=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Jn(e){let n=0;return this.Wn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Wn(e,n){return this.Yn(e,(r,s)=>n(s))}addReference(e,n,r){return Tu(e,r)}removeReference(e,n,r){return Tu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Tu(e,n)}Xn(e,n){return function(r,s){let i=!1;return kE(r).Z(o=>EE(r,o,s).next(a=>(a&&(i=!0),E.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.Yn(e,(o,a)=>{if(a<=n){const c=this.Xn(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,G.min()),ts(e).delete([0,Ht(o.path)])))});s.push(c)}}).next(()=>E.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Tu(e,n)}Yn(e,n){const r=ts(e);let s,i=Zt.ct;return r.X({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(i!==Zt.ct&&n(new F(rr(s)),i),i=u,s=c):i=Zt.ct}).next(()=>{i!==Zt.ct&&n(new F(rr(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tu(t,e){return ts(t).put(function(n,r){return{targetId:0,path:Ht(n.path),sequenceNumber:r}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(){this.changes=new Us(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ce.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?E.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Gs(e).put(r)}removeEntry(e,n,r){return Gs(e).delete(function(s,i){const o=s.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],Wd(i),o[o.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.Zn(e,r)))}getEntry(e,n){let r=Ce.newInvalidDocument(n);return Gs(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Fa(n))},(s,i)=>{r=this.ts(n,i)}).next(()=>r)}es(e,n){let r={size:0,document:Ce.newInvalidDocument(n)};return Gs(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(Fa(n))},(s,i)=>{r={document:this.ts(n,i),size:Gd(i)}}).next(()=>r)}getEntries(e,n){let r=tn();return this.ns(e,n,(s,i)=>{const o=this.ts(s,i);r=r.insert(s,o)}).next(()=>r)}ss(e,n){let r=tn(),s=new Ee(F.comparator);return this.ns(e,n,(i,o)=>{const a=this.ts(i,o);r=r.insert(i,a),s=s.insert(i,Gd(o))}).next(()=>({documents:r,rs:s}))}ns(e,n,r){if(n.isEmpty())return E.resolve();let s=new De(yw);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(Fa(s.first()),Fa(s.last())),o=s.getIterator();let a=o.getNext();return Gs(e).X({index:"documentKeyIndex",range:i},(c,u,d)=>{const h=F.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&yw(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.G(Fa(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s){const i=n.path,o=[i.popLast().toArray(),i.lastSegment(),Wd(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Gs(e).j(IDBKeyRange.bound(o,a,!0)).next(c=>{let u=tn();for(const d of c){const h=this.ts(F.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(jc(n,h)||s.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,n,r,s){let i=tn();const o=gw(n,r),a=gw(n,mn.max());return Gs(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,d)=>{const h=this.ts(F.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new lO(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return mw(e).get("remoteDocumentGlobalKey").next(n=>(K(!!n),n))}Zn(e,n){return mw(e).put("remoteDocumentGlobalKey",n)}ts(e,n){if(n){const r=W5(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(G.min())))return r}return Ce.newInvalidDocument(e)}}function TE(t){return new aO(t)}class lO extends SE{constructor(e,n){super(),this.os=e,this.trackRemovals=n,this.us=new Us(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new De((i,o)=>ee(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.us.get(i);if(n.push(this.os.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=nw(this.os.serializer,o);s=s.add(i.path.popLast());const u=Gd(c);r+=u-a.size,n.push(this.os.addEntry(e,i,c))}else if(r-=a.size,this.trackRemovals){const c=nw(this.os.serializer,o.convertToNoDocument(G.min()));n.push(this.os.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.os.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.os.updateMetadata(e,r)),E.waitFor(n)}getFromCache(e,n){return this.os.es(e,n).next(r=>(this.us.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.os.ss(e,n).next(({documents:r,rs:s})=>(s.forEach((i,o)=>{this.us.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function mw(t){return mt(t,"remoteDocumentGlobal")}function Gs(t){return mt(t,"remoteDocumentsV14")}function Fa(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function gw(t,e){const n=e.documentKey.path.toArray();return[t,Wd(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function yw(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=ee(n[i],r[i]),s)return s;return s=ee(n.length,r.length),s||(s=ee(n[n.length-2],r[r.length-2]),s||ee(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cO{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&pl(r.mutation,s,en.empty(),$e.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ne()){const s=sr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Qa();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=sr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ne()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,s){let i=tn();const o=fl(),a=fl();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof zr)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),pl(d.mutation,u,d.mutation.getFieldMask(),$e.now())):o.set(u.key,en.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return a.set(u,new cO(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=fl();let s=new Ee((o,a)=>o-a),i=ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||en.empty();d=a.applyToLocalView(u,d),r.set(c,d);const h=(s.get(a.batchId)||ne()).add(c);s=s.insert(a.batchId,h)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),u=c.key,d=c.value,h=KN();d.forEach(f=>{if(!i.has(f)){const m=nE(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return E.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r){return function(s){return F.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Ny(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r):this.getDocumentsMatchingCollectionQuery(e,n,r)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):E.resolve(sr());let a=-1,c=i;return o.next(u=>E.forEach(u,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(d)?E.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,ne())).next(d=>({batchId:a,changes:GN(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new F(n)).next(r=>{let s=Qa();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r){const s=n.collectionGroup;let i=Qa();return this.indexManager.getCollectionParents(e,s).next(o=>E.forEach(o,a=>{const c=function(u,d){return new Ur(d,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(n,a.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(u=>{u.forEach((d,h)=>{i=i.insert(d,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s))).next(i=>{s.forEach((a,c)=>{const u=c.getKey();i.get(u)===null&&(i=i.insert(u,Ce.newInvalidDocument(u)))});let o=Qa();return i.forEach((a,c)=>{const u=s.get(a);u!==void 0&&pl(u.mutation,c,en.empty(),$e.now()),jc(n,c)&&(o=o.insert(a,c))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,n){return E.resolve(this.cs.get(n))}saveBundleMetadata(e,n){var r;return this.cs.set(n.id,{id:(r=n).id,version:r.version,createTime:Xe(r.createTime)}),E.resolve()}getNamedQuery(e,n){return E.resolve(this.hs.get(n))}saveNamedQuery(e,n){return this.hs.set(n.name,function(r){return{name:r.name,query:Ry(r.bundledQuery),readTime:Xe(r.readTime)}}(n)),E.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dO{constructor(){this.overlays=new Ee(F.comparator),this.ls=new Map}getOverlay(e,n){return E.resolve(this.overlays.get(n))}getOverlays(e,n){const r=sr();return E.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.we(e,n,i)}),E.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.ls.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.ls.delete(r)),E.resolve()}getOverlaysForCollection(e,n,r){const s=sr(),i=n.length+1,o=new F(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return E.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Ee((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=sr(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=sr(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=s)););return E.resolve(a)}we(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.ls.get(s.largestBatchId).delete(r.key);this.ls.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Cy(n,r));let i=this.ls.get(n);i===void 0&&(i=ne(),this.ls.set(n,i)),this.ls.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this.fs=new De(lt.ds),this.ws=new De(lt._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,n){const r=new lt(e,n);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.ys(new lt(e,n))}ps(e,n){e.forEach(r=>this.removeReference(r,n))}Is(e){const n=new F(new ce([])),r=new lt(n,e),s=new lt(n,e+1),i=[];return this.ws.forEachInRange([r,s],o=>{this.ys(o),i.push(o.key)}),i}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){const n=new F(new ce([])),r=new lt(n,e),s=new lt(n,e+1);let i=ne();return this.ws.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new lt(e,0),r=this.fs.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class lt{constructor(e,n){this.key=e,this.As=n}static ds(e,n){return F.comparator(e.key,n.key)||ee(e.As,n.As)}static _s(e,n){return ee(e.As,n.As)||F.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.vs=1,this.Rs=new De(lt.ds)}checkEmpty(e){return E.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Sy(i,n,r,s);this.mutationQueue.push(o);for(const a of s)this.Rs=this.Rs.add(new lt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return E.resolve(o)}lookupMutationBatch(e,n){return E.resolve(this.Ps(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.bs(r),i=s<0?0:s;return E.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return E.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return E.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new lt(n,0),s=new lt(n,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([r,s],o=>{const a=this.Ps(o.As);i.push(a)}),E.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new De(ee);return n.forEach(s=>{const i=new lt(s,0),o=new lt(s,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([i,o],a=>{r=r.add(a.As)})}),E.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;F.isDocumentKey(i)||(i=i.child(""));const o=new lt(new F(i),0);let a=new De(ee);return this.Rs.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(a=a.add(c.As)),!0)},o),E.resolve(this.Vs(a))}Vs(e){const n=[];return e.forEach(r=>{const s=this.Ps(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){K(this.Ss(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Rs;return E.forEach(n.mutations,s=>{const i=new lt(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,n){const r=new lt(n,0),s=this.Rs.firstAfterOrEqual(r);return E.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,E.resolve()}Ss(e,n){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){const n=this.bs(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e){this.Ds=e,this.docs=new Ee(F.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Ds(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return E.resolve(r?r.document.mutableCopy():Ce.newInvalidDocument(n))}getEntries(e,n){let r=tn();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ce.newInvalidDocument(s))}),E.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=tn();const o=n.path,a=new F(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||xy(IN(d),r)<=0||(s.has(d.key)||jc(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return E.resolve(i)}getAllFromCollectionGroup(e,n,r,s){q()}Cs(e,n){return E.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new pO(this)}getSize(e){return E.resolve(this.size)}}class pO extends SE{constructor(e){super(),this.os=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.os.addEntry(e,s)):this.os.removeEntry(r)}),E.waitFor(n)}getFromCache(e,n){return this.os.getEntry(e,n)}getAllFromCache(e,n){return this.os.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e){this.persistence=e,this.xs=new Us(n=>Ci(n),Tc),this.lastRemoteSnapshotVersion=G.min(),this.highestTargetId=0,this.Ns=0,this.ks=new $y,this.targetCount=0,this.Ms=Pi.kn()}forEachTarget(e,n){return this.xs.forEach((r,s)=>n(s)),E.resolve()}getLastRemoteSnapshotVersion(e){return E.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return E.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),E.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Ns&&(this.Ns=n),E.resolve()}Fn(e){this.xs.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Ms=new Pi(n),this.highestTargetId=n),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,n){return this.Fn(n),this.targetCount+=1,E.resolve()}updateTargetData(e,n){return this.Fn(n),E.resolve()}removeTargetData(e,n){return this.xs.delete(n.target),this.ks.Is(n.targetId),this.targetCount-=1,E.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.xs.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),E.waitFor(i).next(()=>s)}getTargetCount(e){return E.resolve(this.targetCount)}getTargetData(e,n){const r=this.xs.get(n)||null;return E.resolve(r)}addMatchingKeys(e,n,r){return this.ks.gs(n,r),E.resolve()}removeMatchingKeys(e,n,r){this.ks.ps(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),E.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ks.Is(n),E.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ks.Es(n);return E.resolve(r)}containsKey(e,n){return E.resolve(this.ks.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jE{constructor(e,n){this.$s={},this.overlays={},this.Os=new Zt(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new mO(this),this.indexManager=new Z5,this.remoteDocumentCache=function(r){return new fO(r)}(r=>this.referenceDelegate.Ls(r)),this.serializer=new wE(n),this.qs=new uO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new dO,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.$s[e.toKey()];return r||(r=new hO(n,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,n,r){P("MemoryPersistence","Starting transaction:",e);const s=new gO(this.Os.next());return this.referenceDelegate.Us(),r(s).next(i=>this.referenceDelegate.Ks(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gs(e,n){return E.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,n)))}}class gO extends EN{constructor(e){super(),this.currentSequenceNumber=e}}class Yh{constructor(e){this.persistence=e,this.Qs=new $y,this.js=null}static zs(e){return new Yh(e)}get Ws(){if(this.js)return this.js;throw q()}addReference(e,n,r){return this.Qs.addReference(r,n),this.Ws.delete(r.toString()),E.resolve()}removeReference(e,n,r){return this.Qs.removeReference(r,n),this.Ws.add(r.toString()),E.resolve()}markPotentiallyOrphaned(e,n){return this.Ws.add(n.toString()),E.resolve()}removeTarget(e,n){this.Qs.Is(n.targetId).forEach(s=>this.Ws.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Ws.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}Us(){this.js=new Set}Ks(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return E.forEach(this.Ws,r=>{const s=F.fromPath(r);return this.Hs(e,s).next(i=>{i||n.removeEntry(s,G.min())})}).next(()=>(this.js=null,n.apply(e)))}updateLimboDocument(e,n){return this.Hs(e,n).next(r=>{r?this.Ws.delete(n.toString()):this.Ws.add(n.toString())})}Ls(e){return 0}Hs(e,n){return E.or([()=>E.resolve(this.Qs.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gs(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yO{constructor(e){this.serializer=e}O(e,n,r,s){const i=new Bh("createOrUpgrade",n);r<1&&s>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Rx,{unique:!0}),a.createObjectStore("documentMutations")}(e),vw(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=E.resolve();return r<3&&s>=3&&(r!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),vw(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:G.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",u)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").j().next(u=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Rx,{unique:!0});const d=c.store("mutations"),h=u.map(f=>d.put(f));return E.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.Ys(i))),r<6&&s>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(i)))),r<7&&s>=7&&(o=o.next(()=>this.Zs(i))),r<8&&s>=8&&(o=o.next(()=>this.ti(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.ei(i))),r<11&&s>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:e5});c.createIndex("collectionPathOverlayIndex",t5,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",n5,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:BP});c.createIndex("documentKeyIndex",qP),c.createIndex("collectionGroupIndex",WP)}(e)).next(()=>this.ni(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&s>=14&&(o=o.next(()=>this.si(e,i))),r<15&&s>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:YP}).createIndex("sequenceNumberIndex",XP,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:JP}).createIndex("documentKeyIndex",ZP,{unique:!1})}(e))),o}Xs(e){let n=0;return e.store("remoteDocuments").X((r,s)=>{n+=Gd(s)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Ys(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.j().next(s=>E.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",o).next(a=>E.forEach(a,c=>{K(c.userId===i.userId);const u=Zs(this.serializer,c);return NE(e,i.userId,u).next(()=>{})}))}))}Zs(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(s=>{const i=[];return r.X((o,a)=>{const c=new ce(o),u=function(d){return[0,Ht(d)]}(c);i.push(n.get(u).next(d=>d?E.resolve():(h=>n.put({targetId:0,path:Ht(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>E.waitFor(i))})}ti(e,n){e.createObjectStore("collectionParents",{keyPath:QP});const r=n.store("collectionParents"),s=new Oy,i=o=>{if(s.add(o)){const a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Ht(c)})}};return n.store("remoteDocuments").X({Y:!0},(o,a)=>{const c=new ce(o);return i(c.popLast())}).next(()=>n.store("documentMutations").X({Y:!0},([o,a,c],u)=>{const d=rr(a);return i(d.popLast())}))}ei(e){const n=e.store("targets");return n.X((r,s)=>{const i=Xa(s),o=bE(this.serializer,i);return n.put(o)})}ni(e,n){const r=n.store("remoteDocuments"),s=[];return r.X((i,o)=>{const a=n.store("remoteDocumentsV14"),c=(u=o,u.document?new F(ce.fromString(u.document.name).popFirst(5)):u.noDocument?F.fromSegments(u.noDocument.path):u.unknownDocument?F.fromSegments(u.unknownDocument.path):q()).path.toArray();var u;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(a.put(d))}).next(()=>E.waitFor(s))}si(e,n){const r=n.store("mutations"),s=TE(this.serializer),i=new jE(Yh.zs,this.serializer.fe);return r.j().next(o=>{const a=new Map;return o.forEach(c=>{var u;let d=(u=a.get(c.userId))!==null&&u!==void 0?u:ne();Zs(this.serializer,c).keys().forEach(h=>d=d.add(h)),a.set(c.userId,d)}),E.forEach(a,(c,u)=>{const d=new ut(u),h=Kh.de(this.serializer,d),f=i.getIndexManager(d),m=Qh.de(d,this.serializer,f,i.referenceDelegate);return new CE(s,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new ng(n,Zt.ct),c).next()})})}}function vw(t){t.createObjectStore("targetDocuments",{keyPath:GP}).createIndex("documentTargetsIndex",KP,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",HP,{unique:!0}),t.createObjectStore("targetGlobal")}const Ap="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Ly{constructor(e,n,r,s,i,o,a,c,u,d,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ii=i,this.window=o,this.document=a,this.ri=u,this.oi=d,this.ui=h,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=f=>Promise.resolve(),!Ly.D())throw new D(k.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oO(this,s),this.di=n+"main",this.serializer=new wE(c),this.wi=new Pn(this.di,this.ui,new yO(this.serializer)),this.Bs=new tO(this.referenceDelegate,this.serializer),this.remoteDocumentCache=TE(this.serializer),this.qs=new H5,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,d===!1&&Qe("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(k.FAILED_PRECONDITION,Ap);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new Zt(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){return this.fi=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Cu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(n=>{n||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(n=>this.isPrimary&&!n?this.Ai(e).next(()=>!1):!!n&&this.vi(e).next(()=>!0))).catch(e=>{if(Vs(e))return P("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return P("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return Va(e).get("owner").next(n=>E.resolve(this.Ri(n)))}Pi(e){return Cu(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Vi(this.li,18e5)){this.li=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=mt(n,"clientMetadata");return r.j().next(s=>{const i=this.Si(s,18e5),o=s.filter(a=>i.indexOf(a)===-1);return E.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this._i)for(const n of e)this._i.removeItem(this.Di(n.clientId))}}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?E.resolve(!0):Va(e).get("owner").next(n=>{if(n!==null&&this.Vi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)){if(this.Ri(n)&&this.networkEnabled)return!0;if(!this.Ri(n)){if(!n.allowTabSynchronization)throw new D(k.FAILED_PRECONDITION,Ap);return!1}}return!(!this.networkEnabled||!this.inForeground)||Cu(e).j().next(r=>this.Si(r,5e3).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,a=this.networkEnabled===s.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&P("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),await this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new ng(e,Zt.ct);return this.Ai(n).next(()=>this.Pi(n))}),this.wi.close(),this.Mi()}Si(e,n){return e.filter(r=>this.Vi(r.updateTimeMs,n)&&!this.Ci(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Cu(e).j().next(n=>this.Si(n,18e5).map(r=>r.clientId)))}get started(){return this.Fs}getMutationQueue(e,n){return Qh.de(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new eO(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return Kh.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,n,r){P("IndexedDbPersistence","Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=(o=this.ui)===15?s5:o===14?jN:o===13?CN:o===12?r5:o===11?TN:void q();var o;let a;return this.wi.runTransaction(e,s,i,c=>(a=new ng(c,this.Os?this.Os.next():Zt.ct),n==="readwrite-primary"?this.Ti(a).next(u=>!!u||this.Ei(a)).next(u=>{if(!u)throw Qe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new D(k.FAILED_PRECONDITION,NN);return r(a)}).next(u=>this.vi(a).next(()=>u)):this.Oi(a).next(()=>r(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}Oi(e){return Va(e).get("owner").next(n=>{if(n!==null&&this.Vi(n.leaseTimestampMs,5e3)&&!this.Ci(n.ownerId)&&!this.Ri(n)&&!(this.oi||this.allowTabSynchronization&&n.allowTabSynchronization))throw new D(k.FAILED_PRECONDITION,Ap)})}vi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Va(e).put("owner",n)}static D(){return Pn.D()}Ai(e){const n=Va(e);return n.get("owner").next(r=>this.Ri(r)?(P("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):E.resolve())}Vi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Qe(`Detected an update time that is in the future: ${e} > ${r}`),!1))}gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground=this.document.visibilityState==="visible")}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();const n=/(?:Version|Mobile)\/1[456]/;JC()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var n;try{const r=((n=this._i)===null||n===void 0?void 0:n.getItem(this.Di(e)))!==null;return P("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Qe("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){Qe("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Va(t){return mt(t,"owner")}function Cu(t){return mt(t,"clientMetadata")}function My(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.Fi=r,this.Bi=s}static Li(e,n){let r=ne(),s=ne();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Fy(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(){this.qi=!1}initialize(e,n){this.Ui=e,this.indexManager=n,this.qi=!0}getDocumentsMatchingQuery(e,n,r,s){return this.Ki(e,n).next(i=>i||this.Gi(e,n,s,r)).next(i=>i||this.Qi(e,n))}Ki(e,n){if(Wx(n))return E.resolve(null);let r=on(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=qd(n,null,"F"),r=on(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=ne(...i);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.ji(n,a);return this.zi(n,u,o,c.readTime)?this.Ki(e,qd(n,null,"F")):this.Wi(e,u,n,c)}))})))}Gi(e,n,r,s){return Wx(n)||s.isEqual(G.min())?this.Qi(e,n):this.Ui.getDocuments(e,r).next(i=>{const o=this.ji(n,i);return this.zi(n,o,r,s)?this.Qi(e,n):(eg()<=le.DEBUG&&P("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),cg(n)),this.Wi(e,o,n,_N(s,-1)))})}ji(e,n){let r=new De(WN(e));return n.forEach((s,i)=>{jc(e,i)&&(r=r.add(i))}),r}zi(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Qi(e,n){return eg()<=le.DEBUG&&P("QueryEngine","Using full collection scan to execute query:",cg(n)),this.Ui.getDocumentsMatchingQuery(e,n,mn.min())}Wi(e,n,r,s){return this.Ui.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vO{constructor(e,n,r,s){this.persistence=e,this.Hi=n,this.serializer=s,this.Ji=new Ee(ee),this.Yi=new Us(i=>Ci(i),Tc),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new CE(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Ji))}}function AE(t,e,n,r){return new vO(t,e,n,r)}async function RE(t,e){const n=U(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.tr(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let c=ne();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){a.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({er:u,removedBatchIds:o,addedBatchIds:a}))})})}function xO(t,e){const n=U(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,u){const d=c.batch,h=d.keys();let f=E.resolve();return h.forEach(m=>{f=f.next(()=>u.getEntry(a,m)).next(y=>{const x=c.docVersions.get(m);K(x!==null),y.version.compareTo(x)<0&&(d.applyToRemoteDocument(y,c),y.isValidDocument()&&(y.setReadTime(c.commitVersion),u.addEntry(y)))})}),f.next(()=>o.mutationQueue.removeMutationBatch(a,d))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=ne();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function PE(t){const e=U(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Bs.getLastRemoteSnapshotVersion(n))}function wO(t,e){const n=U(t),r=e.snapshotVersion;let s=n.Ji;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Zi.newChangeBuffer({trackRemovals:!0});s=n.Ji;const a=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;a.push(n.Bs.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Bs.addMatchingKeys(i,d.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(ot.EMPTY_BYTE_STRING,G.min()).withLastLimboFreeSnapshotVersion(G.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(h,m),function(y,x,w){return y.resumeToken.approximateByteSize()===0||x.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(f,m,d)&&a.push(n.Bs.updateTargetData(i,m))});let c=tn(),u=ne();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),a.push(OE(i,o,e.documentUpdates).next(d=>{c=d.nr,u=d.sr})),!r.isEqual(G.min())){const d=n.Bs.getLastRemoteSnapshotVersion(i).next(h=>n.Bs.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(d)}return E.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.Ji=s,i))}function OE(t,e,n){let r=ne(),s=ne();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=tn();return n.forEach((a,c)=>{const u=i.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(G.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):P("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{nr:o,sr:s}})}function bO(t,e){const n=U(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Go(t,e){const n=U(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Bs.getTargetData(r,e).next(i=>i?(s=i,E.resolve(s)):n.Bs.allocateTargetId(r).next(o=>(s=new Er(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Bs.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.Ji.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.Ji=n.Ji.insert(r.targetId,r),n.Yi.set(e,r.targetId)),r})}async function Ko(t,e,n){const r=U(t),s=r.Ji.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Vs(o))throw o;P("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(s.target)}function Kd(t,e,n){const r=U(t);let s=G.min(),i=ne();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,u){const d=U(a),h=d.Yi.get(u);return h!==void 0?E.resolve(d.Ji.get(h)):d.Bs.getTargetData(c,u)}(r,o,on(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,n?s:G.min(),n?i:ne())).next(a=>(ME(r,qN(e),a),{documents:a,ir:i})))}function $E(t,e){const n=U(t),r=U(n.Bs),s=n.Ji.get(e);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",i=>r.le(i,e).next(o=>o?o.target:null))}function LE(t,e){const n=U(t),r=n.Xi.get(e)||G.min();return n.persistence.runTransaction("Get new document changes","readonly",s=>n.Zi.getAllFromCollectionGroup(s,e,_N(r,-1),Number.MAX_SAFE_INTEGER)).then(s=>(ME(n,e,s),s))}function ME(t,e,n){let r=t.Xi.get(e)||G.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Xi.set(e,r)}async function _O(t,e,n,r){const s=U(t);let i=ne(),o=tn();for(const u of n){const d=e.rr(u.metadata.name);u.document&&(i=i.add(d));const h=e.ur(u);h.setReadTime(e.cr(u.metadata.readTime)),o=o.insert(d,h)}const a=s.Zi.newChangeBuffer({trackRemovals:!0}),c=await Go(s,function(u){return on(ua(ce.fromString(`__bundle__/docs/${u}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",u=>OE(u,a,o).next(d=>(a.apply(u),d)).next(d=>s.Bs.removeMatchingKeysForTargetId(u,c.targetId).next(()=>s.Bs.addMatchingKeys(u,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(u,d.nr,d.sr)).next(()=>d.nr)))}async function IO(t,e,n=ne()){const r=await Go(t,on(Ry(e.bundledQuery))),s=U(t);return s.persistence.runTransaction("Save named query","readwrite",i=>{const o=Xe(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return s.qs.saveNamedQuery(i,e);const a=r.withResumeToken(ot.EMPTY_BYTE_STRING,o);return s.Ji=s.Ji.insert(a.targetId,a),s.Bs.updateTargetData(i,a).next(()=>s.Bs.removeMatchingKeysForTargetId(i,r.targetId)).next(()=>s.Bs.addMatchingKeys(i,n,r.targetId)).next(()=>s.qs.saveNamedQuery(i,e))})}function xw(t,e){return`firestore_clients_${t}_${e}`}function ww(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Rp(t,e){return`firestore_targets_${t}_${e}`}class Qd{constructor(e,n,r,s){this.user=e,this.batchId=n,this.state=r,this.error=s}static ar(e,n,r){const s=JSON.parse(r);let i,o=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return o&&s.error&&(o=typeof s.error.message=="string"&&typeof s.error.code=="string",o&&(i=new D(s.error.code,s.error.message))),o?new Qd(e,n,s.state,i):(Qe("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ml{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static ar(e,n){const r=JSON.parse(n);let s,i=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return i&&r.error&&(i=typeof r.error.message=="string"&&typeof r.error.code=="string",i&&(s=new D(r.error.code,r.error.message))),i?new ml(e,r.state,s):(Qe("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}hr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Yd{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static ar(e,n){const r=JSON.parse(n);let s=typeof r=="object"&&r.activeTargetIds instanceof Array,i=Ey();for(let o=0;s&&o<r.activeTargetIds.length;++o)s=kN(r.activeTargetIds[o]),i=i.add(r.activeTargetIds[o]);return s?new Yd(e,i):(Qe("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Vy{constructor(e,n){this.clientId=e,this.onlineState=n}static ar(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Vy(n.clientId,n.onlineState):(Qe("SharedClientState",`Failed to parse online state: ${e}`),null)}}class gg{constructor(){this.activeTargetIds=Ey()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Pp{constructor(e,n,r,s,i){this.window=e,this.ii=n,this.persistenceKey=r,this.wr=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new Ee(ee),this.started=!1,this.yr=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.pr=xw(this.persistenceKey,this.wr),this.Ir=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new gg),this.Tr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.Rr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.$i();for(const r of e){if(r===this.wr)continue;const s=this.getItem(xw(this.persistenceKey,r));if(s){const i=Yd.ar(r,s);i&&(this.gr=this.gr.insert(i.clientId,i))}}this.Pr();const n=this.storage.getItem(this.vr);if(n){const r=this.br(n);r&&this.Vr(r)}for(const r of this.yr)this.mr(r);this.yr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let n=!1;return this.gr.forEach((r,s)=>{s.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,n,r){this.Dr(e,n,r),this.Cr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Rp(this.persistenceKey,e));if(r){const s=ml.ar(e,r);s&&(n=s.state)}}return this.Nr.lr(e),this.Pr(),n}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Rp(this.persistenceKey,e))}updateQueryState(e,n,r){this.kr(e,n,r)}handleUserChange(e,n,r){n.forEach(s=>{this.Cr(s)}),this.currentUser=e,r.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return P("SharedClientState","READ",e,n),n}setItem(e,n){P("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){P("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){const n=e;if(n.storageArea===this.storage){if(P("SharedClientState","EVENT",n.key,n.newValue),n.key===this.pr)return void Qe("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Tr.test(n.key)){if(n.newValue==null){const r=this.Or(n.key);return this.Fr(r,null)}{const r=this.Br(n.key,n.newValue);if(r)return this.Fr(r.clientId,r)}}else if(this.Er.test(n.key)){if(n.newValue!==null){const r=this.Lr(n.key,n.newValue);if(r)return this.qr(r)}}else if(this.Ar.test(n.key)){if(n.newValue!==null){const r=this.Ur(n.key,n.newValue);if(r)return this.Kr(r)}}else if(n.key===this.vr){if(n.newValue!==null){const r=this.br(n.newValue);if(r)return this.Vr(r)}}else if(n.key===this.Ir){const r=function(s){let i=Zt.ct;if(s!=null)try{const o=JSON.parse(s);K(typeof o=="number"),i=o}catch(o){Qe("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);r!==Zt.ct&&this.sequenceNumberHandler(r)}else if(n.key===this.Rr){const r=this.Gr(n.newValue);await Promise.all(r.map(s=>this.syncEngine.Qr(s)))}}}else this.yr.push(n)})}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,n,r){const s=new Qd(this.currentUser,e,n,r),i=ww(this.persistenceKey,this.currentUser,e);this.setItem(i,s.hr())}Cr(e){const n=ww(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Mr(e){const n={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(n))}kr(e,n,r){const s=Rp(this.persistenceKey,e),i=new ml(e,n,r);this.setItem(s,i.hr())}$r(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Rr,n)}Or(e){const n=this.Tr.exec(e);return n?n[1]:null}Br(e,n){const r=this.Or(e);return Yd.ar(r,n)}Lr(e,n){const r=this.Er.exec(e),s=Number(r[1]),i=r[2]!==void 0?r[2]:null;return Qd.ar(new ut(i),s,n)}Ur(e,n){const r=this.Ar.exec(e),s=Number(r[1]);return ml.ar(s,n)}br(e){return Vy.ar(e)}Gr(e){return JSON.parse(e)}async qr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.jr(e.batchId,e.state,e.error);P("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,n){const r=n?this.gr.insert(e,n):this.gr.remove(e),s=this.Sr(this.gr),i=this.Sr(r),o=[],a=[];return i.forEach(c=>{s.has(c)||o.push(c)}),s.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Wr(o,a).then(()=>{this.gr=r})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let n=Ey();return e.forEach((r,s)=>{n=n.unionWith(s.activeTargetIds)}),n}}class FE{constructor(){this.Hr=new gg,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,n,r){this.Jr[e]=n}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new gg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{Yr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bw{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){P("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.so)e(0)}no(){P("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ju=null;function Op(){return ju===null?ju=268435456+Math.round(2147483648*Math.random()):ju++,"0x"+ju.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EO={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kO{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rt="WebChannelConnection";class SO extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.mo=n+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,n,r,s,i){const o=Op(),a=this.To(e,n);P("RestConnection",`Sending RPC '${e}' ${o}:`,a,r);const c={};return this.Eo(c,s,i),this.Ao(e,a,c,r).then(u=>(P("RestConnection",`Received RPC '${e}' ${o}: `,u),u),u=>{throw Vn("RestConnection",`RPC '${e}' ${o} failed with error: `,u,"url: ",a,"request:",r),u})}vo(e,n,r,s,i,o){return this.Io(e,n,r,s,i)}Eo(e,n,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+ca,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}To(e,n){const r=EO[e];return`${this.mo}/v1/${n}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,n,r,s){const i=Op();return new Promise((o,a)=>{const c=new IP;c.setWithCredentials(!0),c.listenOnce(wP.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case jp.NO_ERROR:const d=c.getResponseJson();P(Rt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(d)),o(d);break;case jp.TIMEOUT:P(Rt,`RPC '${e}' ${i} timed out`),a(new D(k.DEADLINE_EXCEEDED,"Request time out"));break;case jp.HTTP_ERROR:const h=c.getStatus();if(P(Rt,`RPC '${e}' ${i} failed with status:`,h,"response text:",c.getResponseText()),h>0){let f=c.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const y=function(x){const w=x.toLowerCase().replace(/_/g,"-");return Object.values(k).indexOf(w)>=0?w:k.UNKNOWN}(m.status);a(new D(y,m.message))}else a(new D(k.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new D(k.UNAVAILABLE,"Connection failed."));break;default:q()}}finally{P(Rt,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);P(Rt,`RPC '${e}' ${i} sending request:`,s),c.send(n,"POST",u,r,15)})}Ro(e,n,r){const s=Op(),i=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=vP(),a=xP(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new _P({})),this.Eo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");P(Rt,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);let f=!1,m=!1;const y=new kO({ro:w=>{m?P(Rt,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(f||(P(Rt,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),P(Rt,`RPC '${e}' stream ${s} sending:`,w),h.send(w))},oo:()=>h.close()}),x=(w,g,p)=>{w.listen(g,v=>{try{p(v)}catch(b){setTimeout(()=>{throw b},0)}})};return x(h,Iu.EventType.OPEN,()=>{m||P(Rt,`RPC '${e}' stream ${s} transport opened.`)}),x(h,Iu.EventType.CLOSE,()=>{m||(m=!0,P(Rt,`RPC '${e}' stream ${s} transport closed`),y.wo())}),x(h,Iu.EventType.ERROR,w=>{m||(m=!0,Vn(Rt,`RPC '${e}' stream ${s} transport errored:`,w),y.wo(new D(k.UNAVAILABLE,"The operation could not be completed")))}),x(h,Iu.EventType.MESSAGE,w=>{var g;if(!m){const p=w.data[0];K(!!p);const v=p,b=v.error||((g=v[0])===null||g===void 0?void 0:g.error);if(b){P(Rt,`RPC '${e}' stream ${s} received error:`,b);const I=b.status;let _=function(C){const R=et[C];if(R!==void 0)return iE(R)}(I),N=b.message;_===void 0&&(_=k.INTERNAL,N="Unknown error status: "+I+" with message "+b.message),m=!0,y.wo(new D(_,N)),h.close()}else P(Rt,`RPC '${e}' stream ${s} received:`,p),y._o(p)}}),x(a,bP.STAT_EVENT,w=>{w.stat===Cx.PROXY?P(Rt,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===Cx.NOPROXY&&P(Rt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.fo()},0),y}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VE(){return typeof window<"u"?window:null}function Zu(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pc(t){return new O5(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ii=e,this.timerId=n,this.Po=r,this.bo=s,this.Vo=i,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();const n=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),s=Math.max(0,n-r);s>0&&P("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.So} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,s,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(e,n,r,s,i,o,a,c){this.ii=e,this.$o=r,this.Oo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Uy(e,n)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,n){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():n&&n.code===k.RESOURCE_EXHAUSTED?(Qe(n.toString()),Qe("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):n&&n.code===k.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(n)}Yo(){}auth(){this.state=1;const e=this.Xo(this.Fo),n=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Fo===n&&this.Zo(r,s)},r=>{e(()=>{const s=new D(k.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(s)})})}Zo(e,n){const r=this.Xo(this.Fo);this.stream=this.eu(e,n),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(s=>{r(()=>this.tu(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return P("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return n=>{this.ii.enqueueAndForget(()=>this.Fo===e?n():(P("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class TO extends UE{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}eu(e,n){return this.connection.Ro("Listen",e,n)}onMessage(e){this.qo.reset();const n=M5(this.serializer,e),r=function(s){if(!("targetChange"in s))return G.min();const i=s.targetChange;return i.targetIds&&i.targetIds.length?G.min():i.readTime?Xe(i.readTime):G.min()}(e);return this.listener.nu(n,r)}su(e){const n={};n.database=nc(this.serializer),n.addTarget=function(s,i){let o;const a=i.target;if(o=zd(a)?{documents:pE(s,a)}:{query:mE(s,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0){o.resumeToken=cE(s,i.resumeToken);const c=ug(s,i.expectedCount);c!==null&&(o.expectedCount=c)}else if(i.snapshotVersion.compareTo(G.min())>0){o.readTime=Ho(s,i.snapshotVersion.toTimestamp());const c=ug(s,i.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);const r=V5(this.serializer,e);r&&(n.labels=r),this.Wo(n)}iu(e){const n={};n.database=nc(this.serializer),n.removeTarget=e,this.Wo(n)}}class CO extends UE{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,n){return this.connection.Ro("Write",e,n)}onMessage(e){if(K(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();const n=F5(e.writeResults,e.commitTime),r=Xe(e.commitTime);return this.listener.cu(r,n)}return K(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){const e={};e.database=nc(this.serializer),this.Wo(e)}uu(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>rc(this.serializer,r))};this.Wo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.lu=!1}fu(){if(this.lu)throw new D(k.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,n,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Io(e,n,r,s,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(k.UNKNOWN,s.toString())})}vo(e,n,r,s){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.vo(e,n,r,i,o,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===k.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new D(k.UNKNOWN,i.toString())})}terminate(){this.lu=!0}}class DO{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(Qe(n),this.mu=!1):P("OnlineStateTracker",n)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=i,this.Pu.Yr(o=>{r.enqueueAndForget(async()=>{zs(this)&&(P("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=U(a);c.vu.add(4),await fa(c),c.bu.set("Unknown"),c.vu.delete(4),await Oc(c)}(this))})}),this.bu=new DO(r,s)}}async function Oc(t){if(zs(t))for(const e of t.Ru)await e(!0)}async function fa(t){for(const e of t.Ru)await e(!1)}function Xh(t,e){const n=U(t);n.Au.has(e.targetId)||(n.Au.set(e.targetId,e),qy(n)?By(n):ma(n).Ko()&&zy(n,e))}function sc(t,e){const n=U(t),r=ma(n);n.Au.delete(e),r.Ko()&&zE(n,e),n.Au.size===0&&(r.Ko()?r.jo():zs(n)&&n.bu.set("Unknown"))}function zy(t,e){if(t.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(G.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ma(t).su(e)}function zE(t,e){t.Vu.qt(e),ma(t).iu(e)}function By(t){t.Vu=new D5({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),le:e=>t.Au.get(e)||null,ue:()=>t.datastore.serializer.databaseId}),ma(t).start(),t.bu.gu()}function qy(t){return zs(t)&&!ma(t).Uo()&&t.Au.size>0}function zs(t){return U(t).vu.size===0}function BE(t){t.Vu=void 0}async function RO(t){t.Au.forEach((e,n)=>{zy(t,e)})}async function PO(t,e){BE(t),qy(t)?(t.bu.Iu(e),By(t)):t.bu.set("Unknown")}async function OO(t,e,n){if(t.bu.set("Online"),e instanceof lE&&e.state===2&&e.cause)try{await async function(r,s){const i=s.cause;for(const o of s.targetIds)r.Au.has(o)&&(await r.remoteSyncer.rejectListen(o,i),r.Au.delete(o),r.Vu.removeTarget(o))}(t,e)}catch(r){P("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Xd(t,r)}else if(e instanceof Ju?t.Vu.Ht(e):e instanceof aE?t.Vu.ne(e):t.Vu.Xt(e),!n.isEqual(G.min()))try{const r=await PE(t.localStore);n.compareTo(r)>=0&&await function(s,i){const o=s.Vu.ce(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const u=s.Au.get(c);u&&s.Au.set(c,u.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach((a,c)=>{const u=s.Au.get(a);if(!u)return;s.Au.set(a,u.withResumeToken(ot.EMPTY_BYTE_STRING,u.snapshotVersion)),zE(s,a);const d=new Er(u.target,a,c,u.sequenceNumber);zy(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(r){P("RemoteStore","Failed to raise snapshot:",r),await Xd(t,r)}}async function Xd(t,e,n){if(!Vs(e))throw e;t.vu.add(1),await fa(t),t.bu.set("Offline"),n||(n=()=>PE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{P("RemoteStore","Retrying IndexedDB access"),await n(),t.vu.delete(1),await Oc(t)})}function qE(t,e){return e().catch(n=>Xd(t,n,e))}async function pa(t){const e=U(t),n=Cs(e);let r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;$O(e);)try{const s=await bO(e.localStore,r);if(s===null){e.Eu.length===0&&n.jo();break}r=s.batchId,LO(e,s)}catch(s){await Xd(e,s)}WE(e)&&HE(e)}function $O(t){return zs(t)&&t.Eu.length<10}function LO(t,e){t.Eu.push(e);const n=Cs(t);n.Ko()&&n.ou&&n.uu(e.mutations)}function WE(t){return zs(t)&&!Cs(t).Uo()&&t.Eu.length>0}function HE(t){Cs(t).start()}async function MO(t){Cs(t).hu()}async function FO(t){const e=Cs(t);for(const n of t.Eu)e.uu(n.mutations)}async function VO(t,e,n){const r=t.Eu.shift(),s=Ty.from(r,e,n);await qE(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await pa(t)}async function UO(t,e){e&&Cs(t).ou&&await async function(n,r){if(s=r.code,sE(s)&&s!==k.ABORTED){const i=n.Eu.shift();Cs(n).Qo(),await qE(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,r)),await pa(n)}var s}(t,e),WE(t)&&HE(t)}async function _w(t,e){const n=U(t);n.asyncQueue.verifyOperationInProgress(),P("RemoteStore","RemoteStore received new credentials");const r=zs(n);n.vu.add(3),await fa(n),r&&n.bu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.vu.delete(3),await Oc(n)}async function yg(t,e){const n=U(t);e?(n.vu.delete(2),await Oc(n)):e||(n.vu.add(2),await fa(n),n.bu.set("Unknown"))}function ma(t){return t.Su||(t.Su=function(e,n,r){const s=U(e);return s.fu(),new TO(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{uo:RO.bind(null,t),ao:PO.bind(null,t),nu:OO.bind(null,t)}),t.Ru.push(async e=>{e?(t.Su.Qo(),qy(t)?By(t):t.bu.set("Unknown")):(await t.Su.stop(),BE(t))})),t.Su}function Cs(t){return t.Du||(t.Du=function(e,n,r){const s=U(e);return s.fu(),new CO(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(t.datastore,t.asyncQueue,{uo:MO.bind(null,t),ao:UO.bind(null,t),au:FO.bind(null,t),cu:VO.bind(null,t)}),t.Ru.push(async e=>{e?(t.Du.Qo(),await pa(t)):(await t.Du.stop(),t.Eu.length>0&&(P("RemoteStore",`Stopping write stream with ${t.Eu.length} pending writes`),t.Eu=[]))})),t.Du}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ht,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,a=new Wy(e,n,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(k.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ga(t,e){if(Qe("AsyncQueue",`${e}: ${t}`),Vs(t))return new D(k.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jo{constructor(e){this.comparator=e?(n,r)=>e(n,r)||F.comparator(n.key,r.key):(n,r)=>F.comparator(n.key,r.key),this.keyedMap=Qa(),this.sortedSet=new Ee(this.comparator)}static emptySet(e){return new jo(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof jo)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new jo;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(){this.Cu=new Ee(F.comparator)}track(e){const n=e.doc.key,r=this.Cu.get(n);r?e.type!==0&&r.type===3?this.Cu=this.Cu.insert(n,e):e.type===3&&r.type!==1?this.Cu=this.Cu.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Cu=this.Cu.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Cu=this.Cu.remove(n):e.type===1&&r.type===2?this.Cu=this.Cu.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Cu=this.Cu.insert(n,{type:2,doc:e.doc}):q():this.Cu=this.Cu.insert(n,e)}xu(){const e=[];return this.Cu.inorderTraversal((n,r)=>{e.push(r)}),e}}class Qo{constructor(e,n,r,s,i,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Qo(e,n,jo.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Cc(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(){this.Nu=void 0,this.listeners=[]}}class BO{constructor(){this.queries=new Us(e=>BN(e),Cc),this.onlineState="Unknown",this.ku=new Set}}async function Hy(t,e){const n=U(t),r=e.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new zO),s)try{i.Nu=await n.onListen(r)}catch(o){const a=ga(o,`Initialization of query '${cg(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,i),i.listeners.push(e),e.Mu(n.onlineState),i.Nu&&e.$u(i.Nu)&&Ky(n)}async function Gy(t,e){const n=U(t),r=e.query;let s=!1;const i=n.queries.get(r);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),s=i.listeners.length===0)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function qO(t,e){const n=U(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.$u(s)&&(r=!0);o.Nu=s}}r&&Ky(n)}function WO(t,e,n){const r=U(t),s=r.queries.get(e);if(s)for(const i of s.listeners)i.onError(n);r.queries.delete(e)}function Ky(t){t.ku.forEach(e=>{e.next()})}class Qy{constructor(e,n,r){this.query=e,this.Ou=n,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Qo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),n=!0):this.qu(e,this.onlineState)&&(this.Uu(e),n=!0),this.Bu=e,n}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let n=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),n=!0),n}qu(e,n){if(!e.fromCache)return!0;const r=n!=="Offline";return(!this.options.Ku||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;const n=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Uu(e){e=Qo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(e,n){this.Gu=e,this.byteLength=n}Qu(){return"metadata"in this.Gu}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nw{constructor(e){this.serializer=e}rr(e){return lr(this.serializer,e)}ur(e){return e.metadata.exists?fE(this.serializer,e.document,!1):Ce.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return Xe(e)}}class GO{constructor(e,n,r){this.ju=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=GE(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++n;const r=ce.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}Wu(e){const n=new Map,r=new Nw(this.serializer);for(const s of e)if(s.metadata.queries){const i=r.rr(s.metadata.name);for(const o of s.metadata.queries){const a=(n.get(o)||ne()).add(i);n.set(o,a)}}return n}async complete(){const e=await _O(this.localStore,new Nw(this.serializer),this.documents,this.ju.id),n=this.Wu(this.documents);for(const r of this.queries)await IO(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:e}}}function GE(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KE{constructor(e){this.key=e}}class QE{constructor(e){this.key=e}}class YE{constructor(e,n){this.query=e,this.Yu=n,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=ne(),this.mutatedKeys=ne(),this.tc=WN(e),this.ec=new jo(this.tc)}get nc(){return this.Yu}sc(e,n){const r=n?n.ic:new Iw,s=n?n.ec:this.ec;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),m=jc(this.query,h)?h:null,y=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;f&&m?f.data.isEqual(m.data)?y!==x&&(r.track({type:3,doc:m}),w=!0):this.rc(f,m)||(r.track({type:2,doc:m}),w=!0,(c&&this.tc(m,c)>0||u&&this.tc(m,u)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),w=!0):f&&!m&&(r.track({type:1,doc:f}),w=!0,(c||u)&&(a=!0)),w&&(m?(o=o.add(m),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{ec:o,ic:r,zi:a,mutatedKeys:i}}rc(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r){const s=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;const i=e.ic.xu();i.sort((u,d)=>function(h,f){const m=y=>{switch(y){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return q()}};return m(h)-m(f)}(u.type,d.type)||this.tc(u.doc,d.doc)),this.oc(r);const o=n?this.uc():[],a=this.Zu.size===0&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,i.length!==0||c?{snapshot:new Qo(this.query,e.ec,s,i,e.mutatedKeys,a===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new Iw,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(n=>this.Yu=this.Yu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Yu=this.Yu.delete(n)),this.current=e.current)}uc(){if(!this.current)return[];const e=this.Zu;this.Zu=ne(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});const n=[];return e.forEach(r=>{this.Zu.has(r)||n.push(new QE(r))}),this.Zu.forEach(r=>{e.has(r)||n.push(new KE(r))}),n}hc(e){this.Yu=e.ir,this.Zu=ne();const n=this.sc(e.documents);return this.applyChanges(n,!0)}lc(){return Qo.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}}class KO{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class QO{constructor(e){this.key=e,this.fc=!1}}class YO{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new Us(a=>BN(a),Cc),this._c=new Map,this.mc=new Set,this.gc=new Ee(F.comparator),this.yc=new Map,this.Ic=new $y,this.Tc={},this.Ec=new Map,this.Ac=Pi.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}}async function XO(t,e){const n=ev(t);let r,s;const i=n.wc.get(e);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.lc();else{const o=await Go(n.localStore,on(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,s=await Yy(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&Xh(n.remoteStore,o)}return s}async function Yy(t,e,n,r,s){t.Rc=(h,f,m)=>async function(y,x,w,g){let p=x.view.sc(w);p.zi&&(p=await Kd(y.localStore,x.query,!1).then(({documents:I})=>x.view.sc(I,p)));const v=g&&g.targetChanges.get(x.targetId),b=x.view.applyChanges(p,y.isPrimaryClient,v);return vg(y,x.targetId,b.cc),b.snapshot}(t,h,f,m);const i=await Kd(t.localStore,e,!0),o=new YE(e,i.ir),a=o.sc(i.documents),c=Rc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(a,t.isPrimaryClient,c);vg(t,n,u.cc);const d=new KO(e,n,o);return t.wc.set(e,d),t._c.has(n)?t._c.get(n).push(e):t._c.set(n,[e]),u.snapshot}async function JO(t,e){const n=U(t),r=n.wc.get(e),s=n._c.get(r.targetId);if(s.length>1)return n._c.set(r.targetId,s.filter(i=>!Cc(i,e))),void n.wc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Ko(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),sc(n.remoteStore,r.targetId),Yo(n,r.targetId)}).catch(Fs)):(Yo(n,r.targetId),await Ko(n.localStore,r.targetId,!0))}async function ZO(t,e,n){const r=tv(t);try{const s=await function(i,o){const a=U(i),c=$e.now(),u=o.reduce((f,m)=>f.add(m.key),ne());let d,h;return a.persistence.runTransaction("Locally write mutations","readwrite",f=>{let m=tn(),y=ne();return a.Zi.getEntries(f,u).next(x=>{m=x,m.forEach((w,g)=>{g.isValidDocument()||(y=y.add(w))})}).next(()=>a.localDocuments.getOverlayedDocuments(f,m)).next(x=>{d=x;const w=[];for(const g of o){const p=T5(g,d.get(g.key).overlayedDocument);p!=null&&w.push(new zr(g.key,p,PN(p.value.mapValue),Oe.exists(!0)))}return a.mutationQueue.addMutationBatch(f,c,w,o)}).next(x=>{h=x;const w=x.applyToLocalDocumentSet(d,y);return a.documentOverlayCache.saveOverlays(f,x.batchId,w)})}).then(()=>({batchId:h.batchId,changes:GN(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(i,o,a){let c=i.Tc[i.currentUser.toKey()];c||(c=new Ee(ee)),c=c.insert(o,a),i.Tc[i.currentUser.toKey()]=c}(r,s.batchId,n),await Br(r,s.changes),await pa(r.remoteStore)}catch(s){const i=ga(s,"Failed to persist write");n.reject(i)}}async function XE(t,e){const n=U(t);try{const r=await wO(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.yc.get(i);o&&(K(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.fc=!0:s.modifiedDocuments.size>0?K(o.fc):s.removedDocuments.size>0&&(K(o.fc),o.fc=!1))}),await Br(n,r,e)}catch(r){await Fs(r)}}function Ew(t,e,n){const r=U(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.wc.forEach((i,o)=>{const a=o.view.Mu(e);a.snapshot&&s.push(a.snapshot)}),function(i,o){const a=U(i);a.onlineState=o;let c=!1;a.queries.forEach((u,d)=>{for(const h of d.listeners)h.Mu(o)&&(c=!0)}),c&&Ky(a)}(r.eventManager,e),s.length&&r.dc.nu(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function e6(t,e,n){const r=U(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.yc.get(e),i=s&&s.key;if(i){let o=new Ee(F.comparator);o=o.insert(i,Ce.newNoDocument(i,G.min()));const a=ne().add(i),c=new Ac(G.min(),new Map,new Ee(ee),o,a);await XE(r,c),r.gc=r.gc.remove(i),r.yc.delete(e),Zy(r)}else await Ko(r.localStore,e,!1).then(()=>Yo(r,e,n)).catch(Fs)}async function t6(t,e){const n=U(t),r=e.batch.batchId;try{const s=await xO(n.localStore,e);Jy(n,r,null),Xy(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Br(n,s)}catch(s){await Fs(s)}}async function n6(t,e,n){const r=U(t);try{const s=await function(i,o){const a=U(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return a.mutationQueue.lookupMutationBatch(c,o).next(d=>(K(d!==null),u=d.keys(),a.mutationQueue.removeMutationBatch(c,d))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>a.localDocuments.getDocuments(c,u))})}(r.localStore,e);Jy(r,e,n),Xy(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Br(r,s)}catch(s){await Fs(s)}}async function r6(t,e){const n=U(t);zs(n.remoteStore)||P("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(i){const o=U(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(r===-1)return void e.resolve();const s=n.Ec.get(r)||[];s.push(e),n.Ec.set(r,s)}catch(r){const s=ga(r,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}}function Xy(t,e){(t.Ec.get(e)||[]).forEach(n=>{n.resolve()}),t.Ec.delete(e)}function Jy(t,e,n){const r=U(t);let s=r.Tc[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Tc[r.currentUser.toKey()]=s}}function Yo(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t._c.get(e))t.wc.delete(r),n&&t.dc.Pc(r,n);t._c.delete(e),t.isPrimaryClient&&t.Ic.Is(e).forEach(r=>{t.Ic.containsKey(r)||JE(t,r)})}function JE(t,e){t.mc.delete(e.path.canonicalString());const n=t.gc.get(e);n!==null&&(sc(t.remoteStore,n),t.gc=t.gc.remove(e),t.yc.delete(n),Zy(t))}function vg(t,e,n){for(const r of n)r instanceof KE?(t.Ic.addReference(r.key,e),s6(t,r)):r instanceof QE?(P("SyncEngine","Document no longer in limbo: "+r.key),t.Ic.removeReference(r.key,e),t.Ic.containsKey(r.key)||JE(t,r.key)):q()}function s6(t,e){const n=e.key,r=n.path.canonicalString();t.gc.get(n)||t.mc.has(r)||(P("SyncEngine","New document in limbo: "+n),t.mc.add(r),Zy(t))}function Zy(t){for(;t.mc.size>0&&t.gc.size<t.maxConcurrentLimboResolutions;){const e=t.mc.values().next().value;t.mc.delete(e);const n=new F(ce.fromString(e)),r=t.Ac.next();t.yc.set(r,new QO(n)),t.gc=t.gc.insert(n,r),Xh(t.remoteStore,new Er(on(ua(n.path)),r,"TargetPurposeLimboResolution",Zt.ct))}}async function Br(t,e,n){const r=U(t),s=[],i=[],o=[];r.wc.isEmpty()||(r.wc.forEach((a,c)=>{o.push(r.Rc(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u!=null&&u.fromCache?"not-current":"current"),u){s.push(u);const d=Fy.Li(c.targetId,u);i.push(d)}}))}),await Promise.all(o),r.dc.nu(s),await async function(a,c){const u=U(a);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>E.forEach(c,h=>E.forEach(h.Fi,f=>u.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>E.forEach(h.Bi,f=>u.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!Vs(d))throw d;P("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const h=d.targetId;if(!d.fromCache){const f=u.Ji.get(h),m=f.snapshotVersion,y=f.withLastLimboFreeSnapshotVersion(m);u.Ji=u.Ji.insert(h,y)}}}(r.localStore,i))}async function i6(t,e){const n=U(t);if(!n.currentUser.isEqual(e)){P("SyncEngine","User change. New user:",e.toKey());const r=await RE(n.localStore,e);n.currentUser=e,function(s,i){s.Ec.forEach(o=>{o.forEach(a=>{a.reject(new D(k.CANCELLED,i))})}),s.Ec.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Br(n,r.er)}}function o6(t,e){const n=U(t),r=n.yc.get(e);if(r&&r.fc)return ne().add(r.key);{let s=ne();const i=n._c.get(e);if(!i)return s;for(const o of i){const a=n.wc.get(o);s=s.unionWith(a.view.nc)}return s}}async function a6(t,e){const n=U(t),r=await Kd(n.localStore,e.query,!0),s=e.view.hc(r);return n.isPrimaryClient&&vg(n,e.targetId,s.cc),s}async function l6(t,e){const n=U(t);return LE(n.localStore,e).then(r=>Br(n,r))}async function c6(t,e,n,r){const s=U(t),i=await function(o,a){const c=U(o),u=U(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>u.Sn(d,a).next(h=>h?c.localDocuments.getDocuments(d,h):E.resolve(null)))}(s.localStore,e);i!==null?(n==="pending"?await pa(s.remoteStore):n==="acknowledged"||n==="rejected"?(Jy(s,e,r||null),Xy(s,e),function(o,a){U(U(o).mutationQueue).Cn(a)}(s.localStore,e)):q(),await Br(s,i)):P("SyncEngine","Cannot apply mutation batch with id: "+e)}async function u6(t,e){const n=U(t);if(ev(n),tv(n),e===!0&&n.vc!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),s=await kw(n,r.toArray());n.vc=!0,await yg(n.remoteStore,!0);for(const i of s)Xh(n.remoteStore,i)}else if(e===!1&&n.vc!==!1){const r=[];let s=Promise.resolve();n._c.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):s=s.then(()=>(Yo(n,o),Ko(n.localStore,o,!0))),sc(n.remoteStore,o)}),await s,await kw(n,r),function(i){const o=U(i);o.yc.forEach((a,c)=>{sc(o.remoteStore,c)}),o.Ic.Ts(),o.yc=new Map,o.gc=new Ee(F.comparator)}(n),n.vc=!1,await yg(n.remoteStore,!1)}}async function kw(t,e,n){const r=U(t),s=[],i=[];for(const o of e){let a;const c=r._c.get(o);if(c&&c.length!==0){a=await Go(r.localStore,on(c[0]));for(const u of c){const d=r.wc.get(u),h=await a6(r,d);h.snapshot&&i.push(h.snapshot)}}else{const u=await $E(r.localStore,o);a=await Go(r.localStore,u),await Yy(r,ZE(u),o,!1,a.resumeToken)}s.push(a)}return r.dc.nu(i),s}function ZE(t){return zN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function d6(t){const e=U(t);return U(U(e.localStore).persistence).$i()}async function h6(t,e,n,r){const s=U(t);if(s.vc)return void P("SyncEngine","Ignoring unexpected query state notification.");const i=s._c.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await LE(s.localStore,qN(i[0])),a=Ac.createSynthesizedRemoteEventForCurrentChange(e,n==="current",ot.EMPTY_BYTE_STRING);await Br(s,o,a);break}case"rejected":await Ko(s.localStore,e,!0),Yo(s,e,r);break;default:q()}}async function f6(t,e,n){const r=ev(t);if(r.vc){for(const s of e){if(r._c.has(s)){P("SyncEngine","Adding an already active target "+s);continue}const i=await $E(r.localStore,s),o=await Go(r.localStore,i);await Yy(r,ZE(i),o.targetId,!1,o.resumeToken),Xh(r.remoteStore,o)}for(const s of n)r._c.has(s)&&await Ko(r.localStore,s,!1).then(()=>{sc(r.remoteStore,s),Yo(r,s)}).catch(Fs)}}function ev(t){const e=U(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=XE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=o6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=e6.bind(null,e),e.dc.nu=qO.bind(null,e.eventManager),e.dc.Pc=WO.bind(null,e.eventManager),e}function tv(t){const e=U(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=t6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=n6.bind(null,e),e}function p6(t,e,n){const r=U(t);(async function(s,i,o){try{const a=await i.getMetadata();if(await function(h,f){const m=U(h),y=Xe(f.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",x=>m.qs.getBundleMetadata(x,f.id)).then(x=>!!x&&x.createTime.compareTo(y)>=0)}(s.localStore,a))return await i.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(GE(a));const c=new GO(a,s.localStore,i.serializer);let u=await i.bc();for(;u;){const h=await c.zu(u);h&&o._updateProgress(h),u=await i.bc()}const d=await c.complete();return await Br(s,d.Ju,void 0),await function(h,f){const m=U(h);return m.persistence.runTransaction("Save bundle","readwrite",y=>m.qs.saveBundleMetadata(y,f))}(s.localStore,a),o._completeWith(d.progress),Promise.resolve(d.Hu)}catch(a){return Vn("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(r,e,n).then(s=>{r.sharedClientState.notifyBundleLoaded(s)})}class xg{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Pc(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return AE(this.persistence,new DE,e.initialUser,this.serializer)}createPersistence(e){return new jE(Yh.zs,this.serializer)}createSharedClientState(e){return new FE}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class ek extends xg{constructor(e,n,r){super(),this.Vc=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Vc.initialize(this,e),await tv(this.Vc.syncEngine),await pa(this.Vc.remoteStore),await this.persistence.Ii(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return AE(this.persistence,new DE,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new rO(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){const r=new VP(n,this.persistence);return new FP(e.asyncQueue,r)}createPersistence(e){const n=My(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Yt.withCacheSize(this.cacheSizeBytes):Yt.DEFAULT;return new Ly(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,VE(),Zu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new FE}}class m6 extends ek{constructor(e,n){super(e,n,!1),this.Vc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Vc.syncEngine;this.sharedClientState instanceof Pp&&(this.sharedClientState.syncEngine={jr:c6.bind(null,n),zr:h6.bind(null,n),Wr:f6.bind(null,n),$i:d6.bind(null,n),Qr:l6.bind(null,n)},await this.sharedClientState.start()),await this.persistence.Ii(async r=>{await u6(this.Vc.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const n=VE();if(!Pp.D(n))throw new D(k.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=My(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Pp(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class nv{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ew(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=i6.bind(null,this.syncEngine),await yg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new BO}createDatastore(e){const n=Pc(e.databaseInfo.databaseId),r=(s=e.databaseInfo,new SO(s));var s;return function(i,o,a,c){return new jO(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return n=this.localStore,r=this.datastore,s=e.asyncQueue,i=a=>Ew(this.syncEngine,a,0),o=bw.D()?new bw:new NO,new AO(n,r,s,i,o);var n,r,s,i,o}createSyncEngine(e,n){return function(r,s,i,o,a,c,u){const d=new YO(r,s,i,o,a,c);return u&&(d.vc=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=U(e);P("RemoteStore","RemoteStore shutting down."),n.vu.add(5),await fa(n),n.Pu.shutdown(),n.bu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):Qe("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,n){this.Cc=e,this.serializer=n,this.metadata=new ht,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(r=>{r&&r.Qu()?this.metadata.resolve(r.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.Gu)}`))},r=>this.metadata.reject(r))}close(){return this.Cc.cancel()}async getMetadata(){return this.metadata.promise}async bc(){return await this.getMetadata(),this.Nc()}async Nc(){const e=await this.kc();if(e===null)return null;const n=this.xc.decode(e),r=Number(n);isNaN(r)&&this.Mc(`length string (${n}) is not valid number`);const s=await this.$c(r);return new HO(JSON.parse(s),e.length+r)}Oc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async kc(){for(;this.Oc()<0&&!await this.Fc(););if(this.buffer.length===0)return null;const e=this.Oc();e<0&&this.Mc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async $c(e){for(;this.buffer.length<e;)await this.Fc()&&this.Mc("Reached the end of bundle when more is expected.");const n=this.xc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}async Fc(){const e=await this.Cc.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new D(k.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(r,s){const i=U(r),o=nc(i.serializer)+"/documents",a={documents:s.map(h=>tc(i.serializer,h))},c=await i.vo("BatchGetDocuments",o,a,s.length),u=new Map;c.forEach(h=>{const f=L5(i.serializer,h);u.set(f.key.toString(),f)});const d=[];return s.forEach(h=>{const f=u.get(h.toString());K(!!f),d.push(f)}),d}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ha(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const s=F.fromPath(r);this.mutations.push(new ky(s,this.precondition(s)))}),await async function(n,r){const s=U(n),i=nc(s.serializer)+"/documents",o={writes:r.map(a=>rc(s.serializer,a))};await s.Io("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw q();n=G.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new D(k.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(G.min())?Oe.exists(!1):Oe.updateTime(n):Oe.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(G.min()))throw new D(k.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Oe.updateTime(n)}return Oe.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{constructor(e,n,r,s,i){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=s,this.deferred=i,this.Bc=r.maxAttempts,this.qo=new Uy(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){this.qo.No(async()=>{const e=new y6(this.datastore),n=this.qc(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(s=>{this.Uc(s)}))}).catch(r=>{this.Uc(r)})})}qc(e){try{const n=this.updateFunction(e);return!Sc(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!sE(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e,n,r,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=ut.UNAUTHENTICATED,this.clientId=xN.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{P("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(P("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new D(k.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ht;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ga(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ed(t,e){t.asyncQueue.verifyOperationInProgress(),P("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await RE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function wg(t,e){t.asyncQueue.verifyOperationInProgress();const n=await rv(t);P("FirestoreClient","Initializing OnlineComponentProvider");const r=await t.getConfiguration();await e.initialize(n,r),t.setCredentialChangeListener(s=>_w(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,i)=>_w(e.remoteStore,i)),t._onlineComponents=e}function tk(t){return t.name==="FirebaseError"?t.code===k.FAILED_PRECONDITION||t.code===k.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}async function rv(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){P("FirestoreClient","Using user provided OfflineComponentProvider");try{await ed(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!tk(n))throw n;Vn("Error using user provided cache. Falling back to memory cache: "+n),await ed(t,new xg)}}else P("FirestoreClient","Using default OfflineComponentProvider"),await ed(t,new xg);return t._offlineComponents}async function Zh(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(P("FirestoreClient","Using user provided OnlineComponentProvider"),await wg(t,t._uninitializedComponentsProvider._online)):(P("FirestoreClient","Using default OnlineComponentProvider"),await wg(t,new nv))),t._onlineComponents}function nk(t){return rv(t).then(e=>e.persistence)}function sv(t){return rv(t).then(e=>e.localStore)}function rk(t){return Zh(t).then(e=>e.remoteStore)}function iv(t){return Zh(t).then(e=>e.syncEngine)}function w6(t){return Zh(t).then(e=>e.datastore)}async function Xo(t){const e=await Zh(t),n=e.eventManager;return n.onListen=XO.bind(null,e.syncEngine),n.onUnlisten=JO.bind(null,e.syncEngine),n}function b6(t){return t.asyncQueue.enqueue(async()=>{const e=await nk(t),n=await rk(t);return e.setNetworkEnabled(!0),function(r){const s=U(r);return s.vu.delete(0),Oc(s)}(n)})}function _6(t){return t.asyncQueue.enqueue(async()=>{const e=await nk(t),n=await rk(t);return e.setNetworkEnabled(!1),async function(r){const s=U(r);s.vu.add(0),await fa(s),s.bu.set("Offline")}(n)})}function I6(t,e){const n=new ht;return t.asyncQueue.enqueueAndForget(async()=>async function(r,s,i){try{const o=await function(a,c){const u=U(a);return u.persistence.runTransaction("read document","readonly",d=>u.localDocuments.getDocument(d,c))}(r,s);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new D(k.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=ga(o,`Failed to get document '${s} from cache`);i.reject(a)}}(await sv(t),e,n)),n.promise}function sk(t,e,n={}){const r=new ht;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const u=new Jh({next:h=>{i.enqueueAndForget(()=>Gy(s,d));const f=h.docs.has(o);!f&&h.fromCache?c.reject(new D(k.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&a&&a.source==="server"?c.reject(new D(k.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new Qy(ua(o.path),u,{includeMetadataChanges:!0,Ku:!0});return Hy(s,d)}(await Xo(t),t.asyncQueue,e,n,r)),r.promise}function N6(t,e){const n=new ht;return t.asyncQueue.enqueueAndForget(async()=>async function(r,s,i){try{const o=await Kd(r,s,!0),a=new YE(s,o.ir),c=a.sc(o.documents),u=a.applyChanges(c,!1);i.resolve(u.snapshot)}catch(o){const a=ga(o,`Failed to execute query '${s} against cache`);i.reject(a)}}(await sv(t),e,n)),n.promise}function ik(t,e,n={}){const r=new ht;return t.asyncQueue.enqueueAndForget(async()=>function(s,i,o,a,c){const u=new Jh({next:h=>{i.enqueueAndForget(()=>Gy(s,d)),h.fromCache&&a.source==="server"?c.reject(new D(k.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new Qy(o,u,{includeMetadataChanges:!0,Ku:!0});return Hy(s,d)}(await Xo(t),t.asyncQueue,e,n,r)),r.promise}function E6(t,e){const n=new Jh(e);return t.asyncQueue.enqueueAndForget(async()=>function(r,s){U(r).ku.add(s),s.next()}(await Xo(t),n)),()=>{n.Dc(),t.asyncQueue.enqueueAndForget(async()=>function(r,s){U(r).ku.delete(s)}(await Xo(t),n))}}function k6(t,e,n,r){const s=function(i,o){let a;return a=typeof i=="string"?oE().encode(i):i,function(c,u){return new g6(c,u)}(function(c,u){if(c instanceof Uint8Array)return Sw(c,u);if(c instanceof ArrayBuffer)return Sw(new Uint8Array(c),u);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,Pc(e));t.asyncQueue.enqueueAndForget(async()=>{p6(await iv(t),s,r)})}function S6(t,e){return t.asyncQueue.enqueue(async()=>function(n,r){const s=U(n);return s.persistence.runTransaction("Get named query","readonly",i=>s.qs.getNamedQuery(i,r))}(await sv(t),e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tw=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ov(t,e,n){if(!n)throw new D(k.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function ak(t,e,n,r){if(e===!0&&r===!0)throw new D(k.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Cw(t){if(!F.isDocumentKey(t))throw new D(k.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function jw(t){if(F.isDocumentKey(t))throw new D(k.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ef(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":q()}function de(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new D(k.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ef(t);throw new D(k.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function lk(t,e){if(e<=0)throw new D(k.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dw{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new D(k.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new D(k.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ak("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ok((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new D(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new D(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new D(k.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(n=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,n.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var n,r}}class $c{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Dw({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new D(k.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new D(k.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Dw(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new SP;switch(n.type){case"firstParty":return new DP(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new D(k.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=Tw.get(e);n&&(P("ComponentProvider","Removing Datastore"),Tw.delete(e),n.terminate())}(this),Promise.resolve()}}function T6(t,e,n,r={}){var s;const i=(t=de(t,$c))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Vn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=ut.MOCK_USER;else{a=QC(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new D(k.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new ut(u)}t._authCredentials=new TP(new vN(a,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ae{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ae(this.firestore,e,this._key)}}class jt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new jt(this.firestore,e,this._query)}}class cr extends jt{constructor(e,n,r){super(e,n,ua(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ae(this.firestore,null,new F(e))}withConverter(e){return new cr(this.firestore,e,this._path)}}function ck(t,e,...n){if(t=Y(t),ov("collection","path",e),t instanceof $c){const r=ce.fromString(e,...n);return jw(r),new cr(t,null,r)}{if(!(t instanceof Ae||t instanceof cr))throw new D(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ce.fromString(e,...n));return jw(r),new cr(t.firestore,null,r)}}function C6(t,e){if(t=de(t,$c),ov("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new D(k.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new jt(t,null,function(n){return new Ur(ce.emptyPath(),n)}(e))}function Jd(t,e,...n){if(t=Y(t),arguments.length===1&&(e=xN.A()),ov("doc","path",e),t instanceof $c){const r=ce.fromString(e,...n);return Cw(r),new Ae(t,null,new F(r))}{if(!(t instanceof Ae||t instanceof cr))throw new D(k.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ce.fromString(e,...n));return Cw(r),new Ae(t.firestore,t instanceof cr?t.converter:null,new F(r))}}function uk(t,e){return t=Y(t),e=Y(e),(t instanceof Ae||t instanceof cr)&&(e instanceof Ae||e instanceof cr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function dk(t,e){return t=Y(t),e=Y(e),t instanceof jt&&e instanceof jt&&t.firestore===e.firestore&&Cc(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Uy(this,"async_queue_retry"),this.Xc=()=>{const n=Zu();n&&P("AsyncQueue","Visibility state changed to "+n.visibilityState),this.qo.Mo()};const e=Zu();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;const n=Zu();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});const n=new ht;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!Vs(e))throw e;P("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){const n=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{this.Wc=r,this.Hc=!1;const s=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(r);throw Qe("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.Hc=!1,r))));return this.Gc=n,n}enqueueAfterDelay(e,n,r){this.Zc(),this.Yc.indexOf(e)>-1&&(n=0);const s=Wy.createAndSchedule(this,e,n,r,i=>this.na(i));return this.zc.push(s),s}Zc(){this.Wc&&q()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(const n of this.zc)if(n.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.zc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){const n=this.zc.indexOf(e);this.zc.splice(n,1)}}function bg(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const r=e;for(const s of n)if(s in r&&typeof r[s]=="function")return!0;return!1}(t,["next","error","complete"])}class D6{constructor(){this._progressObserver={},this._taskCompletionResolver=new ht,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A6=-1;class Ge extends $c{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new j6,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||hk(this),this._firestoreClient.terminate()}}function gt(t){return t._firestoreClient||hk(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function hk(t){var e,n,r;const s=t._freezeSettings(),i=function(o,a,c,u){return new a5(o,a,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,ok(u.experimentalLongPollingOptions),u.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._firestoreClient=new x6(t._authCredentials,t._appCheckCredentials,t._queue,i),!((n=s.cache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.cache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.cache.kind,_offline:s.cache._offlineComponentProvider,_online:s.cache._onlineComponentProvider})}function R6(t,e){pk(t=de(t,Ge));const n=gt(t);if(n._uninitializedComponentsProvider)throw new D(k.FAILED_PRECONDITION,"SDK cache is already specified.");Vn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=t._freezeSettings(),s=new nv;return fk(n,s,new ek(s,r.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function P6(t){pk(t=de(t,Ge));const e=gt(t);if(e._uninitializedComponentsProvider)throw new D(k.FAILED_PRECONDITION,"SDK cache is already specified.");Vn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings(),r=new nv;return fk(e,r,new m6(r,n.cacheSizeBytes))}function fk(t,e,n){const r=new ht;return t.asyncQueue.enqueue(async()=>{try{await ed(t,n),await wg(t,e),r.resolve()}catch(s){const i=s;if(!tk(i))throw i;Vn("Error enabling indexeddb cache. Falling back to memory cache: "+i),r.reject(i)}}).then(()=>r.promise)}function O6(t){if(t._initialized&&!t._terminated)throw new D(k.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new ht;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!Pn.D())return Promise.resolve();const r=n+"main";await Pn.delete(r)}(My(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function $6(t){return function(e){const n=new ht;return e.asyncQueue.enqueueAndForget(async()=>r6(await iv(e),n)),n.promise}(gt(t=de(t,Ge)))}function L6(t){return b6(gt(t=de(t,Ge)))}function M6(t){return _6(gt(t=de(t,Ge)))}function F6(t,e){const n=gt(t=de(t,Ge)),r=new D6;return k6(n,t._databaseId,e,r),r}function V6(t,e){return S6(gt(t=de(t,Ge)),e).then(n=>n?new jt(t,null,n.query):null)}function pk(t){if(t._initialized||t._terminated)throw new D(k.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new fr(ot.fromBase64String(e))}catch(n){throw new D(k.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new fr(ot.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class js{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new D(k.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ye(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new D(k.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new D(k.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U6=/^__.*__$/;class z6{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new zr(e,this.data,this.fieldMask,n,this.fieldTransforms):new da(e,this.data,n,this.fieldTransforms)}}class mk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new zr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function gk(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw q()}}class nf{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.ua(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new nf(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.aa({path:r,la:!1});return s.fa(e),s}da(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.aa({path:r,la:!1});return s.ua(),s}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return Zd(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(gk(this.ca)&&U6.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class B6{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Pc(e)}ya(e,n,r,s=!1){return new nf({ca:e,methodName:n,ga:r,path:Ye.emptyPath(),la:!1,ma:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Bi(t){const e=t._freezeSettings(),n=Pc(t._databaseId);return new B6(t._databaseId,!!e.ignoreUndefinedProperties,n)}function rf(t,e,n,r,s,i={}){const o=t.ya(i.merge||i.mergeFields?2:0,e,n,s);uv("Data must be an object, but it was:",o,r);const a=xk(r,o);let c,u;if(i.merge)c=new en(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=_g(e,h,n);if(!o.contains(f))throw new D(k.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);bk(d,f)||d.push(f)}c=new en(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new z6(new Nt(a),c,u)}class Lc extends zi{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Lc}}function yk(t,e,n){return new nf({ca:3,ga:e.settings.ga,methodName:t._methodName,la:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class av extends zi{_toFieldTransform(e){return new Dc(e.path,new qo)}isEqual(e){return e instanceof av}}class q6 extends zi{constructor(e,n){super(e),this.pa=n}_toFieldTransform(e){const n=yk(this,e,!0),r=this.pa.map(i=>qi(i,n)),s=new ji(r);return new Dc(e.path,s)}isEqual(e){return this===e}}class W6 extends zi{constructor(e,n){super(e),this.pa=n}_toFieldTransform(e){const n=yk(this,e,!0),r=this.pa.map(i=>qi(i,n)),s=new Di(r);return new Dc(e.path,s)}isEqual(e){return this===e}}class H6 extends zi{constructor(e,n){super(e),this.Ia=n}_toFieldTransform(e){const n=new Wo(e.serializer,XN(e.serializer,this.Ia));return new Dc(e.path,n)}isEqual(e){return this===e}}function lv(t,e,n,r){const s=t.ya(1,e,n);uv("Data must be an object, but it was:",s,r);const i=[],o=Nt.empty();Ui(r,(c,u)=>{const d=dv(e,c,n);u=Y(u);const h=s.da(d);if(u instanceof Lc)i.push(d);else{const f=qi(u,h);f!=null&&(i.push(d),o.set(d,f))}});const a=new en(i);return new mk(o,a,s.fieldTransforms)}function cv(t,e,n,r,s,i){const o=t.ya(1,e,n),a=[_g(e,r,n)],c=[s];if(i.length%2!=0)throw new D(k.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(_g(e,i[f])),c.push(i[f+1]);const u=[],d=Nt.empty();for(let f=a.length-1;f>=0;--f)if(!bk(u,a[f])){const m=a[f];let y=c[f];y=Y(y);const x=o.da(m);if(y instanceof Lc)u.push(m);else{const w=qi(y,x);w!=null&&(u.push(m),d.set(m,w))}}const h=new en(u);return new mk(d,h,o.fieldTransforms)}function vk(t,e,n,r=!1){return qi(n,t.ya(r?4:3,e))}function qi(t,e){if(wk(t=Y(t)))return uv("Unsupported field value:",e,t),xk(t,e);if(t instanceof zi)return function(n,r){if(!gk(r.ca))throw r._a(`${n._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(n,r){const s=[];let i=0;for(const o of n){let a=qi(o,r.wa(i));a==null&&(a={nullValue:"NULL_VALUE"}),s.push(a),i++}return{arrayValue:{values:s}}}(t,e)}return function(n,r){if((n=Y(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return XN(r.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=$e.fromDate(n);return{timestampValue:Ho(r.serializer,s)}}if(n instanceof $e){const s=new $e(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Ho(r.serializer,s)}}if(n instanceof tf)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof fr)return{bytesValue:cE(r.serializer,n._byteString)};if(n instanceof Ae){const s=r.databaseId,i=n.firestore._databaseId;if(!i.isEqual(s))throw r._a(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ay(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r._a(`Unsupported field value: ${ef(n)}`)}(t,e)}function xk(t,e){const n={};return DN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ui(t,(r,s)=>{const i=qi(s,e.ha(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function wk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof tf||t instanceof fr||t instanceof Ae||t instanceof zi)}function uv(t,e,n){if(!wk(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const r=ef(n);throw r==="an object"?e._a(t+" a custom object"):e._a(t+" "+r)}}function _g(t,e,n){if((e=Y(e))instanceof js)return e._internalPath;if(typeof e=="string")return dv(t,e);throw Zd("Field path arguments must be of type string or ",t,!1,void 0,n)}const G6=new RegExp("[~\\*/\\[\\]]");function dv(t,e,n){if(e.search(G6)>=0)throw Zd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new js(...e.split("."))._internalPath}catch{throw Zd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Zd(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new D(k.INVALID_ARGUMENT,a+t+c)}function bk(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ic{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ae(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new K6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(sf("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class K6 extends ic{data(){return super.data()}}function sf(t,e){return typeof e=="string"?dv(t,e):e instanceof js?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new D(k.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class hv{}class Mc extends hv{}function Yr(t,e,...n){let r=[];e instanceof hv&&r.push(e),r=r.concat(n),function(s){const i=s.filter(a=>a instanceof fv).length,o=s.filter(a=>a instanceof of).length;if(i>1||i>0&&o>0)throw new D(k.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class of extends Mc{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new of(e,n,r)}_apply(e){const n=this._parse(e);return Nk(e._query,n),new jt(e.firestore,e.converter,lg(e._query,n))}_parse(e){const n=Bi(e.firestore);return function(s,i,o,a,c,u,d){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new D(k.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Rw(d,u);const f=[];for(const m of d)f.push(Aw(a,s,m));h={arrayValue:{values:f}}}else h=Aw(a,s,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Rw(d,u),h=vk(o,i,d,u==="in"||u==="not-in");return ie.create(c,u,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Q6(t,e,n){const r=e,s=sf("where",t);return of._create(s,r,n)}class fv extends hv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new fv(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ye.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,s){let i=r;const o=s.getFlattenedFilters();for(const a of o)Nk(i,a),i=lg(i,a)}(e._query,n),new jt(e.firestore,e.converter,lg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class pv extends Mc{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new pv(e,n)}_apply(e){const n=function(r,s,i){if(r.startAt!==null)throw new D(k.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new D(k.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Co(s,i);return function(a,c){if(Iy(a)===null){const u=Wh(a);u!==null&&Ek(a,u,c.field)}}(r,o),o}(e._query,this._field,this._direction);return new jt(e.firestore,e.converter,function(r,s){const i=r.explicitOrderBy.concat([s]);return new Ur(r.path,r.collectionGroup,i,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function Y6(t,e="asc"){const n=e,r=sf("orderBy",t);return pv._create(r,n)}class af extends Mc{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new af(e,n,r)}_apply(e){return new jt(e.firestore,e.converter,qd(e._query,this._limit,this._limitType))}}function X6(t){return lk("limit",t),af._create("limit",t,"F")}function J6(t){return lk("limitToLast",t),af._create("limitToLast",t,"L")}class lf extends Mc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new lf(e,n,r)}_apply(e){const n=Ik(e,this.type,this._docOrFields,this._inclusive);return new jt(e.firestore,e.converter,function(r,s){return new Ur(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(e._query,n))}}function Z6(...t){return lf._create("startAt",t,!0)}function e$(...t){return lf._create("startAfter",t,!1)}class cf extends Mc{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new cf(e,n,r)}_apply(e){const n=Ik(e,this.type,this._docOrFields,this._inclusive);return new jt(e.firestore,e.converter,function(r,s){return new Ur(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(e._query,n))}}function t$(...t){return cf._create("endBefore",t,!1)}function n$(...t){return cf._create("endAt",t,!0)}function Ik(t,e,n,r){if(n[0]=Y(n[0]),n[0]instanceof ic)return function(s,i,o,a,c){if(!a)throw new D(k.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const u=[];for(const d of yi(s))if(d.field.isKeyField())u.push(Ti(i,a.key));else{const h=a.data.field(d.field);if(qh(h))throw new D(k.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const f=d.field.canonicalString();throw new D(k.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}u.push(h)}return new Ts(u,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const s=Bi(t.firestore);return function(i,o,a,c,u,d){const h=i.explicitOrderBy;if(u.length>h.length)throw new D(k.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const f=[];for(let m=0;m<u.length;m++){const y=u[m];if(h[m].field.isKeyField()){if(typeof y!="string")throw new D(k.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof y}`);if(!Ny(i)&&y.indexOf("/")!==-1)throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${y}' contains a slash.`);const x=i.path.child(ce.fromString(y));if(!F.isDocumentKey(x))throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${x}' is not because it contains an odd number of segments.`);const w=new F(x);f.push(Ti(o,w))}else{const x=vk(a,c,y);f.push(x)}}return new Ts(f,d)}(t._query,t.firestore._databaseId,s,e,n,r)}}function Aw(t,e,n){if(typeof(n=Y(n))=="string"){if(n==="")throw new D(k.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ny(e)&&n.indexOf("/")!==-1)throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ce.fromString(n));if(!F.isDocumentKey(r))throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ti(t,new F(r))}if(n instanceof Ae)return Ti(t,n._key);throw new D(k.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ef(n)}.`)}function Rw(t,e){if(!Array.isArray(t)||t.length===0)throw new D(k.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Nk(t,e){if(e.isInequality()){const r=Wh(t),s=e.field;if(r!==null&&!r.isEqual(s))throw new D(k.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${s.toString()}'`);const i=Iy(t);i!==null&&Ek(t,s,i)}const n=function(r,s){for(const i of r)for(const o of i.getFlattenedFilters())if(s.indexOf(o.op)>=0)return o.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new D(k.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(k.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function Ek(t,e,n){if(!n.isEqual(e))throw new D(k.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class mv{convertValue(e,n="none"){switch(Si(e)){case 0:return null;case 1:return e.booleanValue;case 2:return We(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Es(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw q()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ui(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertGeoPoint(e){return new tf(We(e.latitude),We(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=by(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Jl(e));default:return null}}convertTimestamp(e){const n=Ns(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ce.fromString(e);K(xE(r));const s=new ks(r.get(1),r.get(3)),i=new F(r.popFirst(5));return s.isEqual(n)||Qe(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uf(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class r$ extends mv{constructor(e){super(),this.firestore=e}convertBytes(e){return new fr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $r extends ic{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new gl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(sf("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class gl extends $r{data(e={}){return super.data(e)}}class Ds{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new ci(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new gl(this._firestore,this._userDataWriter,r.key,r,new ci(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new D(k.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let i=0;return r._snapshot.docChanges.map(o=>{const a=new gl(r._firestore,r._userDataWriter,o.doc.key,o.doc,new ci(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:i++}})}{let i=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>s||o.type!==3).map(o=>{const a=new gl(r._firestore,r._userDataWriter,o.doc.key,o.doc,new ci(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);let c=-1,u=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),u=i.indexOf(o.doc.key)),{type:s$(o.type),doc:a,oldIndex:c,newIndex:u}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function s$(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return q()}}function kk(t,e){return t instanceof $r&&e instanceof $r?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ds&&e instanceof Ds&&t._firestore===e._firestore&&dk(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i$(t){t=de(t,Ae);const e=de(t.firestore,Ge);return sk(gt(e),t._key).then(n=>gv(e,t,n))}class Wi extends mv{constructor(e){super(),this.firestore=e}convertBytes(e){return new fr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ae(this.firestore,null,n)}}function o$(t){t=de(t,Ae);const e=de(t.firestore,Ge),n=gt(e),r=new Wi(e);return I6(n,t._key).then(s=>new $r(e,r,t._key,s,new ci(s!==null&&s.hasLocalMutations,!0),t.converter))}function a$(t){t=de(t,Ae);const e=de(t.firestore,Ge);return sk(gt(e),t._key,{source:"server"}).then(n=>gv(e,t,n))}function l$(t){t=de(t,jt);const e=de(t.firestore,Ge),n=gt(e),r=new Wi(e);return _k(t._query),ik(n,t._query).then(s=>new Ds(e,r,t,s))}function c$(t){t=de(t,jt);const e=de(t.firestore,Ge),n=gt(e),r=new Wi(e);return N6(n,t._query).then(s=>new Ds(e,r,t,s))}function u$(t){t=de(t,jt);const e=de(t.firestore,Ge),n=gt(e),r=new Wi(e);return ik(n,t._query,{source:"server"}).then(s=>new Ds(e,r,t,s))}function Pw(t,e,n){t=de(t,Ae);const r=de(t.firestore,Ge),s=uf(t.converter,e,n);return Fc(r,[rf(Bi(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Oe.none())])}function Ow(t,e,n,...r){t=de(t,Ae);const s=de(t.firestore,Ge),i=Bi(s);let o;return o=typeof(e=Y(e))=="string"||e instanceof js?cv(i,"updateDoc",t._key,e,n,r):lv(i,"updateDoc",t._key,e),Fc(s,[o.toMutation(t._key,Oe.exists(!0))])}function d$(t){return Fc(de(t.firestore,Ge),[new ha(t._key,Oe.none())])}function h$(t,e){const n=de(t.firestore,Ge),r=Jd(t),s=uf(t.converter,e);return Fc(n,[rf(Bi(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Oe.exists(!1))]).then(()=>r)}function Sk(t,...e){var n,r,s;t=Y(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||bg(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(bg(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof Ae)u=de(t.firestore,Ge),d=ua(t._key.path),c={next:h=>{e[o]&&e[o](gv(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=de(t,jt);u=de(h.firestore,Ge),d=h._query;const f=new Wi(u);c={next:m=>{e[o]&&e[o](new Ds(u,f,h,m))},error:e[o+1],complete:e[o+2]},_k(t._query)}return function(h,f,m,y){const x=new Jh(y),w=new Qy(f,x,m);return h.asyncQueue.enqueueAndForget(async()=>Hy(await Xo(h),w)),()=>{x.Dc(),h.asyncQueue.enqueueAndForget(async()=>Gy(await Xo(h),w))}}(gt(u),d,a,c)}function f$(t,e){return E6(gt(t=de(t,Ge)),bg(e)?e:{next:e})}function Fc(t,e){return function(n,r){const s=new ht;return n.asyncQueue.enqueueAndForget(async()=>ZO(await iv(n),r,s)),s.promise}(gt(t),e)}function gv(t,e,n){const r=n.docs.get(e._key),s=new Wi(t);return new $r(t,s,e._key,r,new ci(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p$={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m${constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Bi(e)}set(e,n,r){this._verifyNotCommitted();const s=ns(e,this._firestore),i=uf(s.converter,n,r),o=rf(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,Oe.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=ns(e,this._firestore);let o;return o=typeof(n=Y(n))=="string"||n instanceof js?cv(this._dataReader,"WriteBatch.update",i._key,n,r,s):lv(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,Oe.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=ns(e,this._firestore);return this._mutations=this._mutations.concat(new ha(n._key,Oe.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new D(k.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ns(t,e){if((t=Y(t)).firestore!==e)throw new D(k.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g$ extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=Bi(e)}get(e){const n=ns(e,this._firestore),r=new r$(this._firestore);return this._transaction.lookup([n._key]).then(s=>{if(!s||s.length!==1)return q();const i=s[0];if(i.isFoundDocument())return new ic(this._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new ic(this._firestore,r,n._key,null,n.converter);throw q()})}set(e,n,r){const s=ns(e,this._firestore),i=uf(s.converter,n,r),o=rf(this._dataReader,"Transaction.set",s._key,i,s.converter!==null,r);return this._transaction.set(s._key,o),this}update(e,n,r,...s){const i=ns(e,this._firestore);let o;return o=typeof(n=Y(n))=="string"||n instanceof js?cv(this._dataReader,"Transaction.update",i._key,n,r,s):lv(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=ns(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=ns(e,this._firestore),r=new Wi(this._firestore);return super.get(e).then(s=>new $r(this._firestore,r,n._key,s._document,new ci(!1,!1),n.converter))}}function y$(t,e,n){t=de(t,Ge);const r=Object.assign(Object.assign({},p$),n);return function(s){if(s.maxAttempts<1)throw new D(k.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,i,o){const a=new ht;return s.asyncQueue.enqueueAndForget(async()=>{const c=await w6(s);new v6(s.asyncQueue,c,o,i,a).run()}),a.promise}(gt(t),s=>e(new g$(t,s)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v$(){return new Lc("deleteField")}function x$(){return new av("serverTimestamp")}function w$(...t){return new q6("arrayUnion",t)}function b$(...t){return new W6("arrayRemove",t)}function _$(t){return new H6("increment",t)}(function(t,e=!0){(function(n){ca=n})(Os),bs(new ur("firestore",(n,{instanceIdentifier:r,options:s})=>{const i=n.getProvider("app").getImmediate(),o=new Ge(new CP(n.getProvider("auth-internal")),new RP(n.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new D(k.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ks(a.options.projectId,c)}(i,r),i);return s=Object.assign({useFetchStreams:e},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),ar(jx,"3.13.0",t),ar(jx,"3.13.0","esm2017")})();const I$="@firebase/firestore-compat",N$="0.3.12";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new D("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(){if(typeof Uint8Array>"u")throw new D("unimplemented","Uint8Arrays are not available in this environment.")}function Lw(){if(!i5())throw new D("unimplemented","Blobs are unavailable in Firestore in this environment.")}let Tk=class Ig{constructor(e){this._delegate=e}static fromBase64String(e){return Lw(),new Ig(fr.fromBase64String(e))}static fromUint8Array(e){return $w(),new Ig(fr.fromUint8Array(e))}toBase64(){return Lw(),this._delegate.toBase64()}toUint8Array(){return $w(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ng(t){return E$(t,["next","error","complete"])}function E$(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k${enableIndexedDbPersistence(e,n){return R6(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return P6(e._delegate)}clearIndexedDbPersistence(e){return O6(e._delegate)}}class Ck{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof ks||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Vn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){T6(this._delegate,e,n,r)}enableNetwork(){return L6(this._delegate)}disableNetwork(){return M6(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,ak("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return $6(this._delegate)}onSnapshotsInSync(e){return f$(this._delegate,e)}get app(){if(!this._appCompat)throw new D("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Jo(this,ck(this._delegate,e))}catch(n){throw zt(n,"collection()","Firestore.collection()")}}doc(e){try{return new In(this,Jd(this._delegate,e))}catch(n){throw zt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ut(this,C6(this._delegate,e))}catch(n){throw zt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return y$(this._delegate,n=>e(new jk(this,n)))}batch(){return gt(this._delegate),new Dk(new m$(this._delegate,e=>Fc(this._delegate,e)))}loadBundle(e){return F6(this._delegate,e)}namedQuery(e){return V6(this._delegate,e).then(n=>n?new Ut(this,n):null)}}class df extends mv{constructor(e){super(),this.firestore=e}convertBytes(e){return new Tk(new fr(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return In.forKey(n,this.firestore,null)}}function S$(t){EP(t)}class jk{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new df(e)}get(e){const n=ui(e);return this._delegate.get(n).then(r=>new oc(this._firestore,new $r(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){const s=ui(e);return r?(yv("Transaction.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=ui(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=ui(e);return this._delegate.delete(n),this}}class Dk{constructor(e){this._delegate=e}set(e,n,r){const s=ui(e);return r?(yv("WriteBatch.set",r),this._delegate.set(s,n,r)):this._delegate.set(s,n),this}update(e,n,r,...s){const i=ui(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,r,...s),this}delete(e){const n=ui(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Oi{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){const r=new gl(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new ac(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const r=Oi.INSTANCES;let s=r.get(e);s||(s=new WeakMap,r.set(e,s));let i=s.get(n);return i||(i=new Oi(e,new df(e),n),s.set(n,i)),i}}Oi.INSTANCES=new WeakMap;class In{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new df(e)}static forPath(e,n,r){if(e.length%2!==0)throw new D("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new In(n,new Ae(n._delegate,r,new F(e)))}static forKey(e,n,r){return new In(n,new Ae(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Jo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Jo(this.firestore,ck(this._delegate,e))}catch(n){throw zt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=Y(e),e instanceof Ae?uk(this._delegate,e):!1}set(e,n){n=yv("DocumentReference.set",n);try{return n?Pw(this._delegate,e,n):Pw(this._delegate,e)}catch(r){throw zt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?Ow(this._delegate,e):Ow(this._delegate,e,n,...r)}catch(s){throw zt(s,"updateDoc()","DocumentReference.update()")}}delete(){return d$(this._delegate)}onSnapshot(...e){const n=Ak(e),r=Rk(e,s=>new oc(this.firestore,new $r(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return Sk(this._delegate,n,r)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=o$(this._delegate):(e==null?void 0:e.source)==="server"?n=a$(this._delegate):n=i$(this._delegate),n.then(r=>new oc(this.firestore,new $r(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new In(this.firestore,e?this._delegate.withConverter(Oi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function zt(t,e,n){return t.message=t.message.replace(e,n),t}function Ak(t){for(const e of t)if(typeof e=="object"&&!Ng(e))return e;return{}}function Rk(t,e){var n,r;let s;return Ng(t[0])?s=t[0]:Ng(t[1])?s=t[1]:typeof t[0]=="function"?s={next:t[0],error:t[1],complete:t[2]}:s={next:t[1],error:t[2],complete:t[3]},{next:i=>{s.next&&s.next(e(i))},error:(n=s.error)===null||n===void 0?void 0:n.bind(s),complete:(r=s.complete)===null||r===void 0?void 0:r.bind(s)}}class oc{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new In(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return kk(this._delegate,e._delegate)}}class ac extends oc{data(e){const n=this._delegate.data(e);return kP(n!==void 0),n}}class Ut{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new df(e)}where(e,n,r){try{return new Ut(this.firestore,Yr(this._delegate,Q6(e,n,r)))}catch(s){throw zt(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new Ut(this.firestore,Yr(this._delegate,Y6(e,n)))}catch(r){throw zt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ut(this.firestore,Yr(this._delegate,X6(e)))}catch(n){throw zt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new Ut(this.firestore,Yr(this._delegate,J6(e)))}catch(n){throw zt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ut(this.firestore,Yr(this._delegate,Z6(...e)))}catch(n){throw zt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ut(this.firestore,Yr(this._delegate,e$(...e)))}catch(n){throw zt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ut(this.firestore,Yr(this._delegate,t$(...e)))}catch(n){throw zt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ut(this.firestore,Yr(this._delegate,n$(...e)))}catch(n){throw zt(n,"endAt()","Query.endAt()")}}isEqual(e){return dk(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=c$(this._delegate):(e==null?void 0:e.source)==="server"?n=u$(this._delegate):n=l$(this._delegate),n.then(r=>new Eg(this.firestore,new Ds(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const n=Ak(e),r=Rk(e,s=>new Eg(this.firestore,new Ds(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return Sk(this._delegate,n,r)}withConverter(e){return new Ut(this.firestore,e?this._delegate.withConverter(Oi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class T${constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new ac(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Eg{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Ut(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new ac(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new T$(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new ac(this._firestore,r))})}isEqual(e){return kk(this._delegate,e._delegate)}}class Jo extends Ut{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new In(this.firestore,e):null}doc(e){try{return e===void 0?new In(this.firestore,Jd(this._delegate)):new In(this.firestore,Jd(this._delegate,e))}catch(n){throw zt(n,"doc()","CollectionReference.doc()")}}add(e){return h$(this._delegate,e).then(n=>new In(this.firestore,n))}isEqual(e){return uk(this._delegate,e._delegate)}withConverter(e){return new Jo(this.firestore,e?this._delegate.withConverter(Oi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function ui(t){return de(t,Ae)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(...e){this._delegate=new js(...e)}static documentId(){return new vv(Ye.keyField().canonicalString())}isEqual(e){return e=Y(e),e instanceof js?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this._delegate=e}static serverTimestamp(){const e=x$();return e._methodName="FieldValue.serverTimestamp",new ni(e)}static delete(){const e=v$();return e._methodName="FieldValue.delete",new ni(e)}static arrayUnion(...e){const n=w$(...e);return n._methodName="FieldValue.arrayUnion",new ni(n)}static arrayRemove(...e){const n=b$(...e);return n._methodName="FieldValue.arrayRemove",new ni(n)}static increment(e){const n=_$(e);return n._methodName="FieldValue.increment",new ni(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$={Firestore:Ck,GeoPoint:tf,Timestamp:$e,Blob:Tk,Transaction:jk,WriteBatch:Dk,DocumentReference:In,DocumentSnapshot:oc,Query:Ut,QueryDocumentSnapshot:ac,QuerySnapshot:Eg,CollectionReference:Jo,FieldPath:vv,FieldValue:ni,setLogLevel:S$,CACHE_SIZE_UNLIMITED:A6};function j$(t,e){t.INTERNAL.registerComponent(new ur("firestore-compat",n=>{const r=n.getProvider("app-compat").getImmediate(),s=n.getProvider("firestore").getImmediate();return e(r,s)},"PUBLIC").setServiceProps(Object.assign({},C$)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D$(t){j$(t,(e,n)=>new Ck(e,n,new k$)),t.registerVersion(I$,N$)}D$(Ie);const A$={apiKey:"AIzaSyAOMubppe1JZbBh0VBv7UIbZyY2S1RI9fw",authDomain:"bible-sungseo.firebaseapp.com",projectId:"bible-sungseo",storageBucket:"bible-sungseo.firebasestorage.app",messagingSenderId:"1061949588108",appId:"1:1061949588108:web:e8e3bbd6c3f73afa5131a9"};let fe,Pt;try{Ie.apps.length?Ie.app():Ie.initializeApp(A$),Pt=Ie.auth(),fe=Ie.firestore()}catch(t){console.error("Firebase init failed:",t)}let eh=[];for(let t=1;t<=14;t++)eh.push(t+"");eh=eh.concat(["1","2","","","1","2","3","4","5",""]);const R$=[" "," "," "," "," "],P$=["",""],O$=["1","2","3","4","5","6"],$$=["","",""],Lr=[{id:"senior",name:"",color:"bg-orange-500",icon:"",subgroups:eh},{id:"youth",name:"",color:"bg-blue-500",icon:"",subgroups:R$},{id:"middlehigh",name:"",color:"bg-purple-500",icon:"",subgroups:P$},{id:"elementary",name:"",color:"bg-yellow-500",icon:"",subgroups:O$},{id:"kinder",name:"",color:"bg-pink-500",icon:"",subgroups:$$}],L$=[{date:"1-1",range:" 1-2"},{date:"1-2",range:" 3-5"},{date:"1-3",range:" 6-8"},{date:"1-4",range:" 9-11"},{date:"1-5",range:" 1-3"},{date:"1-6",range:" 4-6"},{date:"1-7",range:" 7-9"},{date:"1-8",range:" 10-12"},{date:"1-9",range:" 13-14"},{date:"1-10",range:" 15-16"},{date:"1-11",range:" 17-19"},{date:"1-12",range:" 20-21"},{date:"1-13",range:" 22-24"},{date:"1-14",range:" 25-26"},{date:"1-15",range:" 27-28"},{date:"1-16",range:" 29-30"},{date:"1-17",range:" 31-33"},{date:"1-18",range:" 34-35"},{date:"1-19",range:" 36-38"},{date:"1-20",range:" 39-40"},{date:"1-21",range:" 1-4"},{date:"1-22",range:" 5-7"},{date:"1-23",range:" 8-10"},{date:"1-24",range:" 11-14"},{date:"1-25",range:" 15-18"},{date:"1-26",range:" 19-21"},{date:"1-27",range:" 22-24"},{date:"1-28",range:" 1-3"},{date:"1-29",range:" 4-6"},{date:"1-30",range:" 7-8"},{date:"1-31",range:" 9-11"},{date:"2-1",range:" 12-15"},{date:"2-2",range:" 16-18"},{date:"2-3",range:" 19-21"},{date:"2-4",range:" 1-4"},{date:"2-5",range:" 1-3"},{date:"2-6",range:" 4-6"},{date:"2-7",range:" 7-9"},{date:"2-8",range:" 10-13"},{date:"2-9",range:" 14-17"},{date:"2-10",range:" 18-21"},{date:"2-11",range:" 22-24"},{date:"2-12",range:" 25-29"},{date:"2-13",range:" 30-32"},{date:"2-14",range:" 33-34"},{date:"2-15",range:" 35-38"},{date:"2-16",range:" 39-42"},{date:"2-17",range:" 1-2"},{date:"2-18",range:" 3-4"},{date:"2-19",range:" 5-6"},{date:"2-20",range:" 7-9"},{date:"2-21",range:" 10-12"},{date:"2-22",range:" 1-6"},{date:"2-23",range:" 1-2,  1-3"},{date:"2-24",range:" 4-8"},{date:"2-25",range:" 9-14"},{date:"2-26",range:" 7-10"},{date:"2-27",range:" 1-3"},{date:"2-28",range:" 4-7"},{date:"3-1",range:" 8-10"},{date:"3-2",range:" 11-13"},{date:"3-3",range:" 1-3"},{date:"3-4",range:" 4-6"},{date:"3-5",range:" 7-10"},{date:"3-6",range:" 1-4"},{date:"3-7",range:" 5-6"},{date:"3-8",range:" 7-9"},{date:"3-9",range:" 10-11"},{date:"3-10",range:" 12-13"},{date:"3-11",range:" 14-15"},{date:"3-12",range:" 16-18"},{date:"3-13",range:" 19-21"},{date:"3-14",range:" 22-23"},{date:"3-15",range:" 24-25"},{date:"3-16",range:" 26"},{date:"3-17",range:" 27-28"},{date:"3-18",range:" 1-3"},{date:"3-19",range:" 4-5"},{date:"3-20",range:" 1-3"},{date:"3-21",range:" 4-6"},{date:"3-22",range:" 7-9"},{date:"3-23",range:" 10-12"},{date:"3-24",range:" 13-16"},{date:"3-25",range:" 1-3"},{date:"3-26",range:" 4-6"},{date:"3-27",range:" 1-5"},{date:"3-28",range:" 6-9"},{date:"3-29",range:" 10-11"},{date:"3-30",range:" 12-13,  1"},{date:"3-31",range:" 2-3"},{date:"4-1",range:" 12-15"},{date:"4-2",range:" 16-19"},{date:"4-3",range:" 20-23"},{date:"4-4",range:" 24-26"},{date:"4-5",range:" 1-4"},{date:"4-6",range:" 5-7"},{date:"4-7",range:" 8-9"},{date:"4-8",range:" 10-12"},{date:"4-9",range:" 13-14"},{date:"4-10",range:" 15-16"},{date:"4-11",range:" 17-19"},{date:"4-12",range:" 20-21"},{date:"4-13",range:" 22-23"},{date:"4-14",range:" 24-25"},{date:"4-15",range:" 26-27"},{date:"4-16",range:" 1-2"},{date:"4-17",range:" 3-6"},{date:"4-18",range:" 7-9"},{date:"4-19",range:" 10-13"},{date:"4-20",range:" 14-15"},{date:"4-21",range:" 16-17"},{date:"4-22",range:" 18-20"},{date:"4-23",range:" 21-24"},{date:"4-24",range:" 25-26"},{date:"4-25",range:" 27-31"},{date:"4-26",range:" 1-3"},{date:"4-27",range:" 4-7"},{date:"4-28",range:" 8-12"},{date:"4-29",range:" 13-14"},{date:"4-30",range:" 15-17"},{date:"5-1",range:" 18-19"},{date:"5-2",range:" 20-22"},{date:"5-3",range:" 23-24"},{date:"5-4",range:" 1-7"},{date:"5-5",range:" 8-12"},{date:"5-6",range:" 13-17"},{date:"5-7",range:" 18-19"},{date:"5-8",range:" 20-24"},{date:"5-9",range:" 25-29"},{date:"5-10",range:" 30-33"},{date:"5-11",range:" 34-37"},{date:"5-12",range:" 38-41"},{date:"5-13",range:" 42-44"},{date:"5-14",range:" 45-49"},{date:"5-15",range:" 50-53"},{date:"5-16",range:" 54-58"},{date:"5-17",range:" 59-65"},{date:"5-18",range:" 66-68"},{date:"5-19",range:" 69-72"},{date:"5-20",range:" 1-3"},{date:"5-21",range:" 4-7"},{date:"5-22",range:" 8-10"},{date:"5-23",range:" 11-14"},{date:"5-24",range:" 15-20"},{date:"5-25",range:" 21-23"},{date:"5-26",range:" 24-27"},{date:"5-27",range:" 28-30"},{date:"5-28",range:" 31-35"},{date:"5-29",range:" 36-39"},{date:"5-30",range:" 40-42"},{date:"5-31",range:" 43-45"},{date:"6-1",range:" 46-49"},{date:"6-2",range:" 50-54"},{date:"6-3",range:" 55-58"},{date:"6-4",range:" 59-63"},{date:"6-5",range:" 64-66"},{date:"6-6",range:" 1-3"},{date:"6-7",range:" 1,  1-3"},{date:"6-8",range:" 1-3"},{date:"6-9",range:" 1-3"},{date:"6-10",range:" 4-6"},{date:"6-11",range:" 7-8"},{date:"6-12",range:" 9-10"},{date:"6-13",range:" 11-12"},{date:"6-14",range:" 13-14"},{date:"6-15",range:" 15-16"},{date:"6-16",range:" 6-7"},{date:"6-17",range:" 8-9"},{date:"6-18",range:" 10-12"},{date:"6-19",range:" 1-5"},{date:"6-20",range:" 6-8"},{date:"6-21",range:" 9-11"},{date:"6-22",range:" 12-14"},{date:"6-23",range:" 15-16"},{date:"6-24",range:" 1-5"},{date:"6-25",range:" 6-9"},{date:"6-26",range:" 10-13"},{date:"6-27",range:" 1-5"},{date:"6-28",range:" 1-3,  1-2"},{date:"6-29",range:" 3-5,  1"},{date:"6-30",range:" 4-7"},{date:"7-1",range:" 27-29"},{date:"7-2",range:" 30-31"},{date:"7-3",range:" 32-34"},{date:"7-4",range:" 35-36"},{date:"7-5",range:" 1-4"},{date:"7-6",range:" 5-7"},{date:"7-7",range:" 8-10"},{date:"7-8",range:" 11-13"},{date:"7-9",range:" 14-16"},{date:"7-10",range:" 17-21"},{date:"7-11",range:" 22-24"},{date:"7-12",range:" 25-27"},{date:"7-13",range:" 28-30"},{date:"7-14",range:" 31-32"},{date:"7-15",range:" 33-36"},{date:"7-16",range:" 1-2"},{date:"7-17",range:" 3-5"},{date:"7-18",range:" 6-7"},{date:"7-19",range:" 8-9"},{date:"7-20",range:" 10-11,  1"},{date:"7-21",range:" 2-4"},{date:"7-22",range:" 5-7"},{date:"7-23",range:" 8-11"},{date:"7-24",range:" 12-15"},{date:"7-25",range:" 16-18"},{date:"7-26",range:" 19-21"},{date:"7-27",range:" 22-24"},{date:"7-28",range:" 25-27"},{date:"7-29",range:" 28-31"},{date:"7-30",range:" 1-3"},{date:"7-31",range:" 4-7"},{date:"8-1",range:" 8-12"},{date:"8-2",range:" 1-4"},{date:"8-3",range:" 5-8,  12"},{date:"8-4",range:" 13-15"},{date:"8-5",range:" 16-17"},{date:"8-6",range:" 18-19"},{date:"8-7",range:" 20-22"},{date:"8-8",range:" 1-3"},{date:"8-9",range:" 4-5"},{date:"8-10",range:" 6-8"},{date:"8-11",range:" 9-10"},{date:"8-12",range:" 11-14"},{date:"8-13",range:" 1-4,  15"},{date:"8-14",range:" 1-4"},{date:"8-15",range:" 5-9"},{date:"8-16",range:" 1-4"},{date:"8-17",range:" 5-9"},{date:"8-18",range:" 10-14"},{date:"8-19",range:" 16-17"},{date:"8-20",range:" 18-19"},{date:"8-21",range:" 20-23"},{date:"8-22",range:" 1-3"},{date:"8-23",range:" 24-25"},{date:"8-24",range:" 1-5"},{date:"8-25",range:" 6-10"},{date:"8-26",range:" 11-14"},{date:"8-27",range:" 15-18"},{date:"8-28",range:" 19-21"},{date:"8-29",range:" 22-23"},{date:"8-30",range:" 24-27"},{date:"8-31",range:" 28-30"},{date:"9-1",range:" 31-33"},{date:"9-2",range:" 34-36"},{date:"9-3",range:" 37-39"},{date:"9-4",range:" 40-41"},{date:"9-5",range:" 42-44"},{date:"9-6",range:" 45-46"},{date:"9-7",range:" 47-48"},{date:"9-8",range:" 1-2"},{date:"9-9",range:" 3-4"},{date:"9-10",range:" 5-6"},{date:"9-11",range:" 7-8"},{date:"9-12",range:" 9-10"},{date:"9-13",range:" 11-12"},{date:"9-14",range:" 13-14"},{date:"9-15",range:" 15-16"},{date:"9-16",range:" 17-18"},{date:"9-17",range:" 19-20"},{date:"9-18",range:" 21-22"},{date:"9-19",range:" 23-24"},{date:"9-20",range:" 13-14"},{date:"9-21",range:" 15-17"},{date:"9-22",range:" 18-20"},{date:"9-23",range:" 1-3"},{date:"9-24",range:" 4-6"},{date:"9-25",range:" 1-4"},{date:"9-26",range:" 1-4,  1"},{date:"9-27",range:" 1-4"},{date:"9-28",range:" 5,  1-3"},{date:"9-29",range:" 8-12"},{date:"9-30",range:" 13-14"},{date:"10-1",range:" 37-39"},{date:"10-2",range:" 40-42"},{date:"10-3",range:" 43-44"},{date:"10-4",range:" 45-47"},{date:"10-5",range:" 48-50"},{date:"10-6",range:" 1-3"},{date:"10-7",range:" 4-5"},{date:"10-8",range:" 6-9"},{date:"10-9",range:" 10-12"},{date:"10-10",range:" 13-15"},{date:"10-11",range:" 16-18"},{date:"10-12",range:" 19-20"},{date:"10-13",range:" 21-23"},{date:"10-14",range:" 24-26"},{date:"10-15",range:" 27-28"},{date:"10-16",range:" 29-31"},{date:"10-17",range:" 32-34,  90"},{date:"10-18",range:" 1-3"},{date:"10-19",range:" 4-6"},{date:"10-20",range:" 7-9"},{date:"10-21",range:" 10-12"},{date:"10-22",range:" 13-16"},{date:"10-23",range:" 17-20"},{date:"10-24",range:" 21-23"},{date:"10-25",range:" 24-26"},{date:"10-26",range:" 27-29"},{date:"10-27",range:" 73-77"},{date:"10-28",range:" 78-80"},{date:"10-29",range:" 81-86"},{date:"10-30",range:" 87-91"},{date:"10-31",range:" 92-97"},{date:"11-1",range:" 98-103"},{date:"11-2",range:" 104-106"},{date:"11-3",range:" 107-111"},{date:"11-4",range:" 112-117"},{date:"11-5",range:" 118:1-119:80"},{date:"11-6",range:" 119:81-120:7"},{date:"11-7",range:" 121-127"},{date:"11-8",range:" 128-134"},{date:"11-9",range:" 135-138"},{date:"11-10",range:" 139-144"},{date:"11-11",range:" 145-150"},{date:"11-12",range:" 1-5"},{date:"11-13",range:" 6-9"},{date:"11-14",range:" 10-12"},{date:"11-15",range:" 13-16"},{date:"11-16",range:" 17-20"},{date:"11-17",range:" 21-24"},{date:"11-18",range:" 25-28"},{date:"11-19",range:" 1-3"},{date:"11-20",range:" 4-7"},{date:"11-21",range:" 29-31"},{date:"11-22",range:" 32-33"},{date:"11-23",range:" 34-36"},{date:"11-24",range:" 1-3"},{date:"11-25",range:" 4-6"},{date:"11-26",range:" 7-9"},{date:"11-27",range:" 10-12"},{date:"11-28",range:" 13-15"},{date:"11-29",range:" 16-18"},{date:"11-30",range:" 19-22"},{date:"12-1",range:" 23-25"},{date:"12-2",range:" 26:1-29:23"},{date:"12-3",range:" 29:24-32"},{date:"12-4",range:" 33-36"},{date:"12-5",range:" 37-39"},{date:"12-6",range:" 40-42"},{date:"12-7",range:" 43-45"},{date:"12-8",range:" 46-48"},{date:"12-9",range:" 49-50"},{date:"12-10",range:" 51-52"},{date:"12-11",range:" 1-2"},{date:"12-12",range:" 3-5"},{date:"12-13",range:" 1-4"},{date:"12-14",range:" 1-3"},{date:"12-15",range:" 4-5"},{date:"12-16",range:" 6-7"},{date:"12-17",range:" 8-9"},{date:"12-18",range:" 10-11"},{date:"12-19",range:" 12-13"},{date:"12-20",range:" 14-16"},{date:"12-21",range:" 17-18"},{date:"12-22",range:" 19-21"},{date:"12-23",range:" 21-23"},{date:"12-24",range:" 24-26"},{date:"12-25",range:" 27-28"},{date:"12-26",range:" 1-5"},{date:"12-27",range:" 6,  1-4"},{date:"12-28",range:" 1-3,  1-2"},{date:"12-29",range:" 3-5, , "},{date:"12-30",range:" 15-18"},{date:"12-31",range:" 19-22"}],M$=[{date:"1-1",range:" 1"},{date:"1-2",range:" 2"},{date:"1-3",range:" 3"},{date:"1-4",range:" 4"},{date:"1-5",range:" 5:1-26"},{date:"1-6",range:" 5:27-48"},{date:"1-7",range:" 6:1-18"},{date:"1-8",range:" 6:19-34"},{date:"1-9",range:" 7"},{date:"1-10",range:" 8:1-17"},{date:"1-11",range:" 8:18-34"},{date:"1-12",range:" 9:1-13"},{date:"1-13",range:" 9:14-38"},{date:"1-14",range:" 10:1-25"},{date:"1-15",range:" 10:26-11:1"},{date:"1-16",range:" 11:2-30"},{date:"1-17",range:" 12:1-21"},{date:"1-18",range:" 12:22-50"},{date:"1-19",range:" 13:1-30"},{date:"1-20",range:" 13:31-58"},{date:"1-21",range:" 14:1-21"},{date:"1-22",range:" 14:22-36"},{date:"1-23",range:" 15:1-20"},{date:"1-24",range:" 15:21-39"},{date:"1-25",range:" 16"},{date:"1-26",range:" 17"},{date:"1-27",range:" 18"},{date:"1-28",range:" 19"},{date:"1-29",range:" 20"},{date:"1-30",range:" 21:1-22"},{date:"1-31",range:" 21:23-46"},{date:"2-1",range:" 22:1-22"},{date:"2-2",range:" 22:23-46"},{date:"2-3",range:" 23:1-24"},{date:"2-4",range:" 23:25-39"},{date:"2-5",range:" 24:1-28"},{date:"2-6",range:" 24:29-51"},{date:"2-7",range:" 25:1-30"},{date:"2-8",range:" 25:31-46"},{date:"2-9",range:" 26:1-30"},{date:"2-10",range:" 26:31-56"},{date:"2-11",range:" 26:57-75"},{date:"2-12",range:" 27:1-31"},{date:"2-13",range:" 27:32-66"},{date:"2-14",range:" 28"},{date:"2-15",range:" 1"},{date:"2-16",range:" 2:1-24"},{date:"2-17",range:" 2:25-47"},{date:"2-18",range:" 3"},{date:"2-19",range:" 4:1-22"},{date:"2-20",range:" 4:23-37"},{date:"2-21",range:" 5:1-26"},{date:"2-22",range:" 5:27-42"},{date:"2-23",range:" 1"},{date:"2-24",range:" 2"},{date:"2-25",range:" 3"},{date:"2-26",range:" 4"},{date:"2-27",range:" 5"},{date:"2-28",range:" 6"},{date:"3-1",range:" 7"},{date:"3-2",range:" 8"},{date:"3-3",range:" 9:1-18"},{date:"3-4",range:" 9:19-33"},{date:"3-5",range:" 10"},{date:"3-6",range:" 11:1-16"},{date:"3-7",range:" 11:17-36"},{date:"3-8",range:" 12"},{date:"3-9",range:" 13"},{date:"3-10",range:" 14"},{date:"3-11",range:" 15:1-13"},{date:"3-12",range:" 15:14-33"},{date:"3-13",range:" 16"},{date:"3-14",range:" 1"},{date:"3-15",range:" 2"},{date:"3-16",range:" 3"},{date:"3-17",range:" 4:1-5:1"},{date:"3-18",range:" 5:2-26"},{date:"3-19",range:" 6"},{date:"3-20",range:" 1"},{date:"3-21",range:" 2"},{date:"3-22",range:" 3"},{date:"3-23",range:" 4"},{date:"3-24",range:" 5"},{date:"3-25",range:" 6"},{date:"3-26",range:" 7"},{date:"3-27",range:" 8"},{date:"3-28",range:" 9"},{date:"3-29",range:" 10:1-18"},{date:"3-30",range:" 10:19-39"},{date:"3-31",range:" 11:1-16"},{date:"4-1",range:" 11:17-40"},{date:"4-2",range:" 12:1-11"},{date:"4-3",range:" 12:12-29"},{date:"4-4",range:" 13"},{date:"4-5",range:" 1"},{date:"4-6",range:" 2"},{date:"4-7",range:" 3"},{date:"4-8",range:" 1:1-28"},{date:"4-9",range:" 1:29-45"},{date:"4-10",range:" 2"},{date:"4-11",range:" 3"},{date:"4-12",range:" 4:1-25"},{date:"4-13",range:" 4:26-41"},{date:"4-14",range:" 5"},{date:"4-15",range:" 6:1-29"},{date:"4-16",range:" 6:30-56"},{date:"4-17",range:" 7"},{date:"4-18",range:" 8:1-21"},{date:"4-19",range:" 8:22-38"},{date:"4-20",range:" 9:1-29"},{date:"4-21",range:" 9:30-50"},{date:"4-22",range:" 10:1-31"},{date:"4-23",range:" 10:32-52"},{date:"4-24",range:" 11:1-19"},{date:"4-25",range:" 11:20-33"},{date:"4-26",range:" 12:1-27"},{date:"4-27",range:" 12:28-44"},{date:"4-28",range:" 13:1-13"},{date:"4-29",range:" 13:14-37"},{date:"4-30",range:" 14:1-26"},{date:"5-1",range:" 14:27-52"},{date:"5-2",range:" 14:53-72"},{date:"5-3",range:" 15:1-20"},{date:"5-4",range:" 15:21-47"},{date:"5-5",range:" 16"},{date:"5-6",range:" 6"},{date:"5-7",range:" 7:1-16"},{date:"5-8",range:" 7:17-36"},{date:"5-9",range:" 7:37-60"},{date:"5-10",range:" 8:1-17"},{date:"5-11",range:" 8:18-40"},{date:"5-12",range:" 9:1-22"},{date:"5-13",range:" 9:23-43"},{date:"5-14",range:" 10:1-23"},{date:"5-15",range:" 10:24-48"},{date:"5-16",range:" 12"},{date:"5-17",range:" 13"},{date:"5-18",range:" 1"},{date:"5-19",range:" 2"},{date:"5-20",range:" 3"},{date:"5-21",range:" 4"},{date:"5-22",range:" 5"},{date:"5-23",range:" 6"},{date:"5-24",range:" 7:1-24"},{date:"5-25",range:" 7:25-40"},{date:"5-26",range:" 8"},{date:"5-27",range:" 9"},{date:"5-28",range:" 10:1-11:1"},{date:"5-29",range:" 11:2-34"},{date:"5-30",range:" 12"},{date:"5-31",range:" 13"},{date:"6-1",range:" 14:1-19"},{date:"6-2",range:" 14:20-40"},{date:"6-3",range:" 15:1-34"},{date:"6-4",range:" 15:35-58"},{date:"6-5",range:" 16"},{date:"6-6",range:" 1"},{date:"6-7",range:" 2"},{date:"6-8",range:" 3"},{date:"6-9",range:" 4"},{date:"6-10",range:" 5"},{date:"6-11",range:" 6"},{date:"6-12",range:" 7"},{date:"6-13",range:" 8"},{date:"6-14",range:" 9"},{date:"6-15",range:" 10"},{date:"6-16",range:" 11:1-15"},{date:"6-17",range:" 11:16-33"},{date:"6-18",range:" 12"},{date:"6-19",range:" 13"},{date:"6-20",range:" 1"},{date:"6-21",range:" 2"},{date:"6-22",range:" 3"},{date:"6-23",range:" 4"},{date:"6-24",range:" 5"},{date:"6-25",range:" 1"},{date:"6-26",range:" 2"},{date:"6-27",range:" 3"},{date:"6-28",range:" 1"},{date:"6-29",range:" 2"},{date:"6-30",range:" 3"},{date:"7-1",range:" 4"},{date:"7-2",range:" 5"},{date:"7-3",range:" 1"},{date:"7-4",range:" 4"},{date:"7-5",range:" 5"},{date:"7-6",range:" 6"},{date:"7-7",range:" 7"},{date:"7-8",range:" 1:1-25"},{date:"7-9",range:" 1:26-45"},{date:"7-10",range:" 1:46-80"},{date:"7-11",range:" 2:1-20"},{date:"7-12",range:" 2:21-52"},{date:"7-13",range:" 3:1-20"},{date:"7-14",range:" 3:21-4:13"},{date:"7-15",range:" 4:14-30"},{date:"7-16",range:" 4:31-44"},{date:"7-17",range:" 5:1-16"},{date:"7-18",range:" 5:17-39"},{date:"7-19",range:" 6:1-26"},{date:"7-20",range:" 6:27-49"},{date:"7-21",range:" 7:1-17"},{date:"7-22",range:" 7:18-50"},{date:"7-23",range:" 8:1-25"},{date:"7-24",range:" 8:26-56"},{date:"7-25",range:" 9:1-27"},{date:"7-26",range:" 9:28-50"},{date:"7-27",range:" 9:51-10:20"},{date:"7-28",range:" 10:21-42"},{date:"7-29",range:" 11:1-28"},{date:"7-30",range:" 11:29-54"},{date:"7-31",range:" 12:1-34"},{date:"8-1",range:" 12:35-59"},{date:"8-2",range:" 13:1-17"},{date:"8-3",range:" 13:18-35"},{date:"8-4",range:" 14:1-14"},{date:"8-5",range:" 14:15-35"},{date:"8-6",range:" 15:1-10"},{date:"8-7",range:" 15:11-32"},{date:"8-8",range:" 16:1-18"},{date:"8-9",range:" 16:19-31"},{date:"8-10",range:" 17:1-19"},{date:"8-11",range:" 17:20-37"},{date:"8-12",range:" 18:1-17"},{date:"8-13",range:" 18:18-43"},{date:"8-14",range:" 19:1-27"},{date:"8-15",range:" 19:28-48"},{date:"8-16",range:" 20:1-26"},{date:"8-17",range:" 20:27-47"},{date:"8-18",range:" 21:1-19"},{date:"8-19",range:" 21:20-38"},{date:"8-20",range:" 22:1-23"},{date:"8-21",range:" 22:24-46"},{date:"8-22",range:" 22:47-71"},{date:"8-23",range:" 23:1-25"},{date:"8-24",range:" 23:26-56"},{date:"8-25",range:" 24:1-35"},{date:"8-26",range:" 24:36-53"},{date:"8-27",range:" 14"},{date:"8-28",range:" 15:1-21"},{date:"8-29",range:" 15:22-41"},{date:"8-30",range:" 16:1-15"},{date:"8-31",range:" 16:16-40"},{date:"9-1",range:" 17:1-15"},{date:"9-2",range:" 17:16-34"},{date:"9-3",range:" 18"},{date:"9-4",range:" 19:1-20"},{date:"9-5",range:" 19:21-41"},{date:"9-6",range:" 20:1-16"},{date:"9-7",range:" 20:17-38"},{date:"9-8",range:" 1"},{date:"9-9",range:" 2"},{date:"9-10",range:" 3"},{date:"9-11",range:" 4"},{date:"9-12",range:" 5"},{date:"9-13",range:" 6"},{date:"9-14",range:" 1"},{date:"9-15",range:" 2"},{date:"9-16",range:" 3:1-4:1"},{date:"9-17",range:" 4:2-23"},{date:"9-18",range:" 1"},{date:"9-19",range:" 2"},{date:"9-20",range:" 3:1-4:1"},{date:"9-21",range:" 4:2-18"},{date:"9-22",range:" 1"},{date:"9-23",range:" 1"},{date:"9-24",range:" 2"},{date:"9-25",range:" 3"},{date:"9-26",range:" 4"},{date:"9-27",range:" 5"},{date:"9-28",range:" 1"},{date:"9-29",range:" 2"},{date:"9-30",range:" 3"},{date:"10-1",range:" 8"},{date:"10-2",range:" 9"},{date:"10-3",range:" 10"},{date:"10-4",range:" 11"},{date:"10-5",range:" 12"},{date:"10-6",range:" 13"},{date:"10-7",range:" 14"},{date:"10-8",range:" 1:1-28"},{date:"10-9",range:" 1:29-51"},{date:"10-10",range:" 2:1-12"},{date:"10-11",range:" 2:13-25"},{date:"10-12",range:" 3:1-21"},{date:"10-13",range:" 3:22-36"},{date:"10-14",range:" 4:1-26"},{date:"10-15",range:" 4:27-54"},{date:"10-16",range:" 5:1-30"},{date:"10-17",range:" 5:31-47"},{date:"10-18",range:" 6:1-21"},{date:"10-19",range:" 6:22-40"},{date:"10-20",range:" 6:41-71"},{date:"10-21",range:" 7:1-24"},{date:"10-22",range:" 7:25-52"},{date:"10-23",range:" 7:53-8:20"},{date:"10-24",range:" 8:21-38"},{date:"10-25",range:" 8:39-59"},{date:"10-26",range:" 9:1-23"},{date:"10-27",range:" 9:24-41"},{date:"10-28",range:" 10:1-21"},{date:"10-29",range:" 10:22-42"},{date:"10-30",range:" 11:1-27"},{date:"10-31",range:" 11:28-57"},{date:"11-1",range:" 12:1-26"},{date:"11-2",range:" 12:27-36"},{date:"11-3",range:" 12:37-50"},{date:"11-4",range:" 13:1-20"},{date:"11-5",range:" 13:21-38"},{date:"11-6",range:" 14:1-14"},{date:"11-7",range:" 14:15-31"},{date:"11-8",range:" 15:1-16:4"},{date:"11-9",range:" 16:5-33"},{date:"11-10",range:" 17:1-13"},{date:"11-11",range:" 17:14-26"},{date:"11-12",range:" 18:1-18"},{date:"11-13",range:" 18:19-40"},{date:"11-14",range:" 19:1-16"},{date:"11-15",range:" 19:17-42"},{date:"11-16",range:" 20:1-18"},{date:"11-17",range:" 20:19-31"},{date:"11-18",range:" 21:1-14"},{date:"11-19",range:" 21:15-25"},{date:"11-20",range:" 21:1-16"},{date:"11-21",range:" 21:17-40"},{date:"11-22",range:" 22:1-16"},{date:"11-23",range:" 22:17-30"},{date:"11-24",range:" 23:1-11"},{date:"11-25",range:" 23:12-35"},{date:"11-26",range:" 24"},{date:"11-27",range:" 25"},{date:"11-28",range:" 26:1-18"},{date:"11-29",range:" 26:19-32"},{date:"11-30",range:" 27:1-20"},{date:"12-1",range:" 27:21-44"},{date:"12-2",range:" 28:1-16"},{date:"12-3",range:" 28:17-31"},{date:"12-4",range:" 1"},{date:"12-5",range:" 2"},{date:"12-6",range:" 3"},{date:"12-7",range:" 4"},{date:"12-8",range:" 5"},{date:"12-9",range:" 6"},{date:"12-10",range:" 1"},{date:"12-11",range:" 2"},{date:"12-12",range:" 3"},{date:"12-13",range:" 4"},{date:"12-14",range:" 1"},{date:"12-15",range:" 2"},{date:"12-16",range:" 3"},{date:"12-17",range:" 1"},{date:"12-18",range:" 2"},{date:"12-19",range:" 3"},{date:"12-20",range:" 4"},{date:"12-21",range:" 5"},{date:"12-22",range:" 1"},{date:"12-23",range:" 1"},{date:"12-24",range:" 15"},{date:"12-25",range:" 16"},{date:"12-26",range:" 17"},{date:"12-27",range:" 18:1-19:4"},{date:"12-28",range:" 19:5-21"},{date:"12-29",range:" 20"},{date:"12-30",range:" 21"},{date:"12-31",range:" 22"}],Hn={whole_bible:L$,new_testament:M$},F$={...Hn,"1year_revised":Hn.whole_bible,"1year_new":Hn.whole_bible,"1year_easy":Hn.whole_bible,"1year_saehangul":Hn.whole_bible,"1year_sequential":Hn.whole_bible,nt_new:Hn.whole_bible,nt_easy:Hn.whole_bible,nt_saehangul:Hn.whole_bible,nt_message:Hn.whole_bible},Mw=F$,kg=[{min:0,title:" ",emoji:""},{min:50,title:" ",emoji:""},{min:150,title:" ",emoji:""},{min:350,title:" ",emoji:""},{min:600,title:" ",emoji:""},{min:1e3,title:" ",emoji:""},{min:1500,title:" ",emoji:""},{min:2200,title:" ",emoji:""},{min:3200,title:"  ",emoji:""},{min:4300,title:"",emoji:""}],V$=t=>[...kg].reverse().find(e=>t>=e.min)||kg[0],Sg=[{id:"first_read",title:" ",desc:"  ",emoji:"",condition:t=>t.currentDay>1},{id:"streak_7",title:" ",desc:"7  ",emoji:"",condition:t=>t.streak>=7},{id:"streak_30",title:"  ",desc:"30  ",emoji:"",condition:t=>t.streak>=30},{id:"streak_100",title:" ",desc:"100  ",emoji:"",condition:t=>t.streak>=100},{id:"day_30",title:"30 ",desc:"30 ",emoji:"",condition:t=>t.currentDay>=30},{id:"day_100",title:"100 ",desc:"100 ",emoji:"",condition:t=>t.currentDay>=100},{id:"day_200",title:"200 ",desc:"200 ",emoji:"",condition:t=>t.currentDay>=200},{id:"day_365",title:" ",desc:"365  !",emoji:"",condition:t=>t.currentDay>=365},{id:"first_memo",title:" ",desc:"  ",emoji:"",condition:(t,e)=>Object.keys(e||{}).length>=1},{id:"memo_10",title:" 10",desc:" 10 ",emoji:"",condition:(t,e)=>Object.keys(e||{}).length>=10},{id:"memo_50",title:" 50",desc:" 50 ",emoji:"",condition:(t,e)=>Object.keys(e||{}).length>=50},{id:"score_100",title:"100 ",desc:" 100 ",emoji:"",condition:t=>t.score>=100},{id:"score_500",title:"500 ",desc:" 500 ",emoji:"",condition:t=>t.score>=500},{id:"score_1000",title:"1000 ",desc:" 1000 ",emoji:"",condition:t=>t.score>=1e3}],th=[{id:"1year",title:" ",desc:"1  1 ."},{id:"nt",title:" ",desc:"1   1 ."}],gs={"1year":[{id:"revised",name:"",desc:"   ",tagName:" "},{id:"new",name:"",desc:"     ",tagName:" "},{id:"easy",name:"",desc:"     ",tagName:" "},{id:"saehangul",name:"",desc:"    ",tagName:" "},{id:"sequential",name:"()",desc:"   ",tagName:" "}],nt:[{id:"new",name:"",desc:"     ",tagName:" "},{id:"easy",name:"",desc:"     ",tagName:" "},{id:"saehangul",name:"",desc:"    ",tagName:" "},{id:"message",name:" ",desc:"       ",tagName:" "}]},U$=t=>`${encodeURIComponent(String(t||"").trim())}@bible.local`,Tg=t=>{const e=t.data();return{uid:t.id,name:e.name,password:e.password,startDate:e.startDate,currentDay:e.currentDay!==void 0&&e.currentDay!==null?e.currentDay:1,streak:e.streak!==void 0&&e.streak!==null?e.streak:0,score:e.score!==void 0&&e.score!==null?e.score:0,lastReadDate:e.lastReadDate!==void 0&&e.lastReadDate!==null?e.lastReadDate:null,gender:e.gender!==void 0&&e.gender!==null?e.gender:"male",communityId:e.communityId!==void 0&&e.communityId!==null?e.communityId:null,communityName:e.communityName!==void 0&&e.communityName!==null?e.communityName:null,subgroupId:e.subgroupId!==void 0&&e.subgroupId!==null?e.subgroupId:null,planId:e.planId!==void 0&&e.planId!==null?e.planId:"1year_revised",achievements:e.achievements!==void 0&&e.achievements!==null?e.achievements:[],memos:e.memos!==void 0&&e.memos!==null?e.memos:{},dayOffset:e.dayOffset!==void 0&&e.dayOffset!==null?e.dayOffset:0,readCount:e.readCount!==void 0&&e.readCount!==null?e.readCount:1,readHistory:e.readHistory!==void 0&&e.readHistory!==null?e.readHistory:[]}},z$=t=>{const e=["","","","","","","","","",""],n=parseInt(t,10);if(isNaN(n))return t;if(n===0)return e[0];let r="";const s=["","","",""],i=n.toString();for(let o=0;o<i.length;o++){const a=parseInt(i[o],10),c=i.length-1-o;a!==0&&(a===1&&c>0||(r+=e[a]),r+=s[c])}return r},B$=(t,e)=>{const n=[31,28,31,30,31,30,31,31,30,31,30,31];let r=0;for(let s=0;s<t-1;s++)r+=n[s];return r+=e-1,r},q$=(t,e)=>{let n=t+e;for(;n>365;)n-=365;for(;n<1;)n+=365;return n},W$=`### 1.    
2.            
3.       
4.        
()`,Pk=365,$p="https://bible114.net/html/audio",td="https://mvwhepqqzdtqtorgkrtf.supabase.co/functions/v1/notion-proxy",xv=t=>{const e=new Date().toDateString(),n={};return Lr.forEach(r=>{r.subgroups.forEach(s=>{const i=t.filter(f=>f.communityId===r.id&&f.subgroupId===s),o=i.length,a=i.filter(f=>f.lastReadDate===e).length,c=o>0?Math.round(a/o*100):0,u=o>0?i.reduce((f,m)=>{const x=((m.readCount||1)-1)*365+(m.currentDay||1);return f+x},0)/o:0,d=Math.round(u/Pk*100),h=i.reduce((f,m)=>f+(m.score||0),0);n[`${r.id}_${s}`]={rate:c,readCount:a,totalCount:o,progressRate:d,avgDay:Math.round(u),totalScore:h,communityId:r.id,communityName:r.name,subgroupName:s}})}),n},H$=t=>{if(!t||t.length===0)return null;const e=new Date,n=new Date(e);n.setDate(e.getDate()-e.getDay()),n.setHours(0,0,0,0);const r=h=>!h.readHistory||!Array.isArray(h.readHistory)?0:h.readHistory.reduce((f,m)=>{try{const y=typeof m=="string"?m:m.date,x=typeof m=="string"?1:m.daysRead||1;return new Date(y)>=n?f+x:f}catch{return f}},0),s=t.map(h=>({...h,weeklyCount:r(h),totalCount:h.readHistory?h.readHistory.length:0})).filter(h=>h.weeklyCount>0).sort((h,f)=>f.weeklyCount!==h.weeklyCount?f.weeklyCount-h.weeklyCount:f.totalCount-h.totalCount),i=s.length>0?s[0]:null,o=s.slice(0,10),c=t.map(h=>({...h,totalCount:((h.readCount||1)-1)*365+(h.currentDay||0)})).filter(h=>h.totalCount>0).sort((h,f)=>f.totalCount-h.totalCount),u=c.length>0?c[0]:null,d=c.slice(0,10);return{streakMVP:i,progressMVP:u,weeklyTop10:o,totalTop10:d}},G$=t=>!t||Object.keys(t).length===0?[]:Object.keys(t).map(function(e){var n=t[e];return{name:n.subgroupName,rate:n.rate||0,readCount:n.readCount||0,totalCount:n.totalCount||0,progressRate:n.progressRate||0,avgDay:n.avgDay||0,totalScore:n.totalScore||0,communityId:n.communityId,communityName:n.communityName}}).sort(function(e,n){return n.progressRate!==e.progressRate?n.progressRate-e.progressRate:n.totalScore-e.totalScore}),K$=t=>!t||Object.keys(t).length===0?[]:Object.keys(t).map(function(e){var n=t[e];return{name:n.subgroupName,progressRate:n.progressRate||0,avgDay:n.avgDay||0,totalScore:n.totalScore||0,totalCount:n.totalCount||0,communityId:n.communityId,communityName:n.communityName}}).filter(function(e){return e.totalCount>0}).sort(function(e,n){return n.progressRate-e.progressRate}),Q$=t=>{const e=new Date().toDateString(),n=t.length,r=t.filter(o=>o.lastReadDate===e).length,s=n>0?Math.round(r/n*100):0,i={};return Lr.forEach(o=>{const a=t.filter(d=>d.communityId===o.id),c=a.length,u=a.filter(d=>d.lastReadDate===e).length;i[o.id]={name:o.name,total:c,readToday:u,rate:c>0?Math.round(u/c*100):0}}),{totalUsers:n,readToday:r,readRate:s,communityStats:i}},Y$=t=>{if(!t)return{lines:[""],bgColor:"bg-gradient-to-br from-slate-400 to-slate-500"};const e={"1":"bg-[#FF5252] text-white border-red-600","2":"bg-[#FF7043] text-white border-orange-600","3":"bg-[#FFA726] text-white border-amber-600","4":"bg-[#FBC02D] text-white border-yellow-700","5":"bg-[#8BC34A] text-white border-lime-700","6":"bg-[#4CAF50] text-white border-green-700","7":"bg-[#009688] text-white border-emerald-700","8":"bg-[#00BCD4] text-white border-teal-700","9":"bg-[#03A9F4] text-white border-sky-700","10":"bg-[#42A5F5] text-white border-blue-600","11":"bg-[#2196F3] text-white border-blue-700","12":"bg-[#3F51B5] text-white border-indigo-700","13":"bg-[#673AB7] text-white border-violet-700","14":"bg-[#9C27B0] text-white border-purple-700","15":"bg-[#F06292] text-white border-fuchsia-700","16":"bg-[#FF4081] text-white border-pink-700","17":"bg-[#E91E63] text-white border-rose-700",:"bg-[#FFB300] text-white border-amber-700",:"bg-[#1E88E5] text-white border-blue-800",:"bg-[#5C6BC0] text-white border-indigo-800",:"bg-[#43A047] text-white border-green-800",:"bg-[#78909C] text-white border-slate-600"},n={1:["","1"],2:["","2"],:["",""],:["",""],"1":["1",""],"2":["2",""],"3":["3",""],"4":["4",""],"5":["5",""]," ":["",""]," ":["",""]," ":["",""]," ":["",""]," ":["",""],:["",""]};return t.match(/^\d+$/)?{lines:[t],bgColor:e[t]||"bg-slate-400"}:t.match(/^\d+$/)?{lines:[t],bgColor:e[t]||"bg-slate-400"}:n[t]?{lines:n[t],bgColor:e[t]||"bg-slate-400"}:{lines:[t],bgColor:e[t]||"bg-slate-400"}},Fw=(t,e,n={})=>{const r=Object.keys(e).length,s=Object.keys(e).map(function(d){return[d,e[d]]}).sort(function(d,h){return Number(d[0])-Number(h[0])});let i="";s.forEach(([d,h])=>{const f=h.date?new Date(h.date).toLocaleDateString("ko-KR"):"",m=Array.isArray(h.texts)?h.texts:[h.text||""];i+=`
                    <div style="background: white; border-radius: 16px; padding: 24px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 2px solid #e2e8f0;">
                            <span style="background: linear-gradient(135deg, #4f46e5, #7c3aed); color: white; padding: 8px 20px; border-radius: 25px; font-weight: bold; font-size: 18px;">DAY ${d}</span>
                            <span style="color: #64748b; font-size: 16px;">${f}</span>
                        </div>
                        <div style="color: #475569; font-size: 17px; font-weight: 600; margin-bottom: 16px;">${h.title||""}</div>
                        ${m.map((y,x)=>`
                            <div style="color: #1e293b; font-size: 18px; line-height: 1.9; white-space: pre-wrap; ${m.length>1?"background: #f8fafc; padding: 16px; border-radius: 12px; margin-bottom: 12px;":""}">${y}</div>
                        `).join("")}
                    </div>
                `});const o=`<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>${t}  </title>
<style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { 
        font-family: -apple-system, BlinkMacSystemFont, "Malgun Gothic", " ", sans-serif;
        background: linear-gradient(180deg, #f0f4ff 0%, #fdf4ff 100%);
        min-height: 100vh;
        padding: 20px;
        -webkit-text-size-adjust: 100%;
    }
    .container { max-width: 600px; margin: 0 auto; }
    @media print {
        body { background: white; padding: 0; }
        .no-print { display: none; }
    }
</style>
</head>
<body>
<div class="container">
    <!--  -->
    <div style="background: linear-gradient(135deg, #4f46e5, #7c3aed); border-radius: 24px; padding: 50px 30px; text-align: center; color: white; margin-bottom: 30px;">
        <div style="font-size: 60px; margin-bottom: 20px;"></div>
        <div style="font-size: 32px; font-weight: bold; margin-bottom: 10px;">${t}</div>
        <div style="font-size: 22px; opacity: 0.9;">2025  </div>
        <div style="font-size: 16px; opacity: 0.7; margin-top: 10px;"> 365</div>
    </div>
    
    <!--  -->
    <div style="background: white; border-radius: 20px; padding: 30px; margin-bottom: 30px; box-shadow: 0 2px 12px rgba(0,0,0,0.08);">
        <h2 style="text-align: center; font-size: 24px; color: #1e293b; margin-bottom: 25px;">  </h2>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div style="background: #f0f4ff; padding: 25px; border-radius: 16px; text-align: center;">
                <div style="font-size: 36px; font-weight: bold; color: #4f46e5;">${r}</div>
                <div style="color: #64748b; font-size: 16px; margin-top: 5px;"> </div>
            </div>
            <div style="background: #f0fdf4; padding: 25px; border-radius: 16px; text-align: center;">
                <div style="font-size: 36px; font-weight: bold; color: #059669;">${n.currentDay||1}</div>
                <div style="color: #64748b; font-size: 16px; margin-top: 5px;"> Day</div>
            </div>
            <div style="background: #fef2f2; padding: 25px; border-radius: 16px; text-align: center;">
                <div style="font-size: 36px; font-weight: bold; color: #dc2626;">${n.score||0}</div>
                <div style="color: #64748b; font-size: 16px; margin-top: 5px;"> </div>
            </div>
            <div style="background: #fffbeb; padding: 25px; border-radius: 16px; text-align: center;">
                <div style="font-size: 36px; font-weight: bold; color: #f59e0b;">${n.streak||0}</div>
                <div style="color: #64748b; font-size: 16px; margin-top: 5px;"> </div>
            </div>
        </div>
        <div style="text-align: center; color: #94a3b8; font-size: 14px; margin-top: 20px;">
            : ${new Date().toLocaleDateString("ko-KR")}
        </div>
    </div>
    
    <!--   -->
    ${s.length>0?`
        <h2 style="font-size: 24px; color: #1e293b; margin-bottom: 20px; padding-left: 10px;">  </h2>
        ${i}
    `:`
        <div style="text-align: center; padding: 50px; color: #94a3b8;">
            <div style="font-size: 50px; margin-bottom: 15px;"></div>
            <div style="font-size: 18px;">   .</div>
        </div>
    `}
    
    <!--  -->
    <div style="background: linear-gradient(135deg, #4f46e5, #7c3aed); border-radius: 24px; padding: 40px 30px; text-align: center; color: white; margin-top: 30px;">
        <div style="font-size: 50px; margin-bottom: 20px;"></div>
        <div style="font-size: 26px; font-weight: bold; margin-bottom: 15px;">!</div>
        <div style="font-size: 16px; opacity: 0.9; line-height: 1.8; margin-bottom: 20px;">
            "    <br>
                 <br>
               <br>
                 "
        </div>
        <div style="font-size: 18px; opacity: 0.8;">-  12:1 -</div>
    </div>
    
    <div style="text-align: center; padding: 30px; color: #94a3b8; font-size: 14px;">
           
    </div>
</div>
</body>
</html>`,a=new Blob([o],{type:"text/html;charset=utf-8"}),c=URL.createObjectURL(a),u=document.createElement("a");u.href=c,u.download=`${t}__2025.html`,u.click(),URL.revokeObjectURL(c)},X$=async t=>{if(t)try{const e=await t.collection("users").get();let n=`Name,Subgroup,Day,Date,Title,Memo
`;e.docs.forEach(o=>{const a=o.data(),c=a.name||"Unknown",u=a.subgroupId||"-",d=a.memos||{};Object.keys(d).forEach(function(h){var f=d[h];const m=f.date?new Date(f.date).toLocaleDateString("ko-KR"):"",y=(f.title||"").replace(/,/g,";").replace(/\n/g," "),x=(f.text||"").replace(/,/g,";").replace(/\n/g," ");n+=`"${c}","${u}","${h}","${m}","${y}","${x}"
`})});const r=new Blob(["\uFEFF"+n],{type:"text/csv;charset=utf-8;"}),s=URL.createObjectURL(r),i=document.createElement("a");i.href=s,i.download=`all_memos_${new Date().toISOString().split("T")[0]}.csv`,i.click(),URL.revokeObjectURL(s)}catch(e){console.error("CSV  :",e),alert("CSV    .")}},J$=t=>{if(t.length===0){alert(" .");return}let e=`data:text/csv;charset=utf-8,\uFEFF,,,Day,,,,ID
`;t.forEach(r=>{e+=`${r.name},${r.communityName},${r.subgroupId},${r.currentDay},${r.score},${r.streak},${r.lastReadDate||""},${r.planId||"1year_revised"}\r
`});const n=document.createElement("a");n.setAttribute("href",encodeURI(e)),n.setAttribute("download",`__${new Date().toISOString().slice(0,10)}.csv`),document.body.appendChild(n),n.click(),document.body.removeChild(n)},Z$=()=>{const[t,e]=A.useState(null),[n,r]=A.useState(!0);return A.useEffect(()=>{if(!Pt){r(!1);return}const s=Pt.onAuthStateChanged(async i=>{if(console.log(" Auth state changed:",i?i.uid:null),i)try{const o=await fe.collection("users").doc(i.uid).get();if(o.exists){const a=Tg(o);console.log("   :",a.name),e(a)}else console.log(" Firestore  "),e(null)}catch(o){console.error("   :",o),e(null)}else e(null);r(!1)});return()=>s()},[]),{currentUser:t,setCurrentUser:e,authLoading:n}},Vw=t=>{if(!t)return t;const e=/(^|[.!?""\(\)\[\]]\s*)(\d+)(?=[-])(?!(||||||||||||||||||)(?![-]))/gm;let n=!0;return t.replace(e,(s,i,o)=>{const a=`[[VERSE:${o}]]`;return n&&i.trim()===""?(n=!1,a):(n=!1,`${i}
${a}`)})},eL=t=>{const[e,n]=A.useState({title:"",subtitle:"",text:"",audioUrl:null,loading:!1}),[r,s]=A.useState(null),i=async(u,d)=>{if(!fe)return null;try{const[h,f]=(u||"1year_revised").split("_"),m=`${h}_${f}_${d}`,y=await fe.collection("verses").doc(m).get();if(y.exists)return y.data()}catch(h){console.error("  :",h)}return null},o=async(u,d)=>{const[h,f]=(u||"1year_revised").split("_"),m=gs[h],y=m?m.find(v=>v.id===f):null,x=y?y.tagName:" ",w=new Date(2025,0,d),g=String(w.getMonth()+1).padStart(2,"0"),p=String(w.getDate()).padStart(2,"0");try{const v=await fetch(td,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:x,date:`${g}-${p}`})});if(!v.ok)throw new Error(`Server Error: ${v.status}`);const b=await v.json();return b.error?{title:null,text:`[] ${b.error}`}:{title:b.title,text:b.text,audioUrl:b.audioUrl}}catch(v){return console.error(v),{title:null,text:"    ."}}},a=async(u,d)=>{const h=await i(u,d);return h&&h.text?h:await o(u,d)},c=A.useCallback(async u=>{if(!t)return;n(b=>({...b,loading:!0}));const{planId:d,dayOffset:h=0,readCount:f=1}=t,[m,y]=(d||"1year_revised").split("_"),x=th.find(b=>b.id===m),w=x?x.title:" ",g=q$(u,h),p=await a(d,g),v=f>1?` (${f})`:"";if(p&&p.text&&!p.text.startsWith("[]")){let b=p.text;y&&y.startsWith("saehangul")&&(b=Vw(b));let I=p.audioUrl||null;!I&&$p&&$p.startsWith("http")&&(I=`${$p.replace(/\/$/,"")}/${d}/${g}.mp3`),n({title:`${w} DAY ${u}${v}`,subtitle:p.title||"( )",text:b,audioUrl:I,loading:!1})}else{const b=gs[m],I=b?b.find(C=>C.id===y):null,_=I&&I.name||"";let N=g===1?W$:p&&p.text||"   .";y&&y.startsWith("saehangul")&&(N=Vw(N)),n({title:`${w} DAY ${u}${v}`,subtitle:`${_} `,text:N,audioUrl:null,loading:!1})}},[t]);return{verseData:e,setVerseData:n,viewingDay:r,setViewingDay:s,loadContent:c}},tL=t=>{const[e,n]=A.useState({}),r=A.useCallback(async i=>{if(!fe||!i)return{};try{const o=await fe.collection("users").doc(i).get();if(o.exists&&o.data().memos)return n(o.data().memos),o.data().memos}catch(o){console.error("  :",o)}return{}},[]),s=A.useCallback(async(i,o,a,c,u)=>{const d=t?t.uid:null;if(!d||!o.trim())return;const h=e[i];let f=[];h&&(h.texts?f=[...h.texts]:h.text&&(f=[h.text])),f.push(o);const m={...e,[i]:{texts:f,text:f.join(`

---

`),date:new Date().toISOString(),title:a}};n(m),typeof u=="function"&&u();try{await fe.collection("users").doc(d).set({memos:m,updatedAt:Ie.firestore.FieldValue.serverTimestamp()},{merge:!0}),c&&c(t,m)}catch(y){console.error("  :",y)}},[t,e]);return{memos:e,setMemos:n,loadMemos:r,saveMemo:s}},nL=(t,e)=>{const[n,r]=A.useState({}),[s,i]=A.useState([]),[o,a]=A.useState([]),[c,u]=A.useState(null),d=A.useCallback(async()=>{try{return(await fe.collection("users").get()).docs.map(x=>({uid:x.id,...x.data()}))}catch(m){return console.error("  :",m),[]}},[]),h=A.useCallback(async()=>{try{const m=await fe.collection("settings").doc("announcement").get();m.exists&&m.data().enabled?u(m.data()):u(null)}catch(m){console.error("  :",m)}},[]),f=A.useCallback(async m=>{const y=t?t.uid:null;if(y)try{await fe.collection("users").doc(y).set({subgroupId:m,updatedAt:Ie.firestore.FieldValue.serverTimestamp()},{merge:!0}),e(w=>({...w,subgroupId:m})),alert(` "${m}"() !`);const x=await d();if(a(x),r(xv(x)),t.communityId){const w=x.filter(g=>g.communityId===t.communityId);i(w)}}catch(x){console.error("  :",x),alert(" ")}},[t,e,d]);return{subgroupStats:n,setSubgroupStats:r,communityMembers:s,setCommunityMembers:i,allMembersForRace:o,setAllMembersForRace:a,announcement:c,setAnnouncement:u,loadAllMembers:d,loadAnnouncement:h,changeSubgroup:f}},rL=(t,e,n,r,s,i,o)=>{const[a,c]=A.useState([]),[u,d]=A.useState(!1),[h,f]=A.useState(!1),[m,y]=A.useState(null),[x,w]=A.useState(null),[g,p]=A.useState(null),v=A.useCallback((N,C)=>{if(!N)return;const R=[],j=new Set(N.achievements||[]);if(Sg.forEach(W=>{j.has(W.id)||W.condition(N,C)&&(R.push(W.id),p(Q=>W),setTimeout(()=>p(null),5e3))}),R.length>0){const W=[...N.achievements||[],...R];fe.collection("users").doc(N.uid).update({achievements:W})}},[]),b=A.useCallback(async()=>{if(!t)return;const N=t.uid,C=new Date().toDateString(),R=t.currentDay||1,j=t.score||0,W=Math.floor(j/100),Q=Math.min(5,t.streak||0),te=10+Q,Z=j+te,Re=Math.floor(Z/100),Le=R>=365?1:R+1,ke=R>=365?(t.readCount||1)+1:t.readCount||1,V=R>=365;let T=1;if(t.lastReadDate){const B=new Date(t.lastReadDate),M=new Date(C),X=Math.floor((M-B)/(1e3*60*60*24));X===1?T=(t.streak||0)+1:X===0&&(T=t.streak||0)}const S={currentDay:Le,readCount:ke,score:Z,streak:T,lastReadDate:C,updatedAt:Ie.firestore.FieldValue.serverTimestamp()},O={date:C,day:R,score:te};try{await fe.collection("users").doc(N).set(S,{merge:!0}),await fe.collection("users").doc(N).collection("history").add(O);const B={...t,...S};e(B),o(Le),d(!0),c(X=>[O,...X]),Re>W&&(y(!0),setTimeout(()=>y(!1),5e3)),Q>0&&(w(`${Q}   +${Q}pt!`),setTimeout(()=>w(null),3e3));const M=await i();if(n(M),s(xv(M)),t.communityId){const X=M.filter(me=>me.communityId===t.communityId);r(X)}V&&alert(` ! ${ke-1} !

 ${ke} ! `),f(!0),setTimeout(()=>f(!1),3e3),v(B,{}),window.scrollTo({top:0,behavior:"smooth"})}catch(B){console.error("  :",B)}},[t,e,i,n,r,s,v]),I=A.useCallback(async(N,C)=>{if(!t)return;const R=t.uid;try{const j=new Date().toDateString();await fe.collection("users").doc(R).set({currentDay:1,score:0,streak:0,startDate:j,lastReadDate:null,memos:{},achievements:[],updatedAt:Ie.firestore.FieldValue.serverTimestamp()},{merge:!0}),e(W=>({...W,currentDay:1,score:0,streak:0,startDate:j,lastReadDate:null,achievements:[],readCount:1})),N&&N({}),C&&C([]),alert("!  Day 1. ! ")}catch(j){console.error(" :",j),alert(" ")}},[t,e]),_=A.useCallback(async N=>{if(!t)return;const C=t.uid;try{await fe.collection("users").doc(C).set({dayOffset:N,updatedAt:Ie.firestore.FieldValue.serverTimestamp()},{merge:!0}),e(R=>({...R,dayOffset:N}))}catch(R){console.error("  :",R)}},[t,e]);return{readHistory:a,setReadHistory:c,hasReadToday:u,setHasReadToday:d,showConfetti:h,setShowConfetti:f,levelUpToast:m,setLevelUpToast:y,bonusToast:x,setBonusToast:w,newAchievement:g,setNewAchievement:p,handleRead:b,handleRestart:I,changeStartDate:_,checkAchievements:v}},sL=(t,e,n)=>{const{verseData:r,setVerseData:s,viewingDay:i,setViewingDay:o,loadContent:a}=eL(t),{subgroupStats:c,setSubgroupStats:u,communityMembers:d,setCommunityMembers:h,allMembersForRace:f,setAllMembersForRace:m,announcement:y,loadAnnouncement:x,loadAllMembers:w,changeSubgroup:g}=nL(t,e),{readHistory:p,setReadHistory:v,hasReadToday:b,setHasReadToday:I,showConfetti:_,setShowConfetti:N,levelUpToast:C,setLevelUpToast:R,bonusToast:j,setBonusToast:W,newAchievement:Q,setNewAchievement:te,handleRead:Z,handleRestart:Re,changeStartDate:Le,checkAchievements:ke}=rL(t,e,m,h,u,w,o),{memos:V,setMemos:T,loadMemos:S,saveMemo:O}=tL(t);return A.useEffect(()=>{if(n!=="dashboard"||!t)return;if(i===null){o(t.currentDay||1);return}(async()=>{await a(i);const M=await w();if(m(M),M&&M.length>0&&(u(xv(M)),t.communityId)){const me=M.filter(oe=>oe.communityId===t.communityId);h(me)}const X=Pt.currentUser?Pt.currentUser.uid:null;if(X){await S(X);const me=await fe.collection("users").doc(X).get();me.exists&&me.data().readHistory&&v(me.data().readHistory)}await x()})()},[n,t==null?void 0:t.uid,i,t==null?void 0:t.planId,t==null?void 0:t.dayOffset,a,w,S,x,m,u,h,v]),A.useEffect(()=>{t&&t.lastReadDate===new Date().toDateString()?I(!0):I(!1)},[t,I]),{verseData:r,setVerseData:s,subgroupStats:c,setSubgroupStats:u,communityMembers:d,setCommunityMembers:h,allMembersForRace:f,setAllMembersForRace:m,memos:V,setMemos:T,readHistory:p,setReadHistory:v,announcement:y,viewingDay:i,setViewingDay:o,hasReadToday:b,setHasReadToday:I,showConfetti:_,setShowConfetti:N,levelUpToast:C,setLevelUpToast:R,bonusToast:j,setBonusToast:W,newAchievement:Q,setNewAchievement:te,handleRead:Z,saveMemo:(B,M,X)=>O(B,M,r.subtitle,ke,X),changeSubgroup:g,handleRestart:()=>Re(T,v),changeStartDate:Le,loadAllMembers:w,loadMemos:S,loadAnnouncement:x}},pe=({name:t,size:e=20,className:n=""})=>({crown:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:l.jsx("path",{d:"m2 4 3 12h14l3-12-6 7-4-3-4 3-6-7zm5 16h10"})}),trophy:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6"}),l.jsx("path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18"}),l.jsx("path",{d:"M4 22h16"}),l.jsx("path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"}),l.jsx("path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"}),l.jsx("path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z"})]}),users:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"9",cy:"7",r:"4"}),l.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),l.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),book:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:l.jsx("path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"})}),arrowRight:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("path",{d:"M5 12h14"}),l.jsx("path",{d:"m12 5 7 7-7 7"})]}),back:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:l.jsx("path",{d:"m15 18-6-6 6-6"})}),flame:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:l.jsx("path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"})}),close:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),l.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]}),trash:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("polyline",{points:"3 6 5 6 21 6"}),l.jsx("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})]}),download:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),l.jsx("polyline",{points:"7 10 12 15 17 10"}),l.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),refresh:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),l.jsx("path",{d:"M21 3v5h-5"}),l.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),l.jsx("path",{d:"M8 16H3v5"})]}),edit:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:l.jsx("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})}),helpbook:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"}),l.jsx("path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"})]}),chart:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("line",{x1:"18",y1:"20",x2:"18",y2:"10"}),l.jsx("line",{x1:"12",y1:"20",x2:"12",y2:"4"}),l.jsx("line",{x1:"6",y1:"20",x2:"6",y2:"14"})]}),medal:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15"}),l.jsx("path",{d:"M11 12 5.12 2.2"}),l.jsx("path",{d:"m13 12 5.88-9.8"}),l.jsx("path",{d:"M8 7h8"}),l.jsx("circle",{cx:"12",cy:"17",r:"5"}),l.jsx("path",{d:"M12 18v-2h-.5"})]}),calendar:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:n,children:[l.jsx("rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2"}),l.jsx("line",{x1:"16",x2:"16",y1:"2",y2:"6"}),l.jsx("line",{x1:"8",x2:"8",y1:"2",y2:"6"}),l.jsx("line",{x1:"3",x2:"21",y1:"10",y2:"10"})]})})[t]||null,Ok=({content:t,fontSize:e=16,activeChunkIndex:n=-1,onSegmentClick:r=null})=>{if(!t)return null;const s=e+6,i=e+4,o=e+2,a=m=>{const y=/<details>([\s\S]*?)<\/details>/g,x=[];let w=0,g;for(;(g=y.exec(m))!==null;){g.index>w&&x.push({type:"text",content:m.slice(w,g.index)});const p=g[1],v=p.match(/<summary>(.*?)<\/summary>/s);if(v){const b=v[1].trim(),I=p.slice(v[0].length).trim();x.push({type:"details",summary:b,body:I})}w=g.index+g[0].length}return w<m.length&&x.push({type:"text",content:m.slice(w)}),x.length>0?x:[{type:"text",content:m}]};A.useEffect(()=>{if(n>=0){const m=document.getElementById(`tts-segment-${n}`);if(m){const y=m.getBoundingClientRect(),x=window.innerHeight;y.top>x*.3&&y.bottom<x*.7||m.scrollIntoView({behavior:"smooth",block:"center"})}}},[n]);let c=0;const u=m=>{if(typeof m!="string")return m;const y=/\[\[VERSE:(\d+)\]\]/g,x=[];let w=0,g;for(;(g=y.exec(m))!==null;){g.index>w&&x.push(m.slice(w,g.index));const p=g[1];x.push(l.jsx("span",{className:"inline-flex items-center justify-center bg-slate-100 text-slate-500 font-bold rounded-sm px-1 mr-1 text-[0.7em] align-middle select-none border border-slate-200 shadow-sm",style:{lineHeight:"1",verticalAlign:"text-top",marginTop:"2px"},children:p},`verse-${p}-${g.index}`)),w=g.index+g[0].length}return w<m.length&&x.push(m.slice(w)),x.length>0?x:m},d=(m,y=!1)=>{if(!r)return u(m);let x=m;return x=x.replace(/^#+\s*/,""),x.split(/([.?!])/g).reduce((g,p)=>[".","?","!"].indexOf(p)!==-1?(g.length>0&&(g[g.length-1]+=p),g):(p.trim().length>0&&g.push(p),g),[]).map((g,p)=>{const v=c++,b=n===v;return l.jsx("span",{id:`tts-segment-${v}`,onClick:()=>r(v),className:`transition-all duration-300 cursor-pointer rounded px-0.5 font-normal ${b?"bg-yellow-300 text-slate-900 font-bold shadow-sm":"hover:bg-slate-100"}`,title:"  ",children:u(g)},v)})},h=(m,y,x)=>{const w=m.trim();if(w.startsWith("# ")){const p=c++;return l.jsx("h1",{id:`tts-segment-${p}`,onClick:()=>r&&r(p),className:`font-bold text-slate-800 ${y?"mt-0":"mt-8"} mb-3 cursor-pointer ${n===p?"bg-yellow-200":""}`,style:{fontSize:`${s}px`},children:w.slice(2)},x)}if(w.startsWith("## ")){const p=c++;return l.jsx("h2",{id:`tts-segment-${p}`,onClick:()=>r&&r(p),className:`font-bold text-slate-800 ${y?"mt-0":"mt-6"} mb-2 cursor-pointer ${n===p?"bg-yellow-200":""}`,style:{fontSize:`${i}px`},children:w.slice(3)},x)}if(w.startsWith("### ")){const p=c++;return l.jsx("h3",{id:`tts-segment-${p}`,onClick:()=>r&&r(p),className:`font-bold text-slate-800 ${y?"mt-0":"mt-4"} mb-1 border-b border-slate-200 pb-1 cursor-pointer ${n===p?"bg-yellow-200":""}`,style:{fontSize:`${o}px`},children:w.slice(4)},x)}if(w.startsWith(" ")||w.startsWith("- "))return l.jsx("li",{className:"list-disc list-outside ml-6 text-slate-700 leading-relaxed mb-1 font-normal",style:{fontSize:`${e}px`},children:d(w.slice(2),!0)},x);if(w.startsWith("> "))return l.jsx("blockquote",{className:"border-l-4 border-blue-300 pl-3 italic text-slate-600 my-2 bg-slate-50 p-2 rounded",style:{fontSize:`${e}px`},children:d(w.slice(2))},x);const g=w.match(/^(\d+)([\s.]\s?)(?!||||)(.*)/);if(g){const p=g[1];g[2];const v=g[3];return l.jsxs("p",{className:"text-slate-700 leading-relaxed mb-3 flex items-start gap-2",style:{fontSize:`${e}px`,textAlign:"justify"},children:[l.jsx("span",{className:"font-bold text-blue-500 shrink-0 mt-1",style:{fontSize:`${Math.max(10,e-4)}px`},children:p}),l.jsx("span",{className:"font-normal",children:d(v,!1)})]},x)}return w===""?l.jsx("div",{className:"h-1"},x):l.jsx("p",{className:"text-slate-700 leading-relaxed mb-3 font-normal",style:{fontSize:`${e}px`,textAlign:"justify"},children:d(m,!1)},x)},f=a(t);return l.jsx("div",{className:"markdown-body",children:f.map((m,y)=>m.type==="details"?l.jsxs("details",{className:"my-2 border border-slate-200 rounded-xl bg-slate-50 overflow-hidden shadow-sm",children:[l.jsx("summary",{className:"cursor-pointer px-4 py-3 font-bold text-slate-700 hover:bg-slate-100 transition-colors",style:{fontSize:`${e}px`},children:m.summary}),l.jsx("div",{className:"px-4 py-3 space-y-1 border-t border-slate-100 bg-white",children:m.body.split(`
`).map((x,w)=>h(x,!1,`details-${y}-line-${w}`))})]},`details-${y}`):m.content.split(`
`).map((x,w)=>h(x,y===0&&w===0,`text-${y}-line-${w}`)))})},iL=({loginTab:t,setLoginTab:e,loginName:n,setLoginName:r,loginPw:s,setLoginPw:i,signupName:o,setSignupName:a,signupBirthdate:c,setSignupBirthdate:u,signupPw:d,setSignupPw:h,signupPwConfirm:f,setSignupPwConfirm:m,errorMsg:y,handleLogin:x})=>l.jsxs("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-6 relative",children:[l.jsx("div",{className:"absolute top-4 right-4",children:l.jsx("button",{onClick:()=>{r("admin"),i("")},className:"text-xs text-slate-300 hover:text-slate-500",children:""})}),l.jsxs("div",{className:"bg-white p-8 rounded-3xl shadow-xl w-full max-w-lg border border-slate-100",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"text-4xl mb-2",children:""}),l.jsx("h1",{className:"text-2xl font-extrabold text-slate-800",children:"  "}),l.jsx("p",{className:"text-slate-400 text-sm mt-2",children:"  !"})]}),l.jsxs("div",{className:"flex gap-2 mb-6",children:[l.jsx("button",{type:"button",onClick:()=>e("login"),className:`flex-1 py-3 rounded-xl font-bold transition-all ${t==="login"?"bg-blue-600 text-white shadow-lg":"bg-slate-100 text-slate-400 hover:bg-slate-200"}`,children:""}),l.jsx("button",{type:"button",onClick:()=>e("signup"),className:`flex-1 py-3 rounded-xl font-bold transition-all ${t==="signup"?"bg-blue-600 text-white shadow-lg":"bg-slate-100 text-slate-400 hover:bg-slate-200"}`,children:""})]}),t==="login"?l.jsxs("form",{onSubmit:x,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 ml-1",children:""}),l.jsx("input",{type:"text",value:n,onChange:w=>r(w.target.value),className:"w-full bg-slate-50 border border-slate-200 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 ml-1",children:""}),l.jsx("input",{type:"password",value:s,onChange:w=>i(w.target.value),className:"w-full bg-slate-50 border border-slate-200 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"6  "})]}),l.jsx("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100",children:l.jsxs("p",{className:"text-xs text-red-600 font-bold break-keep text-center",children:["  ? ",l.jsx("br",{})," ",l.jsx("span",{className:"underline",children:""})," .",l.jsx("br",{}),"(: )"]})}),y&&l.jsx("p",{className:"text-red-500 text-xs text-center",children:y}),l.jsx("button",{type:"submit",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-200 transition-all active:scale-95 mt-4",children:""}),l.jsx("p",{className:"text-xs text-slate-400 text-center mt-3",children:"    ."})]}):l.jsxs("form",{onSubmit:x,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 ml-1",children:""}),l.jsx("input",{type:"text",value:o,onChange:w=>a(w.target.value),className:"w-full bg-slate-50 border border-slate-200 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 ml-1",children:""}),l.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",maxLength:"8",value:c,onChange:w=>{const g=w.target.value.replace(/[^0-9]/g,"");u(g)},className:"w-full bg-slate-50 border border-slate-200 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg tracking-wider",placeholder:"19500101",required:!0}),l.jsx("p",{className:"text-[10px] text-slate-400 mt-1 ml-1",children:"8   (: 19500101)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 ml-1",children:""}),l.jsx("input",{type:"password",value:d,onChange:w=>h(w.target.value),className:"w-full bg-slate-50 border border-slate-200 rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"6 ",required:!0,minLength:6})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1 ml-1",children:" "}),l.jsx("input",{type:"password",value:f,onChange:w=>m(w.target.value),className:`w-full bg-slate-50 border rounded-xl p-3 focus:outline-none focus:ring-2 ${f&&d!==f?"border-red-300 focus:ring-red-500":"border-slate-200 focus:ring-blue-500"}`,placeholder:"  ",required:!0}),f&&d!==f&&l.jsx("p",{className:"text-xs text-red-500 mt-1 ml-1",children:"   "})]}),l.jsx("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100",children:l.jsx("p",{className:"text-xs text-blue-600 font-bold break-keep text-center",children:"    "})}),y&&l.jsx("p",{className:"text-red-500 text-xs text-center",children:y}),l.jsx("button",{type:"submit",disabled:d!==f||!o||!c||!d,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-200 transition-all active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:""})]})]})]}),oL=({handleLogout:t,downloadCSV:e,adminViewMode:n,setAdminViewMode:r,adminFilter:s,setAdminFilter:i,adminSortBy:o,setAdminSortBy:a,allUsers:c,MOCK_COMMUNITIES:u,BIBLE_VERSIONS:d,announcementInput:h,setAnnouncementInput:f,saveAnnouncement:m,generateMemosCSV:y,generateMemosHTML:x,editingUser:w,setEditingUser:g,startEditUser:p,saveEditUser:v,changingPassword:b,setChangingPassword:I,newPassword:_,setNewPassword:N,changePassword:C,deleteUser:R,lastSyncInfo:j,setLastSyncInfo:W,syncProgress:Q,setSyncProgress:te,selectedSyncVersions:Z,setSelectedSyncVersions:Re,syncNotionToFirestore:Le,adminStats:ke,db:V})=>l.jsx("div",{className:"min-h-screen bg-slate-100 p-4",children:l.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"  "}),l.jsx("button",{onClick:t,className:"text-sm bg-slate-200 px-3 py-2 rounded hover:bg-slate-300",children:""})]}),l.jsxs("button",{onClick:e,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-bold",children:[l.jsx(pe,{name:"download",size:18})," CSV "]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[l.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:[l.jsx(pe,{name:"chart",size:20,className:"text-blue-500"}),"    (",new Date().toLocaleDateString("ko-KR"),")"]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-blue-600",children:ke.totalUsers}),l.jsx("div",{className:"text-xs text-slate-500",children:" "})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-xl text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-green-600",children:ke.readToday}),l.jsx("div",{className:"text-xs text-slate-500",children:"  "})]}),l.jsxs("div",{className:"bg-orange-50 p-4 rounded-xl text-center",children:[l.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[ke.readRate,"%"]}),l.jsx("div",{className:"text-xs text-slate-500",children:" "})]})]}),l.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:"   "}),l.jsx("div",{className:"space-y-2",children:Object.keys(ke.communityStats).map(function(T){var S=ke.communityStats[T];return l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-20 text-sm font-bold text-slate-600",children:S.name}),l.jsx("div",{className:"flex-1 h-4 bg-slate-100 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:S.rate+"%"}})}),l.jsxs("div",{className:"text-sm text-slate-500 w-28 text-right",children:[S.readToday,"/",S.total," (",S.rate,"%)"]})]},T)})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:"  "}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>r("today"),className:`text-xs px-3 py-1 rounded-full font-bold ${n==="today"?"bg-red-500 text-white":"bg-slate-100 text-slate-500"}`,children:" "}),l.jsx("button",{onClick:()=>r("inactive"),className:`text-xs px-3 py-1 rounded-full font-bold ${n==="inactive"?"bg-orange-500 text-white":"bg-slate-100 text-slate-500"}`,children:" "})]})]}),l.jsxs("div",{className:"flex gap-2 mb-4 flex-wrap",children:[l.jsx("button",{onClick:()=>i("all"),className:`text-xs px-3 py-1.5 rounded-lg font-bold border ${s==="all"?"bg-blue-500 text-white border-blue-500":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:""}),u.map(T=>l.jsx("button",{onClick:()=>i(T.id),className:`text-xs px-3 py-1.5 rounded-lg font-bold border ${s===T.id?"bg-blue-500 text-white border-blue-500":"bg-white text-slate-600 border-slate-200 hover:border-blue-300"}`,children:T.name},T.id))]}),l.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:(()=>{const T=new Date().toDateString(),S=new Date;let O=s==="all"?c:c.filter(B=>B.communityId===s);if(n==="today"){const B=O.filter(oe=>oe.lastReadDate!==T),M={};B.forEach(oe=>{const ge=oe.communityId||"none";M[ge]||(M[ge]={});const yt=oe.subgroupId||"";M[ge][yt]||(M[ge][yt]=[]),M[ge][yt].push(oe)});const X=[];u.forEach(oe=>{const ge=M[oe.id];ge&&oe.subgroups.forEach(yt=>{ge[yt]&&X.push([yt,ge[yt]])})}),Object.keys(M).forEach(function(oe){var ge=M[oe];ge.&&X.push(["",ge.])});const me=B.length;return l.jsxs("div",{children:[l.jsxs("div",{className:"mb-3 text-sm text-slate-500",children:[" ",l.jsxs("strong",{className:"text-red-600",children:[me,""]}),"    ."]}),X.length>0?X.map(([oe,ge])=>l.jsxs("div",{className:"mb-4 bg-slate-50 p-3 rounded-lg",children:[l.jsxs("div",{className:"text-sm font-bold text-slate-700 mb-2 flex justify-between",children:[l.jsxs("span",{children:[" ",oe]}),l.jsxs("span",{className:"text-red-500",children:[ge.length,""]})]}),l.jsx("div",{className:"flex flex-wrap gap-1",children:ge.map((yt,qr)=>{const ya=yt.lastReadDate?new Date(yt.lastReadDate):null,pr=ya?Math.floor((S-ya)/(1e3*60*60*24)):999;return l.jsxs("span",{className:`text-xs px-2 py-1 rounded-full border ${pr>=7?"bg-red-100 text-red-700 border-red-200":pr>=3?"bg-orange-100 text-orange-700 border-orange-200":"bg-yellow-50 text-yellow-700 border-yellow-200"}`,children:[l.jsxs("span",{className:"font-mono text-[10px] opacity-60 mr-1",children:[qr+1,"."]}),yt.name," ",pr>0&&l.jsxs("span",{className:"opacity-70",children:["(",pr,")"]})]},yt.uid)})})]},oe)):l.jsxs("div",{className:"text-center py-8 text-green-600",children:[l.jsx("div",{className:"text-4xl mb-2",children:""}),l.jsx("p",{className:"font-bold",children:" !"})]})]})}else{const B=O.map(M=>{const X=M.lastReadDate?new Date(M.lastReadDate):null,me=X?Math.floor((S-X)/(1e3*60*60*24)):999;return{...M,daysSince:me}}).filter(M=>M.daysSince>=1).sort((M,X)=>{if(o==="name")return M.name.localeCompare(X.name);if(o==="day"){const me=((M.readCount||1)-1)*365+(M.currentDay||1);return((X.readCount||1)-1)*365+(X.currentDay||1)-me}else{if(o==="score")return(X.score||0)-(M.score||0);if(o==="subgroup"){const me=M.communityName||"",oe=X.communityName||"",ge=me.localeCompare(oe,"ko-KR");if(ge!==0)return ge;const yt=M.subgroupId||"",qr=X.subgroupId||"";return yt.localeCompare(qr,"ko-KR")}else return X.daysSince-M.daysSince}});return l.jsxs("div",{children:[l.jsx("div",{className:"mb-3 flex gap-2",children:["name","day","score","subgroup"].map(M=>l.jsx("button",{onClick:()=>a(M),className:`text-xs px-3 py-1.5 rounded-lg font-bold ${o===M?"bg-blue-500 text-white":"bg-slate-100 text-slate-600"}`,children:M==="name"?"":M==="day"?"":M==="score"?"":""},M))}),B.length>0?l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-slate-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-center text-xs font-bold text-slate-600 w-10",children:"#"}),l.jsx("th",{className:"px-3 py-2 text-left text-xs font-bold text-slate-600",children:""}),l.jsx("th",{className:"px-3 py-2 text-left text-xs font-bold text-slate-600",children:""}),l.jsx("th",{className:"px-3 py-2 text-center text-xs font-bold text-slate-600",children:"  "}),l.jsx("th",{className:"px-3 py-2 text-center text-xs font-bold text-slate-600",children:""})]})}),l.jsx("tbody",{children:B.slice(0,50).map((M,X)=>l.jsxs("tr",{className:`border-b ${M.daysSince>=14?"bg-red-50":M.daysSince>=7?"bg-orange-50":""}`,children:[l.jsx("td",{className:"px-3 py-2 text-center text-xs text-slate-400 font-mono",children:X+1}),l.jsx("td",{className:"px-3 py-2 font-bold text-slate-800",children:M.name}),l.jsx("td",{className:"px-3 py-2 text-slate-500 text-xs",children:M.subgroupId||"-"}),l.jsx("td",{className:"px-3 py-2 text-center",children:l.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-bold ${M.daysSince>=14?"bg-red-500 text-white":M.daysSince>=7?"bg-orange-500 text-white":"bg-yellow-400 text-yellow-900"}`,children:M.daysSince===999?"":`${M.daysSince}`})}),l.jsx("td",{className:"px-3 py-2 text-center text-xs",children:(()=>{const me=M.readCount||1,oe=M.currentDay||1,ge=(me-1)*365+oe;return me>1?l.jsxs("div",{className:"flex items-center justify-center gap-1",children:[l.jsxs("span",{className:"font-bold text-slate-700",children:["DAY ",ge]}),l.jsxs("span",{className:"px-1.5 py-0.5 bg-gradient-to-br from-purple-500 to-purple-700 text-white text-[10px] font-bold rounded-full",children:[me,""]})]}):l.jsxs("span",{className:"font-bold text-slate-700",children:["DAY ",oe]})})()})]},M.uid))})]}):l.jsxs("div",{className:"text-center py-8 text-green-600",children:[l.jsx("div",{className:"text-4xl mb-2",children:""}),l.jsx("p",{className:"font-bold",children:"  !"})]}),B.length>50&&l.jsxs("div",{className:"mt-2 text-center text-xs text-slate-400",children:[" 50  ( ",B.length,")"]})]})}})()}),l.jsxs("div",{className:"mt-4 pt-3 border-t border-slate-100 flex gap-4 text-xs text-slate-500",children:[l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-3 h-3 bg-yellow-400 rounded"})," 1-2"]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-3 h-3 bg-orange-500 rounded"})," 3-6"]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-3 h-3 bg-red-500 rounded"})," 7+"]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[l.jsxs("h2",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:["    (",c.filter(T=>T.currentDay>=365||(T.readCount||1)>=2).length,")"]}),(()=>{const T=c.filter(S=>S.currentDay>=365||(S.readCount||1)>=2).sort((S,O)=>(O.score||0)-(S.score||0));return T.length>0?l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:T.map((S,O)=>{const B=S.readCount||1;return l.jsxs("div",{className:`p-4 rounded-xl text-center border-2 ${O===0?"bg-yellow-50 border-yellow-300":O===1?"bg-slate-50 border-slate-300":O===2?"bg-orange-50 border-orange-300":"bg-white border-slate-100"}`,children:[l.jsx("div",{className:"text-2xl mb-1",children:O===0?"":O===1?"":O===2?"":""}),l.jsxs("div",{className:"font-bold text-slate-800 flex items-center justify-center gap-1",children:[S.name,B>=2&&l.jsxs("span",{className:"text-[10px] bg-purple-500 text-white px-1.5 py-0.5 rounded-full font-bold",children:[B,""]})]}),l.jsxs("div",{className:"text-xs text-slate-500",children:[S.score||0,""]}),l.jsxs("div",{className:"text-[10px] text-slate-400",children:[S.communityName," ",S.subgroupId]})]},S.uid)})}):l.jsxs("div",{className:"text-center py-8 text-slate-400",children:[l.jsx("div",{className:"text-4xl mb-2",children:""}),l.jsx("p",{children:"  ."}),l.jsx("p",{className:"text-xs mt-1",children:"365    !"})]})})()]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[l.jsx("h2",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:" / "}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-slate-600 mb-1",children:" "}),l.jsx("textarea",{value:h.text,onChange:T=>f(S=>({...S,text:T.target.value})),placeholder:":     !",className:"w-full p-3 border rounded-lg text-sm resize-none focus:ring-2 focus:ring-blue-500 outline-none",rows:3})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("label",{className:"text-sm font-bold text-slate-600",children:"  "}),l.jsxs("button",{onClick:()=>f(T=>({...T,links:[...T.links||[],{url:"",text:""}]})),className:"text-xs bg-blue-50 text-blue-600 px-3 py-1.5 rounded-lg font-bold hover:bg-blue-100 flex items-center gap-1",children:[l.jsx(pe,{name:"plus",size:12}),"  "]})]}),(h.links||[]).map((T,S)=>l.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl relative group border border-slate-100",children:[l.jsx("button",{onClick:()=>f(O=>({...O,links:O.links.filter((B,M)=>M!==S)})),className:"absolute -top-2 -right-2 bg-white text-red-500 p-1.5 rounded-full shadow-md border border-red-100 hover:bg-red-50 transition-colors",children:l.jsx(pe,{name:"trash",size:14})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-[10px] font-bold text-slate-400 mb-1 uppercase",children:" "}),l.jsx("input",{type:"text",value:T.text,onChange:O=>{const B=[...h.links];B[S].text=O.target.value,f(M=>({...M,links:B}))},placeholder:": , ",className:"w-full p-2 border rounded-lg text-sm bg-white"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-[10px] font-bold text-slate-400 mb-1 uppercase",children:"  (URL)"}),l.jsx("input",{type:"url",value:T.url,onChange:O=>{const B=[...h.links];B[S].url=O.target.value,f(M=>({...M,links:B}))},placeholder:"https://...",className:"w-full p-2 border rounded-lg text-sm bg-white"})]})]})]},S))]}),l.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-slate-100",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:h.enabled,onChange:T=>f(S=>({...S,enabled:T.target.checked})),className:"w-5 h-5 rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),l.jsx("span",{className:"text-sm font-bold text-slate-600",children:" "})]}),l.jsx("button",{onClick:m,className:"bg-blue-600 text-white px-8 py-2.5 rounded-xl font-bold hover:bg-blue-700 shadow-lg shadow-blue-200 transition-all active:scale-95",children:""})]}),h.text&&l.jsxs("div",{className:"mt-4 p-4 bg-slate-50 rounded-xl border-2 border-dashed border-slate-300",children:[l.jsx("p",{className:"text-xs text-slate-400 mb-3 font-bold uppercase tracking-wider",children:" "}),l.jsx("div",{className:"bg-white border-2 border-slate-100 rounded-3xl p-8 shadow-sm",children:l.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[l.jsx("div",{className:"flex-shrink-0 w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center text-4xl shadow-inner border border-slate-100",children:""}),l.jsxs("div",{className:"flex-1 min-w-0 text-center md:text-left",children:[l.jsx("p",{className:"text-[18px] text-slate-900 font-bold whitespace-pre-wrap leading-snug",children:h.text}),l.jsx("div",{className:"flex flex-wrap justify-center md:justify-start gap-3 mt-6",children:(h.links||[]).map((T,S)=>T.text&&l.jsx("div",{className:"bg-[#03C75A] text-white px-8 py-3 rounded-2xl text-[16px] font-black shadow-md",children:T.text},S))})]})]})})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-lg font-bold text-slate-800 flex items-center gap-2",children:"  "}),l.jsxs("button",{onClick:y,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 font-bold text-sm",children:[l.jsx(pe,{name:"download",size:16}),"  CSV "]})]}),(()=>{const T=c.filter(O=>O.memos&&Object.keys(O.memos||{}).length>0),S=c.reduce((O,B)=>O+Object.keys(B.memos||{}).length,0);return l.jsxs("div",{children:[l.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{className:"bg-purple-50 p-4 rounded-xl text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:S}),l.jsx("div",{className:"text-xs text-slate-500",children:"  "})]}),l.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl text-center",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:T.length}),l.jsx("div",{className:"text-xs text-slate-500",children:" "})]}),l.jsxs("div",{className:"bg-green-50 p-4 rounded-xl text-center",children:[l.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[c.length>0?Math.round(T.length/c.length*100):0,"%"]}),l.jsx("div",{className:"text-xs text-slate-500",children:""})]})]}),l.jsx("h3",{className:"font-bold text-slate-700 mb-2",children:"  TOP 10"}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:c.map(O=>({...O,memoCount:Object.keys(O.memos||{}).length})).filter(O=>O.memoCount>0).sort((O,B)=>B.memoCount-O.memoCount).slice(0,10).map((O,B)=>l.jsxs("div",{className:"flex items-center justify-between bg-slate-50 p-3 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${B===0?"bg-yellow-400 text-white":B===1?"bg-slate-400 text-white":B===2?"bg-orange-400 text-white":"bg-slate-200 text-slate-600"}`,children:B+1}),l.jsxs("div",{children:[l.jsx("span",{className:"font-bold text-slate-800",children:O.name}),l.jsx("span",{className:"text-xs text-slate-400 ml-2",children:O.subgroupId})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-sm font-bold text-purple-600",children:[O.memoCount,""]}),l.jsx("button",{onClick:()=>x(O.name,O.memos||{},{currentDay:O.currentDay,score:O.score,streak:O.streak}),className:"text-xs bg-indigo-100 text-indigo-600 px-2 py-1 rounded hover:bg-indigo-200",children:"HTML"})]})]},O.uid))})]})})()]}),w&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl space-y-4",children:[l.jsxs("h3",{className:"font-bold text-lg border-b pb-2",children:["   (",w.name,")"]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:" "}),l.jsx("select",{value:w.communityId,onChange:T=>{const S=u.find(O=>O.id===T.target.value);g({...w,communityId:S.id,communityName:S.name,subgroupId:S.subgroups[0]})},className:"w-full border rounded p-2 text-sm",children:u.map(T=>l.jsx("option",{value:T.id,children:T.name},T.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:""}),l.jsx("select",{value:w.subgroupId,onChange:T=>g({...w,subgroupId:T.target.value}),className:"w-full border rounded p-2 text-sm",children:(()=>{const T=u.find(S=>S.id===w.communityId);return T?T.subgroups.map(S=>l.jsx("option",{value:S,children:S},S)):null})()})]}),l.jsxs("div",{className:"flex gap-2 pt-4",children:[l.jsx("button",{onClick:v,className:"flex-1 bg-blue-600 text-white py-2 rounded hover:bg-blue-700",children:""}),l.jsx("button",{onClick:()=>g(null),className:"flex-1 bg-slate-200 text-slate-600 py-2 rounded hover:bg-slate-300",children:""})]})]})}),b&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:()=>I(null),children:l.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md shadow-2xl",onClick:T=>T.stopPropagation(),children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-4 border-b pb-2",children:"  "}),l.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg mb-4",children:[l.jsxs("p",{className:"text-sm text-blue-700",children:[l.jsx("strong",{children:b.name}),"  ."]}),l.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[" : ",b.password]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-bold text-slate-600 mb-2",children:"  (6 )"}),l.jsx("input",{type:"text",value:_,onChange:T=>N(T.target.value),placeholder:"123456",className:"w-full border border-slate-300 rounded-lg p-3 text-lg font-mono focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),l.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"    "})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>C(b.uid,b.name,b.password),disabled:!_||_.length<6,className:"flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed font-bold",children:" "}),l.jsx("button",{onClick:()=>{I(null),N("")},className:"flex-1 bg-slate-200 text-slate-600 py-3 rounded-lg hover:bg-slate-300 font-bold",children:""})]})]})}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"   "}),l.jsx("div",{className:"flex gap-2",children:["name","day","score","subgroup"].map(T=>l.jsx("button",{onClick:()=>a(T),className:`text-xs px-3 py-1.5 rounded-lg font-bold ${o===T?"bg-blue-500 text-white":"bg-slate-100 text-slate-600"}`,children:T==="name"?"":T==="day"?"":T==="score"?"":""},T))})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm text-left text-slate-600",children:[l.jsx("thead",{className:"text-xs text-slate-700 uppercase bg-slate-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-3 text-center w-10",children:"#"}),l.jsx("th",{className:"px-3 py-3",children:""}),l.jsx("th",{className:"px-3 py-3",children:"/"}),l.jsx("th",{className:"px-3 py-3 text-center",children:"Day"}),l.jsx("th",{className:"px-3 py-3 text-center",children:""}),l.jsx("th",{className:"px-3 py-3 text-center",children:""}),l.jsx("th",{className:"px-3 py-3 text-center",children:""})]})}),l.jsx("tbody",{children:(()=>[...c].sort((S,O)=>{if(o==="name")return S.name.localeCompare(O.name);if(o==="day"){const B=((S.readCount||1)-1)*365+(S.currentDay||1);return((O.readCount||1)-1)*365+(O.currentDay||1)-B}if(o==="score")return(O.score||0)-(S.score||0);if(o==="subgroup"){const B=(S.communityName||"").localeCompare(O.communityName||"","ko-KR");return B!==0?B:(S.subgroupId||"").localeCompare(O.subgroupId||"","ko-KR")}return 0}).map((S,O)=>{const B=S.lastReadDate===new Date().toDateString(),M=S.readCount||1,X=S.currentDay||1,me=(M-1)*365+X;return l.jsxs("tr",{className:`border-b hover:bg-slate-50 ${B?"bg-green-50":""}`,children:[l.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-400 font-mono italic",children:O+1}),l.jsxs("td",{className:"px-3 py-3 font-medium text-slate-900",children:[S.name,B&&l.jsx("span",{className:"ml-1 text-green-500",children:""})]}),l.jsxs("td",{className:"px-3 py-3",children:[l.jsx("span",{className:"font-bold",children:S.communityName}),l.jsx("span",{className:"text-xs text-slate-400 block",children:S.subgroupId})]}),l.jsx("td",{className:"px-3 py-3 text-center",children:M>1?l.jsxs("div",{className:"flex items-center justify-center gap-1",children:[l.jsxs("span",{className:"font-bold text-blue-600",children:["DAY ",me]}),l.jsxs("span",{className:"px-1.5 py-0.5 bg-gradient-to-br from-purple-500 to-purple-700 text-white text-[10px] font-bold rounded-full",children:[M,""]})]}):l.jsxs("span",{className:"font-bold text-blue-600",children:["DAY ",X]})}),l.jsx("td",{className:"px-3 py-3 text-center",children:S.score}),l.jsx("td",{className:"px-3 py-3 text-center text-xs text-slate-400",children:S.lastReadDate?new Date(S.lastReadDate).toLocaleDateString("ko-KR"):"-"}),l.jsx("td",{className:"px-3 py-3 text-center",children:l.jsxs("div",{className:"flex justify-center gap-1",children:[l.jsx("button",{onClick:()=>I(S),className:"text-purple-500 hover:text-purple-700 p-1 bg-purple-50 rounded",title:" ",children:l.jsx(pe,{name:"refresh",size:14})}),l.jsx("button",{onClick:()=>p(S),className:"text-blue-500 hover:text-blue-700 p-1 bg-blue-50 rounded",title:" ",children:l.jsx(pe,{name:"edit",size:14})}),l.jsx("button",{onClick:()=>R(S.uid,S.name),className:"text-red-500 hover:text-red-700 p-1 bg-red-50 rounded",title:"",children:l.jsx(pe,{name:"trash",size:14})})]})})]},O)}))()})]})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[l.jsx("h2",{className:"text-lg font-bold text-slate-800 mb-4 flex items-center gap-2",children:"   "}),l.jsx("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-200 mb-4",children:l.jsxs("p",{className:"text-sm text-blue-700",children:["   Firestore  ",l.jsx("strong",{children:"  10 "})," .",l.jsx("br",{}),"     ."]})}),j&&l.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg mb-4 text-sm",children:[l.jsxs("p",{className:"text-slate-600",children:[" : ",j.lastSyncAt&&j.lastSyncAt.toDate?j.lastSyncAt.toDate().toLocaleString("ko-KR"):" "]}),l.jsxs("p",{className:"text-slate-500 text-xs",children:[": ",j.successCount||0," / : ",j.errorCount||0,""]}),j.syncedVersions&&l.jsxs("p",{className:"text-slate-400 text-xs mt-1",children:[" : ",j.syncedVersions.join(", ")]}),j.failedItems&&j.failedItems.length>0&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-200",children:[l.jsxs("p",{className:"text-red-600 text-xs font-bold mb-2",children:["   (",j.failedItems.length,"):"]}),l.jsx("div",{className:"max-h-32 overflow-y-auto bg-white rounded p-2 text-xs",children:j.failedItems.map((T,S)=>l.jsxs("div",{className:"text-red-500 py-0.5",children:[" ",T.versionName," Day ",T.day," (",T.date,") - ",T.error]},S))})]})]}),Q?l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-200",children:[l.jsxs("p",{className:"text-sm font-bold text-amber-700 mb-2",children:["   ... (",Q.current,"/",Q.total,")"]}),Q.status&&l.jsx("p",{className:"text-xs text-amber-800 mb-2 font-medium",children:Q.status}),Q.currentVersion&&l.jsxs("p",{className:"text-xs text-amber-600 mb-2",children:[": ",Q.currentVersion," ",Q.currentDay>0&&`- Day ${Q.currentDay}`]}),l.jsx("div",{className:"w-full bg-amber-200 rounded-full h-3",children:l.jsx("div",{className:"bg-amber-500 h-3 rounded-full transition-all",style:{width:`${Q.current/Q.total*100}%`}})}),l.jsxs("p",{className:"text-xs text-amber-600 mt-2",children:[" : ",Q.success," /  : ",Q.error,""]})]}),l.jsx("p",{className:"text-xs text-slate-500 text-center",children:"   .  2 ."})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-slate-700 mb-2",children:"  :"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 mb-2",children:" "}),d["1year"].map(T=>{const S=`1year_${T.id}`,O=Z.indexOf(S)!==-1;return l.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:O,onChange:B=>{B.target.checked?Re([...Z,S]):Re(Z.filter(M=>M!==S))},className:"w-4 h-4 rounded"}),l.jsx("span",{className:"text-sm text-slate-700",children:T.name})]},S)})]}),l.jsxs("div",{className:"bg-slate-50 p-3 rounded-lg",children:[l.jsx("p",{className:"text-xs font-bold text-slate-500 mb-2",children:" "}),d.nt.map(T=>{const S=`nt_${T.id}`,O=Z.indexOf(S)!==-1;return l.jsxs("label",{className:"flex items-center gap-2 py-1 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:O,onChange:B=>{B.target.checked?Re([...Z,S]):Re(Z.filter(M=>M!==S))},className:"w-4 h-4 rounded"}),l.jsx("span",{className:"text-sm text-slate-700",children:T.name})]},S)})]})]})]}),l.jsx("div",{className:"bg-green-50 p-3 rounded-lg border border-green-200",children:l.jsxs("p",{className:"text-sm text-green-700",children:[": ",l.jsxs("strong",{children:[Z.length,""]})," "]})}),l.jsxs("button",{onClick:async()=>{if(Z.length===0){alert("  .");return}if(!confirm(`${Z.length}  . ?`))return;const T=Z.length*365;te({current:0,total:T,success:0,error:0,currentVersion:"",currentDay:0});const S=await Le(Z);alert(` !
: ${S.success}
: ${S.error}`);const O=await V.collection("settings").doc("sync").get();O.exists&&W(O.data())},disabled:Z.length===0,className:"w-full bg-blue-600 text-white font-bold py-4 rounded-xl hover:bg-blue-700 text-lg disabled:opacity-50",children:["    (",Z.length*365,")"]})]})]})]})}),aL=({view:t,currentUser:e,tempUser:n,setView:r,selectedPlanType:s,handlePlanTypeSelect:i,handleVersionSelect:o,handleCommunitySelect:a,handleSubgroupSelect:c})=>{if(t==="plan_type_select")return l.jsxs("div",{className:"min-h-screen bg-slate-50 p-6 flex flex-col items-center justify-center",children:[l.jsxs("div",{className:"w-full max-w-2xl mb-6",children:[e&&!n&&l.jsxs("button",{onClick:()=>r("dashboard"),className:"text-sm text-slate-400 flex items-center hover:text-slate-600 mb-4",children:[l.jsx(pe,{name:"back",size:16,className:"mr-1"}),"  "]}),l.jsx("h2",{className:"text-xl font-bold text-slate-800 text-center",children:e&&!n?"  ":`, ${n&&n.name||""}!`}),l.jsx("p",{className:"text-slate-500 text-sm text-center mt-1",children:"  ?"})]}),l.jsx("div",{className:"w-full max-w-2xl space-y-3",children:th.map(u=>l.jsxs("button",{onClick:()=>i(u.id),className:"w-full bg-white p-5 rounded-2xl border border-slate-200 shadow-sm hover:border-blue-500 hover:bg-blue-50 transition-all text-left",children:[l.jsx("div",{className:"font-bold text-slate-800 text-lg mb-1",children:u.title}),l.jsx("div",{className:"text-xs text-slate-400",children:u.desc})]},u.id))})]});if(t==="bible_version_select"){const u=gs[s],d=th.find(f=>f.id===s),h=d?d.title:null;return l.jsxs("div",{className:"min-h-screen bg-slate-50 p-6 flex flex-col items-center justify-center",children:[l.jsxs("div",{className:"w-full max-w-2xl",children:[l.jsxs("button",{onClick:()=>r("plan_type_select"),className:"text-sm text-slate-400 flex items-center hover:text-slate-600 mb-4",children:[l.jsx(pe,{name:"back",size:16,className:"mr-1"})," "]}),l.jsxs("div",{className:"text-center mb-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-slate-800",children:[h,"  "]}),l.jsx("div",{className:"bg-yellow-50 text-yellow-800 text-xs font-bold p-2 rounded-lg mt-2 break-keep",children:"    1    ."})]})]}),l.jsx("div",{className:"w-full max-w-2xl space-y-3",children:u.map(f=>l.jsxs("button",{onClick:()=>o(f.id),className:"w-full bg-white p-5 rounded-2xl border border-slate-200 shadow-sm hover:border-blue-500 hover:bg-blue-50 transition-all text-left",children:[l.jsx("div",{className:"font-bold text-slate-800 text-lg mb-1",children:f.name}),l.jsx("div",{className:"text-xs text-slate-400",children:f.desc})]},f.id))})]})}if(t==="community_select")return l.jsxs("div",{className:"min-h-screen bg-slate-50 p-6 flex flex-col items-center justify-center",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"  "}),l.jsx("p",{className:"text-slate-500 text-sm",children:"   ?"})]}),l.jsx("div",{className:"w-full max-w-2xl space-y-3",children:Lr.map(u=>l.jsxs("button",{onClick:()=>a(u.id,u.name),className:"w-full bg-white p-4 rounded-2xl shadow-sm border border-slate-200 hover:border-blue-500 hover:bg-blue-50 transition-all flex items-center gap-4 text-left",children:[l.jsx("div",{className:"w-12 h-12 rounded-full flex items-center justify-center text-2xl",children:u.icon}),l.jsx("div",{className:"flex-1",children:l.jsx("div",{className:"font-bold text-slate-800 text-lg",children:u.name})}),l.jsx(pe,{name:"arrowRight",className:"text-slate-300"})]},u.id))})]});if(t==="subgroup_select"){const u=Lr.find(d=>d.id===(n?n.communityId:null));return l.jsxs("div",{className:"min-h-screen bg-slate-50 p-6 flex flex-col items-center justify-center",children:[l.jsx("div",{className:"w-full max-w-2xl mb-4",children:l.jsxs("button",{onClick:()=>r("community_select"),className:"text-sm text-slate-400 flex items-center hover:text-slate-600",children:[l.jsx(pe,{name:"back",size:16,className:"mr-1"})," "]})}),l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-slate-800",children:" "}),l.jsxs("p",{className:"text-slate-500 text-sm",children:[n?n.communityName:"","   ."]})]}),l.jsx("div",{className:"w-full max-w-2xl grid grid-cols-2 gap-3 h-[50vh] overflow-y-auto content-start",children:u&&u.subgroups.map((d,h)=>l.jsxs("button",{onClick:()=>c(d),className:"bg-white p-4 rounded-xl shadow-sm border border-slate-200 hover:border-blue-500 hover:bg-blue-50 transition-all text-center flex flex-col items-center justify-center aspect-video",children:[l.jsx("span",{className:"text-2xl mb-2 opacity-80",children:""}),l.jsx("span",{className:"font-bold text-slate-700 text-sm",children:d})]},h))})]})}return null},lL=({show:t,onClose:e,myLevel:n,score:r})=>t?l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:s=>{s.target===s.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",onClick:s=>s.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold",children:"  &  "}),l.jsx("button",{onClick:e,className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsxs("div",{className:"space-y-4 overflow-y-auto max-h-[60vh]",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-blue-600 mb-1",children:" "}),l.jsxs("div",{className:"flex items-center gap-3 bg-blue-50 p-3 rounded-xl border border-blue-100",children:[l.jsx("div",{className:"text-3xl",children:n.emoji}),l.jsxs("div",{children:[l.jsx("div",{className:"font-bold text-lg",children:n.title}),l.jsxs("div",{className:"text-xs text-slate-500",children:[" ",r,""]})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-slate-700 mb-1",children:"  "}),l.jsxs("ul",{className:"text-sm text-slate-600 space-y-1 list-disc pl-4",children:[l.jsxs("li",{children:["  : ",l.jsx("strong",{children:"+10"})]}),l.jsxs("li",{children:["  : ",l.jsx("strong",{children:" +1  ( +5)"})]})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-slate-700 mb-1",children:" "}),l.jsx("div",{className:"grid gap-2 text-sm",children:kg.map((s,i)=>l.jsxs("div",{className:`flex items-center gap-2 p-2 rounded ${s.title===n.title?"bg-yellow-50 border border-yellow-200":""}`,children:[l.jsx("span",{className:"text-xl",children:s.emoji}),l.jsx("span",{className:"flex-1",children:s.title}),l.jsxs("span",{className:"text-slate-400 text-xs",children:[s.min,"pt~"]})]},i))})]})]}),l.jsx("button",{onClick:e,className:"w-full bg-slate-100 font-bold py-3 rounded-xl mt-4 text-slate-600",children:""})]})}):null,cL=({show:t,onClose:e})=>t?l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:n=>{n.target===n.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",onClick:n=>n.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"  114 "}),l.jsx("button",{onClick:e,className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsx("a",{href:"https://www.bible114.net/8e616cd9-5ca0-4dd3-9e63-64280fc66f38",target:"_blank",rel:"noopener noreferrer",className:"block w-full mb-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-center py-3 rounded-xl font-bold shadow-md hover:from-blue-600 hover:to-blue-700 transition-all",children:"  114   "}),l.jsxs("div",{className:"space-y-3 overflow-y-auto max-h-[60vh] text-xs",children:[l.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100",children:[l.jsx("h4",{className:"font-bold text-blue-700 mb-2",children:"  114?"}),l.jsxs("p",{className:"text-slate-600 leading-relaxed",children:[l.jsx("strong",{children:"1 1 4 !"}),"   1 1 , 3( )        ,         ."]})]}),l.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-100",children:[l.jsx("h4",{className:"font-bold text-green-700 mb-2",children:" 1 (1-3)"}),l.jsxs("p",{className:"text-slate-600 leading-relaxed mb-1",children:[l.jsx("strong",{className:"text-green-800",children:":"}),"  1-11, , , , , , ,  1-6, , ,  7-10, , "]}),l.jsxs("p",{className:"text-slate-600 leading-relaxed",children:[l.jsx("strong",{className:"text-green-800",children:":"})," ,  1-5, , , ,  1-3"]})]}),l.jsxs("div",{className:"bg-yellow-50 p-3 rounded-lg border border-yellow-100",children:[l.jsx("h4",{className:"font-bold text-yellow-700 mb-2",children:" 2 (4-6)"}),l.jsxs("p",{className:"text-slate-600 leading-relaxed mb-1",children:[l.jsx("strong",{className:"text-yellow-800",children:":"}),"  12-26, , , ,  1-72, , , , , "]}),l.jsxs("p",{className:"text-slate-600 leading-relaxed",children:[l.jsx("strong",{className:"text-yellow-800",children:":"})," ,  6-12, , , , , , ,  4-7"]})]}),l.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg border border-orange-100",children:[l.jsx("h4",{className:"font-bold text-orange-700 mb-2",children:" 3 (7-9)"}),l.jsxs("p",{className:"text-slate-600 leading-relaxed mb-1",children:[l.jsx("strong",{className:"text-orange-800",children:":"}),"  27-36, ,  1-11, , , ,  12-22,  1-14, ,  15, , ,  16-23, ,  24-25, "]}),l.jsxs("p",{className:"text-slate-600 leading-relaxed",children:[l.jsx("strong",{className:"text-orange-800",children:":"})," ,  13-20, , , , , , ,  8-14"]})]}),l.jsxs("div",{className:"bg-red-50 p-3 rounded-lg border border-red-100",children:[l.jsx("h4",{className:"font-bold text-red-700 mb-2",children:" 4 (10-12)"}),l.jsxs("p",{className:"text-slate-600 leading-relaxed mb-1",children:[l.jsx("strong",{className:"text-red-800",children:":"}),"  37-50, ,  90, ,  73-150,  1-28, ,  29-36, , , "]}),l.jsxs("p",{className:"text-slate-600 leading-relaxed",children:[l.jsx("strong",{className:"text-red-800",children:":"})," ,  21-28, , , , , , ,  15-22"]})]}),l.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg border border-purple-100",children:[l.jsx("h4",{className:"font-bold text-purple-700 mb-1",children:"  !"}),l.jsxs("p",{className:"text-slate-600 leading-relaxed",children:["  !    . ",l.jsx("strong",{children:" "}),".  ! "]})]})]}),l.jsx("button",{onClick:e,className:"w-full bg-slate-100 font-bold py-3 rounded-xl mt-4 text-slate-600",children:""})]})}):null,uL=({show:t,onClose:e,currentUser:n})=>t?l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:r=>{r.target===r.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",onClick:r=>r.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"  "}),l.jsx("button",{onClick:e,className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsx("div",{className:"grid grid-cols-3 gap-3 overflow-y-auto max-h-[60vh]",children:Sg.map(r=>{const s=n&&n.achievements?n.achievements.indexOf(r.id)!==-1:!1;return l.jsxs("div",{className:`p-3 rounded-xl text-center border ${s?"bg-yellow-50 border-yellow-200":"bg-slate-50 border-slate-100 opacity-40"}`,children:[l.jsx("div",{className:`text-2xl mb-1 ${s?"":"grayscale"}`,children:r.emoji}),l.jsx("p",{className:"text-[10px] font-bold text-slate-700 leading-tight",children:r.title})]},r.id)})}),l.jsx("div",{className:"mt-4 bg-blue-50 p-3 rounded-xl border border-blue-100",children:l.jsxs("p",{className:"text-xs text-blue-700 text-center",children:[" : ",l.jsx("strong",{children:n&&n.achievements?n.achievements.length:0})," / ",Sg.length]})}),l.jsx("button",{onClick:e,className:"w-full bg-slate-100 font-bold py-3 rounded-xl mt-4 text-slate-600",children:""})]})}):null,dL=({show:t,onClose:e,calendarDate:n,setCalendarDate:r,readHistory:s})=>{if(!t)return null;const i=new Date,o=n.getFullYear(),a=n.getMonth(),c=new Date(o,a,1).getDay(),u=new Date(o,a+1,0).getDate(),d=["1","2","3","4","5","6","7","8","9","10","11","12"],h=["","","","","","",""],f=[];for(let b=0;b<c;b++)f.push(null);for(let b=1;b<=u;b++)f.push(b);const m=b=>typeof b=="string"?b:b.date,y=s.filter(b=>{const I=m(b),_=new Date(I);return _.getFullYear()===o&&_.getMonth()===a}).map(b=>new Date(m(b)).getDate()),x=()=>r(new Date(o,a-1,1)),w=()=>r(new Date(o,a+1,1)),g=()=>r(new Date),p=i.getFullYear()===o&&i.getMonth()===a,v=s.filter(b=>{const I=m(b);return new Date(I).getFullYear()===o}).length;return l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:b=>{b.target===b.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",onClick:b=>b.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"  "}),l.jsx("button",{onClick:e,className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsx("button",{onClick:x,className:"w-8 h-8 flex items-center justify-center rounded-full bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold",children:""}),l.jsxs("div",{className:"text-center",children:[l.jsxs("span",{className:"font-bold text-lg text-slate-700",children:[o," ",d[a]]}),!p&&l.jsx("button",{onClick:g,className:"ml-2 text-xs text-blue-500 underline",children:""})]}),l.jsx("button",{onClick:w,className:"w-8 h-8 flex items-center justify-center rounded-full bg-slate-100 hover:bg-slate-200 text-slate-600 font-bold",children:""})]}),l.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:h.map(b=>l.jsx("div",{className:`text-center text-[10px] font-bold py-1 ${b===""?"text-red-400":b===""?"text-blue-400":"text-slate-400"}`,children:b},b))}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:f.map((b,I)=>{if(!b)return l.jsx("div",{},I);const _=p&&b===i.getDate(),N=y.indexOf(b)!==-1,C=new Date(o,a,b).getDay();return l.jsxs("button",{className:`aspect-square flex flex-col items-center justify-center rounded-lg border transition-all cursor-default relative
                                            ${_?"ring-2 ring-blue-400":""}
                                            ${N?"bg-green-100 border-green-200 text-green-700":C===0?"bg-red-50 border-red-100 text-red-300":C===6?"bg-blue-50 border-blue-100 text-blue-300":"bg-slate-50 border-slate-100 text-slate-400 hover:bg-blue-50"}`,children:[l.jsx("span",{className:"text-sm font-bold",children:b}),N&&l.jsx("span",{className:"absolute top-0.5 right-0.5 text-[8px]",children:""})]},I)})}),l.jsxs("div",{className:"mt-4 flex justify-center gap-4 text-xs",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:"w-4 h-4 bg-green-100 rounded"}),l.jsx("span",{className:"text-slate-500",children:" "})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("div",{className:"w-4 h-4 bg-slate-50 rounded border"}),l.jsx("span",{className:"text-slate-500",children:"  "})]})]}),l.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[l.jsxs("div",{className:"bg-green-50 p-3 rounded-xl border border-green-100 text-center",children:[l.jsx("p",{className:"text-xs text-slate-500",children:" "}),l.jsxs("p",{className:"text-lg font-bold text-green-700",children:[y.length,""]})]}),l.jsxs("div",{className:"bg-blue-50 p-3 rounded-xl border border-blue-100 text-center",children:[l.jsxs("p",{className:"text-xs text-slate-500",children:[o," "]}),l.jsxs("p",{className:"text-lg font-bold text-blue-700",children:[v,""]})]})]})]}),l.jsx("button",{onClick:e,className:"w-full bg-slate-100 font-bold py-3 rounded-xl mt-4 text-slate-600",children:""})]})})},hL=({show:t,onClose:e})=>t?l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:n=>{n.target===n.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",onClick:n=>n.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold text-red-700",children:"   "}),l.jsx("button",{onClick:e,className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsxs("div",{className:"space-y-4 overflow-y-auto max-h-[60vh]",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-red-600 mb-2",children:"  "}),l.jsxs("div",{className:"bg-red-50 p-3 rounded-xl border border-red-100 text-sm text-slate-700 leading-relaxed",children:[l.jsxs("p",{className:"mb-2",children:[l.jsx("strong",{children:"  "})," = (    )  (  )  100"]}),l.jsx("p",{className:"text-xs text-slate-500",children:"   1       "})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-slate-700 mb-2",children:" "}),l.jsxs("div",{className:"bg-slate-50 p-3 rounded-xl border border-slate-200 text-xs space-y-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-bold text-slate-700 mb-1",children:"1 (10, 1 12 )"}),l.jsxs("ul",{className:"text-slate-600 space-y-0.5 pl-3",children:[l.jsxs("li",{children:["     : ",l.jsx("strong",{children:"100"})]}),l.jsxs("li",{children:["   : 10  12 = ",l.jsx("strong",{children:"120"})]}),l.jsxs("li",{children:["  : 100  120  100 = ",l.jsx("strong",{className:"text-red-600",children:"83%"})]})]})]}),l.jsx("div",{className:"pt-2 border-t border-slate-200",children:l.jsx("p",{className:"text-slate-500",children:"   83%     "})})]})]}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-blue-600 mb-2",children:"  ?"}),l.jsxs("ul",{className:"text-xs text-slate-600 space-y-2 pl-3",children:[l.jsxs("li",{children:[" ",l.jsx("strong",{children:"   "})," "]}),l.jsx("li",{children:"       "}),l.jsx("li",{children:"      "}),l.jsxs("li",{children:["   1   ",l.jsx("strong",{children:"   "})," "]})]})]})]}),l.jsx("button",{onClick:e,className:"w-full bg-red-100 font-bold py-3 rounded-xl mt-4 text-red-700 hover:bg-red-200 transition-colors",children:""})]})}):null,fL=({show:t,onClose:e,onRestart:n})=>t?l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:r=>{r.target===r.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",onClick:r=>r.stopPropagation(),children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("div",{className:"text-5xl mb-4",children:""}),l.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"  ?"}),l.jsxs("p",{className:"text-sm text-slate-500 leading-relaxed",children:[" (, , )",l.jsx("br",{}),l.jsx("strong",{className:"text-red-500",children:" "}),".",l.jsx("br",{})," Day 1  !"]})]}),l.jsx("div",{className:"bg-amber-50 p-3 rounded-xl border border-amber-200 mb-4",children:l.jsx("p",{className:"text-xs text-amber-700 text-center",children:"     !"})}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("button",{onClick:n,className:"w-full bg-red-500 text-white font-bold py-3 rounded-xl hover:bg-red-600 transition-colors",children:",   "}),l.jsx("button",{onClick:e,className:"w-full bg-slate-100 text-slate-600 font-bold py-3 rounded-xl hover:bg-slate-200",children:""})]})]})}):null,pL=({show:t,onClose:e,currentUser:n,currentDay:r,dateSettingsDate:s,setDateSettingsDate:i,dateToOffset:o,changeStartDate:a})=>{const[c,u]=Lp.useState(!1);if(Lp.useEffect(()=>{if(t){const w=setTimeout(()=>u(!0),300);return()=>clearTimeout(w)}else u(!1)},[t]),!t)return null;const d=s.getFullYear(),h=s.getMonth(),f=new Date(d,h,1).getDay(),m=new Date(d,h+1,0).getDate(),y=[];for(let w=0;w<f;w++)y.push(null);for(let w=1;w<=m;w++)y.push(w);const x=Mw?Mw[n?n.planId:null]:null;return l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:w=>{w.target===w.currentTarget&&c&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl overflow-y-auto max-h-[90vh] animate-in zoom-in-95 duration-200",onClick:w=>w.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"  "}),l.jsx("button",{onClick:e,className:"text-slate-400 p-1 hover:bg-slate-100 rounded-full transition-colors",children:l.jsx(pe,{name:"close"})})]}),l.jsxs("div",{className:"mb-4 bg-purple-50 p-4 rounded-xl border border-purple-100 text-center",children:[l.jsx("p",{className:"text-lg font-bold text-purple-700 leading-relaxed",children:'"    ."'}),l.jsx("p",{className:"text-[11px] text-purple-500 mt-1 opacity-80",children:"       ."})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center bg-slate-50 p-2 rounded-xl",children:[l.jsx("button",{onClick:w=>{w.stopPropagation(),i(new Date(d,h-1))},className:"p-2 hover:bg-white rounded-lg transition-colors",children:l.jsx(pe,{name:"back",size:16})}),l.jsxs("span",{className:"font-bold text-slate-700",children:[d," ",h+1,""]}),l.jsx("button",{onClick:w=>{w.stopPropagation(),i(new Date(d,h+1))},className:"p-2 hover:bg-white rounded-lg transition-colors rotate-180",children:l.jsx(pe,{name:"back",size:16})})]}),l.jsx("div",{className:"grid grid-cols-7 gap-1 text-center mb-1",children:["","","","","","",""].map((w,g)=>l.jsx("div",{className:`text-[10px] font-bold py-1 ${g===0?"text-red-400":g===6?"text-blue-400":"text-slate-400"}`,children:w},g))}),l.jsx("div",{className:"grid grid-cols-7 gap-1",children:y.map((w,g)=>{if(!w)return l.jsx("div",{},g);const p=o(h+1,w),v=x&&x[p]?x[p]:null,b=new Date().getDate()===w&&new Date().getMonth()===h,I=new Date(d,h,w).getDay();return l.jsxs("button",{onClick:_=>{_.stopPropagation();const N=p-r+1;a(N),e()},className:`group aspect-square flex flex-col items-center justify-center rounded-lg border transition-all hover:border-purple-400 hover:shadow-sm active:scale-95
                                        ${b?"bg-purple-50 border-purple-200 ring-1 ring-purple-300":"bg-white border-slate-100"}
                                    `,children:[l.jsx("span",{className:`text-xs font-bold ${I===0?"text-red-500":I===6?"text-blue-500":"text-slate-700"}`,children:w}),v&&l.jsx("span",{className:"text-[7px] text-slate-400 break-keep leading-[1.1] w-full px-0.5 whitespace-pre-wrap",title:v.range,children:v.range})]},g)})}),l.jsx("div",{className:"bg-amber-50 p-3 rounded-xl border border-amber-200",children:l.jsx("p",{className:"text-[11px] text-amber-700 leading-relaxed font-medium",children:"        ."})})]}),l.jsx("button",{onClick:e,className:"w-full bg-slate-100 font-bold py-3 rounded-xl mt-4 text-slate-600",children:""})]})})},mL=({show:t,onClose:e,progressRanking:n,allMembersForRace:r,subgroupId:s,currentUser:i,selectedSubgroupDetail:o,setSelectedSubgroupDetail:a,rankingCommunityFilter:c,setRankingCommunityFilter:u})=>{if(!t)return null;if(o){const d=r.filter(y=>y.subgroupId===o).sort((y,x)=>{const w=((y.readCount||1)-1)*365+(y.currentDay||1);return((x.readCount||1)-1)*365+(x.currentDay||1)-w}),h=new Date().toDateString(),f=d.length>0?Math.round(d.reduce((y,x)=>y+(x.currentDay||0),0)/d.length):0,m=d.filter(y=>y.lastReadDate===h).length;return l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:y=>{y.target===y.currentTarget&&a(null)},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-2xl max-h-[80vh] flex flex-col",onClick:y=>y.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4 border-b pb-3",children:[l.jsx("button",{onClick:()=>a(null),className:"text-slate-400 hover:text-slate-600",children:l.jsx(pe,{name:"back",size:20})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:o}),l.jsx("p",{className:"text-xs text-slate-500",children:"  "})]}),l.jsx("button",{onClick:()=>{a(null),e()},className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[l.jsxs("div",{className:"bg-blue-50 p-3 rounded-xl text-center border border-blue-100",children:[l.jsx("p",{className:"text-xl font-bold text-blue-600",children:d.length}),l.jsx("p",{className:"text-[10px] text-slate-500",children:" "})]}),l.jsxs("div",{className:"bg-green-50 p-3 rounded-xl text-center border border-green-100",children:[l.jsx("p",{className:"text-xl font-bold text-green-600",children:f}),l.jsx("p",{className:"text-[10px] text-slate-500",children:" Day"})]}),l.jsxs("div",{className:"bg-orange-50 p-3 rounded-xl text-center border border-orange-100",children:[l.jsx("p",{className:"text-xl font-bold text-orange-600",children:m}),l.jsx("p",{className:"text-[10px] text-slate-500",children:" "})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto space-y-2 pr-2",children:d.length>0?d.map((y,x)=>{const w=y.uid===i.uid,g=y.lastReadDate===h,p=Math.round(y.currentDay/365*100);return l.jsxs("div",{className:`p-3 rounded-xl border ${w?"bg-blue-50 border-blue-200":"bg-slate-50 border-slate-100"}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${x===0?"bg-yellow-100 text-yellow-600":x===1?"bg-slate-200 text-slate-600":x===2?"bg-orange-100 text-orange-600":"bg-slate-100 text-slate-400"}`,children:x+1}),l.jsxs("span",{className:`font-bold text-sm ${w?"text-blue-600":"text-slate-700"}`,children:[y.name," ",w&&"()"]}),(y.readCount||1)>1&&l.jsxs("span",{className:"text-[10px] bg-purple-500 text-white px-1.5 py-0.5 rounded-full font-bold",children:[y.readCount,""]}),g&&l.jsx("span",{className:"text-green-500 text-xs",children:""})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"text-sm font-bold text-slate-700",children:["Day ",((y.readCount||1)-1)*365+y.currentDay]}),l.jsxs("p",{className:"text-[10px] text-slate-400",children:[y.score||0,""]})]})]}),l.jsx("div",{className:"h-2 w-full bg-slate-200 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full rounded-full ${w?"bg-blue-500":"bg-slate-400"}`,style:{width:`${p}%`}})}),l.jsxs("div",{className:"flex justify-between mt-1",children:[l.jsxs("span",{className:"text-[10px] text-slate-400",children:[p,"% "]}),y.streak>0&&l.jsxs("span",{className:"text-[10px] text-orange-500 font-bold",children:[" ",y.streak," "]})]})]},y.uid)}):l.jsx("div",{className:"text-center py-8 text-slate-400",children:l.jsx("p",{className:"text-sm",children:"  "})})}),l.jsx("button",{onClick:()=>a(null),className:"w-full bg-slate-100 font-bold py-3 rounded-xl mt-4 text-slate-600",children:""})]})})}else return l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:d=>{d.target===d.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md shadow-2xl max-h-[80vh] flex flex-col",onClick:d=>d.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"   "}),l.jsx("button",{onClick:e,className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsxs("div",{className:"mb-3 flex flex-wrap gap-2",children:[l.jsx("button",{onClick:()=>u("all"),className:`px-2.5 py-1.5 rounded-full text-[11px] font-bold whitespace-nowrap transition-colors ${c==="all"?"bg-blue-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:""}),Lr.map(d=>l.jsx("button",{onClick:()=>u(d.id),className:`px-2.5 py-1.5 rounded-full text-[11px] font-bold whitespace-nowrap transition-colors ${c===d.id?"bg-blue-600 text-white":"bg-slate-100 text-slate-600 hover:bg-slate-200"}`,children:d.name},d.id))]}),l.jsxs("div",{className:"mb-3 bg-blue-50 p-3 rounded-xl border border-blue-100",children:[l.jsxs("p",{className:"text-xs text-blue-700",children:[l.jsx("strong",{children:" "})," =   Day  365  100"]}),l.jsx("p",{className:"text-[10px] text-blue-600 mt-1",children:"        "})]}),l.jsx("div",{className:"flex-1 overflow-y-auto space-y-3 pr-2",children:(()=>{let d=n;if(c!=="all"){const h=Lr.find(f=>f.id===c);h&&(d=n.filter(f=>h.subgroups.indexOf(f.name)!==-1))}return d.length===0?l.jsx("div",{className:"text-center py-8 text-slate-500",children:l.jsx("p",{className:"text-sm",children:"    ."})}):d.map((h,f)=>{const m=h.name===s,y=f===0?"bg-yellow-100 text-yellow-700 border-yellow-200":f===1?"bg-slate-200 text-slate-700 border-slate-300":f===2?"bg-orange-100 text-orange-700 border-orange-200":"bg-slate-100 text-slate-600 border-slate-200";return l.jsxs("button",{onClick:()=>a(h.name),className:`w-full p-3 rounded-xl border-2 transition-all hover:shadow-md ${m?"bg-blue-50 border-blue-300 hover:bg-blue-100":"bg-white border-slate-100 hover:border-slate-300"}`,children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold border-2 shrink-0 ${y}`,children:f+1}),l.jsx("div",{className:"flex-1 min-w-0 text-left",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("span",{className:`font-bold text-sm truncate pr-2 ${m?"text-blue-600":"text-slate-700"}`,children:[h.name," ",m&&"()"]}),l.jsxs("span",{className:"text-xs font-bold text-slate-500 shrink-0",children:[h.progressRate,"%"]})]})}),l.jsx(pe,{name:"arrowRight",size:16,className:"text-slate-400"})]}),l.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full rounded-full ${f===0?"bg-yellow-400":f===1?"bg-slate-400":f===2?"bg-orange-400":"bg-slate-300"}`,style:{width:`${h.progressRate}%`}})})]},f)})})()})]})})},gL=({show:t,onClose:e,memos:n,currentDay:r,score:s,streak:i,currentUser:o,generateMemosHTML:a})=>t?l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:c=>{c.target===c.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",onClick:c=>c.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"   "}),l.jsx("button",{onClick:e,className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsx("div",{className:"bg-indigo-50 p-3 rounded-xl border border-indigo-100 mb-4",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"text-center flex-1",children:[l.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:Object.keys(n).length}),l.jsx("p",{className:"text-[10px] text-slate-500",children:" "})]}),l.jsxs("div",{className:"text-center flex-1 border-l border-indigo-200",children:[l.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:r||1}),l.jsx("p",{className:"text-[10px] text-slate-500",children:" Day"})]}),l.jsxs("div",{className:"text-center flex-1 border-l border-indigo-200",children:[l.jsx("p",{className:"text-2xl font-bold text-indigo-600",children:s||0}),l.jsx("p",{className:"text-[10px] text-slate-500",children:" "})]})]})}),l.jsx("div",{className:"space-y-3 overflow-y-auto max-h-[45vh]",children:Object.keys(n).length>0?Object.keys(n).map(c=>[c,n[c]]).sort((c,u)=>Number(u[0])-Number(c[0])).map(c=>{const[u,d]=c;return l.jsxs("div",{className:"bg-slate-50 p-3 rounded-xl border border-slate-100",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsxs("span",{className:"text-xs font-bold text-blue-600",children:["DAY ",u," ",(d.texts&&d.texts.length||0)>1&&l.jsxs("span",{className:"ml-1 text-purple-500",children:["(",d.texts.length,")"]})]}),l.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(d.date).toLocaleDateString("ko-KR")})]}),l.jsx("p",{className:"text-xs text-slate-500 mb-1",children:d.title}),(d.texts||[d.text]).map((h,f)=>l.jsx("div",{className:"text-sm text-slate-700 leading-relaxed whitespace-pre-wrap "+(f>0?"mt-2 pt-2 border-t border-slate-200":""),children:h},f))]},u)}):l.jsxs("div",{className:"text-center py-8 text-slate-400",children:[l.jsx("div",{className:"text-4xl mb-2",children:""}),l.jsx("p",{className:"text-sm",children:"   ."})]})}),Object.keys(n).length>0&&l.jsx("button",{onClick:()=>a(o.name,n,{currentDay:r,score:s,streak:i}),className:"w-full bg-indigo-600 text-white font-bold py-3 rounded-xl mt-4 flex items-center justify-center gap-2 hover:bg-indigo-700 transition-colors",children:"   "}),l.jsx("button",{onClick:e,className:"w-full bg-slate-100 font-bold py-3 rounded-xl mt-2 text-slate-600",children:""})]})}):null,yL=({show:t,onClose:e,currentUser:n,changeSubgroup:r})=>t?l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",onClick:s=>{s.target===s.currentTarget&&e()},children:l.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",onClick:s=>s.stopPropagation(),children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[l.jsx("h3",{className:"text-xl font-bold text-slate-800",children:"  "}),l.jsx("button",{onClick:e,className:"text-slate-400",children:l.jsx(pe,{name:"close"})})]}),l.jsx("div",{className:"mb-4 bg-blue-50 p-3 rounded-xl border border-blue-200",children:l.jsxs("p",{className:"text-sm text-blue-700",children:[" : ",l.jsx("strong",{children:n.subgroupId||""})]})}),l.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-[300px] overflow-y-auto",children:(()=>{const s=Lr.find(i=>i.id===n.communityId);return s?s.subgroups.map((i,o)=>l.jsx("button",{onClick:()=>r(i),disabled:i===n.subgroupId,className:`p-3 rounded-xl text-sm font-bold transition-all ${i===n.subgroupId?"bg-blue-100 text-blue-600 border-2 border-blue-300":"bg-slate-50 text-slate-700 border-2 border-slate-200 hover:border-blue-300"}`,children:i},o)):null})()}),l.jsx("button",{onClick:e,className:"w-full bg-slate-100 font-bold py-3 rounded-xl mt-4 text-slate-600",children:""})]})}):null,vL=({handleLogout:t,streak:e,score:n,myLevel:r,setShowScoreInfo:s,setShowAchievements:i,setShowDateSettings:o,setShowCalendar:a,setShowReadingGuide:c,getEncouragementMessage:u,communityName:d,setShowFullRanking:h,topProgressGroups:f,subgroupId:m,planTypeName:y,versionName:x,handleChangeVersionStart:w,setView:g})=>l.jsxs("header",{className:"sticky top-0 z-30 space-y-4 mb-4",children:[l.jsx("div",{className:"bg-white/95 backdrop-blur-md border-b border-slate-200/60 shadow-sm",children:l.jsxs("div",{className:"px-4 py-2 flex flex-col md:flex-row justify-between items-center max-w-5xl mx-auto w-full gap-2.5 md:gap-4",children:[l.jsxs("div",{className:"flex items-center gap-1.5 overflow-x-auto scrollbar-hide w-full md:w-auto md:order-2 justify-between md:justify-end py-1",children:[l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsxs("div",{className:`text-xs font-bold px-2.5 py-1.5 rounded-xl flex items-center gap-1 shrink-0 ${e>0?"bg-orange-50 text-orange-600 border border-orange-100":"bg-slate-100 text-slate-400"}`,children:[l.jsx(pe,{name:"flame",size:12}),e,""]}),l.jsxs("button",{type:"button",onClick:p=>{p.stopPropagation(),s(!0)},className:"text-xs font-bold text-blue-600 bg-blue-50 border border-blue-100 px-2.5 py-1.5 rounded-xl hover:bg-blue-100 transition-colors shrink-0",children:[r.emoji," ",n||0,"pt"]}),l.jsxs("button",{type:"button",onClick:p=>{p.stopPropagation(),g("mini_room")},className:"p-1.5 text-xs font-bold text-indigo-600 bg-indigo-50 border border-indigo-100 rounded-xl hover:bg-indigo-100 shrink-0 flex items-center gap-1",title:" ",children:[" ",l.jsx("span",{className:"hidden sm:inline",children:""})]}),l.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),i(!0)},className:"p-1.5 text-xs font-bold text-yellow-600 bg-yellow-50 border border-yellow-100 rounded-xl hover:bg-yellow-100 shrink-0",children:""}),l.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),o(!0)},className:"p-1.5 text-xs font-bold text-purple-600 bg-purple-50 border border-purple-100 rounded-xl hover:bg-purple-100 shrink-0",children:""}),l.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),a(!0)},className:"p-1.5 text-xs font-bold text-green-600 bg-green-50 border border-green-100 rounded-xl hover:bg-green-100 shrink-0",children:""}),l.jsx("button",{type:"button",onClick:p=>{p.stopPropagation(),c(!0)},className:"p-1.5 text-xs font-bold text-slate-600 bg-slate-100 border border-slate-200 rounded-xl hover:bg-slate-200 shrink-0",children:l.jsx(pe,{name:"helpbook",size:14})})]}),l.jsxs("div",{className:"flex items-center shrink-0",children:[l.jsx("div",{className:"w-px h-4 bg-slate-200 mx-1"}),l.jsx("button",{onClick:t,className:"text-xs font-bold text-slate-400 hover:text-red-500 transition-colors shrink-0 px-1",children:""})]})]}),l.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-3 py-1.5 bg-slate-100/80 hover:bg-slate-200 rounded-full transition-colors group shrink-0 md:order-1 self-start md:self-center",children:[l.jsx("span",{className:"text-[11px] font-bold text-slate-500 tracking-tight",children:"  "}),l.jsxs("div",{className:"flex items-center gap-1.5",children:[l.jsx("span",{className:"text-xs font-bold text-slate-700",children:y}),l.jsx("span",{className:"w-px h-2.5 bg-slate-300"}),l.jsx("span",{className:"text-xs font-bold text-blue-600",children:x}),l.jsx(pe,{name:"refresh",size:10,className:"text-slate-400 group-hover:rotate-180 transition-transform duration-500"})]})]})]})}),l.jsx("div",{className:"px-4 w-full max-w-5xl mx-auto",children:l.jsxs("div",{className:"bg-white rounded-3xl shadow-md border border-slate-100/80 p-6 md:p-8",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("span",{className:"text-xs font-bold text-blue-600 tracking-tight",children:u()}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"text-xl font-black text-slate-900",children:[" ",d]}),l.jsx("span",{className:"text-sm font-bold text-slate-400",children:" "})]})]}),l.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-1 px-4 py-2 bg-slate-50 hover:bg-blue-50 text-blue-600 text-xs font-bold rounded-2xl transition-all border border-transparent hover:border-blue-100",children:[" ",l.jsx(pe,{name:"right",size:10})]})]}),l.jsx("div",{className:"space-y-4",children:f.map((p,v)=>l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold border-2 shrink-0 ${v===0?"bg-yellow-100 border-yellow-200 text-yellow-700":v===1?"bg-slate-100 border-slate-200 text-slate-700":"bg-orange-50 border-orange-100 text-orange-700"}`,children:v+1}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex justify-between text-xs mb-1.5",children:[l.jsx("span",{className:`font-bold truncate ${p.name===m?"text-blue-600":"text-slate-700"}`,children:p.name}),l.jsxs("span",{className:"font-bold text-slate-500 shrink-0",children:[" ",p.avgDay," (",p.progressRate,"%)"]})]}),l.jsx("div",{className:"h-4 w-full bg-slate-50 rounded-full border border-slate-100 overflow-hidden shadow-inner",children:l.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${v===0?"bg-gradient-to-r from-yellow-300 to-yellow-500":v===1?"bg-gradient-to-r from-slate-300 to-slate-500":"bg-gradient-to-r from-orange-300 to-orange-500"}`,style:{width:`${p.progressRate}%`}})})]})]},v))})]})})]}),xL=({racers:t,departmentChampions:e,getSubgroupDisplay:n})=>{const r=s=>{const i=Math.min(s,365);return i<=100?i/100*50:i<=200?50+(i-100)/100*30:80+(i-200)/165*20};return l.jsxs("div",{className:"mx-4 mb-6 relative h-64 bg-sky-texture overflow-hidden rounded-3xl shadow-xl border border-slate-100",children:[l.jsx("div",{className:"absolute inset-x-0 top-0 h-12 bg-gradient-to-b from-white/20 to-transparent z-10"}),l.jsx("div",{className:"mountain-back"}),l.jsx("div",{className:"mountain-front"}),l.jsx("div",{className:"absolute top-2 left-10 text-2xl opacity-80 animate-float",children:""}),l.jsx("div",{className:"absolute top-5 right-20 text-xl opacity-60 animate-float-slow",children:""}),l.jsx("div",{className:"absolute top-8 left-1/2 text-lg opacity-50 animate-float",style:{animationDelay:"2s"},children:""}),l.jsx("div",{className:"absolute bottom-2 left-5 text-sm z-10 opacity-90",children:""}),l.jsx("div",{className:"absolute bottom-3 right-10 text-sm z-10 opacity-90",children:""}),l.jsx("div",{className:"absolute bottom-4 left-1/3 text-xs z-10 opacity-80",children:""}),[100,200,300].map(s=>{const i=r(s);return l.jsxs("div",{className:"absolute top-2 z-20 flex flex-col items-center",style:{left:`${i}%`,transform:"translateX(-50%)"},children:[l.jsx("div",{className:"bg-white/95 px-2 py-1 rounded-full shadow-md border-2 border-slate-400 flex items-center justify-center",children:l.jsx("span",{className:"text-[10px] font-bold text-slate-700 leading-none",children:s})}),l.jsx("div",{className:"w-0.5 h-screen bg-gradient-to-b from-slate-400 via-slate-300 to-transparent opacity-40"})]},s)}),l.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex flex-col justify-center items-center z-20 group",style:{top:"60%"},children:[l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute inset-0 bg-yellow-400 rounded-full blur-xl opacity-70 animate-pulse"}),l.jsx("span",{className:"text-5xl relative z-10 drop-shadow-2xl",children:""})]}),l.jsx("span",{className:"text-[9px] font-bold text-slate-600 bg-white/90 px-2 py-0.5 rounded-full mt-2 shadow-sm border border-slate-200 relative z-20",children:""})]}),t.map((s,i)=>{const o=s.readCount||1,a=o>=2,c=a?s.currentDay:s.day,u=Math.min(r(c),100),d=s.isMe,h=n(s.subgroupId),f=e[s.uid],m=d?29:a?28:25,y=d?"50%":a?"8%":`${15+i%10*8}%`;return l.jsx("div",{className:"absolute transition-all duration-1000 ease-out",style:{left:`calc(${u}% - 16px)`,top:y,zIndex:m},children:l.jsxs("div",{className:"relative flex items-center",children:[o>1&&l.jsx("div",{className:"absolute -left-2 -top-1 w-4 h-4 bg-gradient-to-br from-purple-500 to-purple-700 rounded-full flex items-center justify-center border-2 border-white shadow-md z-10",children:l.jsx("span",{className:"text-[7px] font-bold text-white",children:o})}),l.jsxs("div",{className:`flex items-stretch rounded-full shadow-md overflow-hidden ${d?"ring-2 ring-yellow-400 ring-offset-1":""}`,children:[l.jsxs("div",{className:`text-[9px] pl-2 pr-1 py-0.5 font-bold whitespace-nowrap flex items-center gap-0.5 ${d?"bg-gradient-to-r from-blue-500 to-blue-600 text-white":"bg-white/95 text-slate-700"}`,children:[f&&l.jsx("span",{className:"text-[11px]",title:`${f} 1`,children:""}),s.name]}),l.jsx("div",{className:`text-[9px] pl-1 pr-1.5 py-0.5 font-bold whitespace-nowrap text-white flex items-center ${h.bgColor} border-l border-white/30`,children:s.subgroupId})]})]})},s.uid||i)})]})},wL=({announcement:t})=>!t||!t.enabled||!t.text?null:l.jsx("div",{className:"bg-white border-2 border-slate-100 rounded-3xl p-7 shadow-sm mb-10",children:l.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-start gap-6",children:[l.jsx("div",{className:"flex-shrink-0 w-16 h-16 bg-slate-50 rounded-2xl flex items-center justify-center text-4xl shadow-inner border border-slate-100",children:""}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-slate-900 font-bold leading-snug",children:l.jsx(Ok,{content:t.text,fontSize:19})}),l.jsx("div",{className:"flex flex-wrap items-center gap-3 mt-6",children:t.links&&t.links.length>0?t.links.map((e,n)=>e.url&&e.text&&l.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center bg-[#03C75A] text-white px-8 py-3.5 rounded-2xl text-[17px] font-black hover:bg-[#02b351] transition-colors shadow-md active:scale-95 min-w-[140px]",children:e.text},n)):t.linkUrl&&t.linkText&&l.jsx("a",{href:t.linkUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center bg-[#03C75A] text-white px-8 py-3.5 rounded-2xl text-[17px] font-black hover:bg-[#02b351] transition-colors shadow-md active:scale-95 min-w-[140px]",children:t.linkText})})]})]})}),bL=({verseData:t,viewingDay:e,setViewingDay:n,currentUser:r,daysRemaining:s,handleChangeVersionStart:i,getEncouragementMessage:o,fontSize:a,setFontSize:c,isSpeaking:u,isPaused:d,ttsSpeed:h,handleSpeedChange:f,handleSpeak:m,handleStop:y,availableVoices:x,selectedVoiceURI:w,setSelectedVoiceURI:g,activeChunkIndex:p,jumpToChunk:v,hasReadToday:b,handleRead:I})=>l.jsxs("div",{className:"bg-white rounded-3xl shadow-xl overflow-hidden border border-slate-100",children:[l.jsxs("div",{className:"p-6 text-white relative bg-gradient-to-br from-indigo-600 to-blue-700",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2 px-2",children:[l.jsx("button",{onClick:()=>n(_=>Math.max(1,_-1)),className:"p-2 rounded-full bg-white/20 hover:bg-white/30 text-white transition-colors disabled:opacity-30",disabled:e<=1,children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})})}),l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-2xl font-bold mb-1",children:t.loading?"...":t.title}),l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[(r.readCount||1)>1&&l.jsxs("span",{className:"text-xs bg-purple-500/90 px-2 py-0.5 rounded-full",children:[" ",r.readCount,""]}),l.jsxs("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:[" D-",s]})]})]}),l.jsx("button",{onClick:()=>n(_=>Math.min(365,_+1)),className:"p-2 rounded-full bg-white/20 hover:bg-white/30 text-white transition-colors disabled:opacity-30",disabled:e>=365,children:l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})})]}),l.jsxs("div",{className:"flex justify-between items-end mb-2",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"opacity-90 text-sm font-bold text-white/90 mb-1 flex items-center gap-2",children:t.subtitle}),l.jsx("p",{className:"opacity-80 text-xs",children:o()})]}),l.jsxs("div",{className:"flex items-center gap-1 bg-white/20 backdrop-blur-md rounded-full px-2 py-1 shadow-sm shrink-0 ml-4",children:[l.jsx("button",{onClick:()=>{const _=Math.max(12,a-2);c(_),localStorage.setItem("bible_fontSize",_)},className:"w-7 h-7 rounded-full bg-white/30 hover:bg-white/50 flex items-center justify-center text-white font-bold",children:""}),l.jsxs("div",{className:"flex flex-col items-center px-1",children:[l.jsx("span",{className:"text-white/60 text-[7px] font-bold leading-none",children:"SIZE"}),l.jsx("span",{className:"text-white text-xs font-bold leading-none",children:a})]}),l.jsx("button",{onClick:()=>{const _=Math.min(28,a+2);c(_),localStorage.setItem("bible_fontSize",_)},className:"w-7 h-7 rounded-full bg-white/30 hover:bg-white/50 flex items-center justify-center text-white font-bold",children:"+"})]})]}),t.text&&t.text.length>20&&!t.loading&&l.jsx("div",{className:"mt-3 bg-white/10 backdrop-blur-md p-3 rounded-2xl border border-white/20",children:l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("span",{className:"text-base",children:u?"":""}),l.jsxs("div",{className:"flex flex-col",children:[l.jsx("span",{className:"text-[10px] font-bold text-white/70 leading-tight",children:" "}),l.jsx("span",{className:"text-[9px] text-white/50 leading-tight",children:u?d?" ":" ...":" "})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"flex items-center bg-black/20 rounded-lg px-1 py-0.5",children:[l.jsx("button",{onClick:()=>f(-.1),disabled:h<=.6,className:"w-5 h-5 flex items-center justify-center text-white/80 hover:text-white disabled:opacity-30",children:"-"}),l.jsxs("span",{className:"text-[10px] font-bold text-white min-w-[24px] text-center",children:[h.toFixed(1),"x"]}),l.jsx("button",{onClick:()=>f(.1),disabled:h>=2,className:"w-5 h-5 flex items-center justify-center text-white/80 hover:text-white disabled:opacity-30",children:"+"})]}),l.jsx("button",{onClick:()=>u?y():m(t.text),className:`px-4 py-1.5 rounded-xl text-xs font-bold transition-all shadow-sm ${u?"bg-red-500 text-white hover:bg-red-600 ring-2 ring-red-400/50":"bg-white text-indigo-600 hover:bg-indigo-50"}`,children:u?" ":" "})]})]}),x.length>0&&l.jsxs("div",{className:"flex items-center gap-2 pt-1 border-t border-white/10",children:[l.jsx("span",{className:"text-[9px] text-white/50 shrink-0",children:":"}),l.jsx("select",{value:w,onChange:_=>{const N=_.target.value;if(g(N),localStorage.setItem("bible_selectedVoiceURI",N),u){const C=p;y(),setTimeout(()=>{m(t.text,C)},100)}},className:"flex-1 bg-black/30 text-white text-[9px] py-1 px-2 rounded border border-white/10 focus:outline-none focus:ring-1 focus:ring-white/30 truncate",children:x.map(_=>l.jsx("option",{value:_.voiceURI,children:_.name},_.voiceURI))})]})]})})]}),l.jsxs("div",{className:"p-6 bg-white",children:[l.jsx("div",{className:"prose prose-slate max-w-none mb-10 min-h-[300px]",children:t.loading?l.jsxs("div",{className:"flex flex-col items-center justify-center py-20 space-y-4",children:[l.jsx("div",{className:"w-12 h-12 border-4 border-blue-100 border-t-blue-500 rounded-full animate-spin"}),l.jsx("p",{className:"text-slate-400 font-bold animate-pulse",children:"  ..."})]}):l.jsx(Ok,{content:t.text,fontSize:a,activeChunkIndex:p,onSegmentClick:v})}),!t.loading&&l.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-100",children:[l.jsxs("button",{onClick:I,className:`w-full py-5 rounded-3xl font-bold text-xl transition-all shadow-xl hover:shadow-2xl active:scale-95 flex items-center justify-center gap-3
                                ${b&&e===r.currentDay?"bg-slate-800 text-white":"bg-gradient-to-r from-blue-600 to-indigo-600 text-white hover:from-blue-700 hover:to-indigo-700"}`,children:[l.jsx("span",{className:"text-2xl",children:""}),"    ( )"]}),l.jsx("p",{className:"text-center text-xs text-slate-400 mt-4 font-medium",children:b&&e===r.currentDay?"!       ":"    !"})]})]})]}),_L=({currentMemo:t,setCurrentMemo:e,setShowMemoList:n,saveMemo:r,viewingDay:s,currentDay:i,memos:o})=>l.jsxs("div",{className:"mt-4 bg-[#fdf4ff] p-5 rounded-3xl border border-purple-100 shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsx("h3",{className:"font-bold text-purple-700 flex items-center gap-2",children:"  "}),l.jsx("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),n(!0)},className:"text-xs text-purple-500 underline hover:text-purple-700",children:"  "})]}),l.jsx("textarea",{value:t,onChange:a=>e(a.target.value),placeholder:`    ...

   
   
  `,className:"w-full p-4 text-sm border border-purple-200 rounded-2xl focus:outline-none focus:ring-2 focus:ring-purple-400 resize-none bg-white shadow-inner",rows:8}),l.jsx("button",{onClick:()=>r(s?s-1:i-1,t,()=>e("")),disabled:!t.trim(),className:"w-full mt-3 bg-gradient-to-r from-purple-500 to-indigo-500 text-white font-bold py-3 rounded-2xl text-sm disabled:opacity-50 disabled:cursor-not-allowed hover:from-purple-600 hover:to-indigo-600 transition-all shadow-md active:scale-[0.98]",children:"  "}),o[s?s-1:i-1]&&l.jsxs("div",{className:"mt-4 p-4 bg-white rounded-2xl border border-purple-100 max-h-40 overflow-y-auto shadow-sm",children:[l.jsx("p",{className:"text-[10px] text-purple-500 mb-2 font-bold flex items-center gap-1",children:"   :"}),(()=>{const a=o[s?s-1:i-1],c=a.texts||[a.text];return c.map((u,d)=>l.jsxs("div",{className:`text-sm text-slate-600 whitespace-pre-wrap leading-relaxed ${d>0?"mt-3 pt-3 border-t border-purple-50":""}`,children:[c.length>1&&l.jsxs("span",{className:"text-[10px] text-purple-400 font-bold",children:["#",d+1," "]}),u]},d))})()]})]}),IL=({communityName:t,getSubgroupRanking:e,subgroupId:n,communityId:r})=>{const s=e();return l.jsxs("div",{className:"bg-white rounded-3xl border border-slate-100 p-6 shadow-xl scroll-mt-20",children:[l.jsx("div",{className:"flex justify-between items-center mb-5",children:l.jsxs("h3",{className:"font-bold text-slate-700 flex items-center gap-2",children:[l.jsx(pe,{name:"users",size:20,className:"text-indigo-500"})," "]})}),l.jsx("div",{className:"space-y-4 max-h-[400px] overflow-y-auto pr-2 custom-scrollbar",children:!s||s.length===0?l.jsx("div",{className:"text-center text-slate-400 py-8 text-sm",children:"  ..."}):s.map((i,o)=>{const a=i.communityId===r&&i.name===n,c=i.communityId==="senior"?i.name:`${i.communityName} ${i.name}`;return l.jsxs("div",{className:`relative transition-all ${a?"bg-blue-50/50 p-3 rounded-2xl ring-1 ring-blue-100":""}`,children:[l.jsxs("div",{className:"flex justify-between text-xs mb-1.5",children:[l.jsxs("span",{className:`font-bold flex items-center gap-1.5 ${a?"text-blue-600":"text-slate-600"}`,children:[l.jsx("span",{className:`w-5 h-5 flex items-center justify-center rounded-full text-[10px] ${o===0?"bg-yellow-100 text-yellow-700":o===1?"bg-slate-100 text-slate-600":o===2?"bg-orange-50 text-orange-700":"bg-slate-100 text-slate-400"}`,children:o+1}),c," ",a&&l.jsx("span",{className:"text-[10px] opacity-70",children:"()"})]}),l.jsxs("span",{className:`font-bold ${a?"text-blue-600":"text-slate-400"}`,children:[" ",i.progressRate,"%"]})]}),l.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full rounded-full transition-all duration-1000 ${a?"bg-blue-500":"bg-slate-300"}`,style:{width:`${i.progressRate}%`}})})]},o)})})]})},NL=({getWeeklyMVP:t})=>{if(typeof t!="function")return null;const e=t();if(!e)return null;const{streakMVP:n,progressMVP:r,weeklyTop10:s=[],totalTop10:i=[]}=e;if(!n&&!r)return null;const o=new Date,a=new Date(o);return a.setDate(o.getDate()-o.getDay()),a.setHours(0,0,0,0),l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border border-blue-200 p-5 shadow-sm",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h3",{className:"font-bold text-blue-700 flex items-center gap-2",children:" "})}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-4",children:[l.jsxs("div",{className:"bg-white p-3 rounded-xl border border-blue-100 text-center",children:[l.jsx("div",{className:"text-2xl mb-1",children:""}),l.jsx("p",{className:"text-[10px] text-slate-500 mb-1",children:" "}),l.jsx("p",{className:"font-bold text-slate-800",children:n?n.name:"-"}),l.jsx("p",{className:"text-xs text-orange-500 mb-2 font-bold",children:(()=>n?`  ${(n.readHistory||[]).reduce((u,d)=>{const h=typeof d=="string"?d:d.date,f=typeof d=="string"?1:d.daysRead||1;return new Date(h)>=a?u+f:u},0)}`:"-")()}),l.jsx("p",{className:"text-[9px] text-slate-400 mt-2 pt-2 border-t border-slate-100",children:"     "})]}),l.jsxs("div",{className:"bg-white p-3 rounded-xl border border-blue-100 text-center",children:[l.jsx("div",{className:"text-2xl mb-1",children:""}),l.jsx("p",{className:"text-[10px] text-slate-500 mb-1",children:" "}),l.jsx("p",{className:"font-bold text-slate-800",children:r?r.name:"-"}),l.jsx("p",{className:"text-xs text-blue-500 mb-2 font-bold",children:(()=>{if(!r)return"-";const c=r.readCount||1,u=r.currentDay||0,d=(c-1)*365+u;return c>1?` ${d} (${c} ${u})`:` ${d}`})()}),l.jsx("p",{className:"text-[9px] text-slate-400 mt-2 pt-2 border-t border-slate-100",children:"   1"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{className:"bg-white p-3 rounded-xl border border-blue-100",children:[l.jsx("p",{className:"text-[10px] text-slate-500 font-bold mb-2 text-center",children:" 2-10"}),l.jsx("div",{className:"space-y-1",children:s.length>1?s.slice(1,10).map((c,u)=>{const d=(c.readHistory||[]).reduce((h,f)=>{const m=typeof f=="string"?f:f.date,y=typeof f=="string"?1:f.daysRead||1;return new Date(m)>=a?h+y:h},0);return l.jsxs("div",{className:"flex justify-between items-center text-[10px]",children:[l.jsxs("span",{className:"text-slate-600 truncate mr-1",children:[u+2,". ",c.name]}),l.jsxs("span",{className:"text-orange-500 font-bold shrink-0",children:[d,""]})]},c.uid)}):l.jsx("p",{className:"text-[10px] text-slate-400 text-center py-2",children:"-"})})]}),l.jsxs("div",{className:"bg-white p-3 rounded-xl border border-blue-100",children:[l.jsx("p",{className:"text-[10px] text-slate-500 font-bold mb-2 text-center",children:" 2-10"}),l.jsx("div",{className:"space-y-1",children:i.length>1?i.slice(1,10).map((c,u)=>{const d=((c.readCount||1)-1)*365+(c.currentDay||0);return l.jsxs("div",{className:"flex justify-between items-center text-[10px]",children:[l.jsxs("span",{className:"text-slate-600 truncate mr-1",children:[u+2,". ",c.name]}),l.jsxs("span",{className:"text-blue-600 font-bold shrink-0",children:[d,""]})]},c.uid)}):l.jsx("p",{className:"text-[10px] text-slate-400 text-center py-2",children:"-"})})]})]})]})},EL=({currentUser:t,communityMembers:e,allMembersForRace:n,memos:r,currentMemo:s,setCurrentMemo:i,readHistory:o,announcement:a,verseData:c,hasReadToday:u,viewingDay:d,setViewingDay:h,fontSize:f,setFontSize:m,isSpeaking:y,isPaused:x,handleTogglePause:w,ttsSpeed:g,handleSpeedChange:p,handleStop:v,handleSpeak:b,availableVoices:I,selectedVoiceURI:_,setSelectedVoiceURI:N,activeChunkIndex:C,jumpToChunk:R,handleRead:j,saveMemo:W,handleLogout:Q,handleChangeVersionStart:te,handleRestart:Z,changeSubgroup:Re,changeStartDate:Le,dateToOffset:ke,showConfetti:V,levelUpToast:T,bonusToast:S,newAchievement:O,showScoreInfo:B,setShowScoreInfo:M,showReadingGuide:X,setShowReadingGuide:me,showMemoList:oe,setShowMemoList:ge,showAchievements:yt,setShowAchievements:qr,showCalendar:ya,setShowCalendar:pr,showFullRanking:bv,setShowFullRanking:Vc,showDateSettings:hf,setShowDateSettings:Uc,showSubgroupChange:ff,setShowSubgroupChange:pf,showRestartConfirm:_v,setShowRestartConfirm:Iv,showMonthlyContestInfo:Nv,setShowMonthlyContestInfo:mf,calendarDate:gf,setCalendarDate:yf,dateSettingsDate:vf,setDateSettingsDate:xf,rankingCommunityFilter:wf,setRankingCommunityFilter:bf,selectedSubgroupDetail:_f,setSelectedSubgroupDetail:If,getSubgroupRanking:Nf,getProgressRanking:Ef,getSubgroupDisplay:kf,generateMemosHTML:Sf,getWeeklyMVP:Tf,setView:Cf})=>{if(!t)return null;const{currentDay:Tn,score:Hi,subgroupId:va,communityName:zc,planId:jf,streak:Wr}=t,[xa,Df]=(jf||"1year_revised").split("_"),Bc=th.find(se=>se.id===xa),Af=Bc?Bc.title:" ",qc=gs[xa]?gs[xa].find(se=>se.id===Df):null,Rf=qc?qc.name:"",wa=V$(Hi||0),Wc=()=>{const se=e.filter(vn=>vn.uid!==t.uid&&Math.abs(vn.currentDay-Tn)<=1).length,Ze=e.filter(vn=>vn.uid!==t.uid&&vn.currentDay>Tn).length,vt=e.length>0?e.reduce((vn,Ft)=>vn+Ft.currentDay,0)/e.length:Tn,Cn=Tn<vt-3,gr=new Date().getDay()===0;if(Cn&&gr&&Ze>0)return`  ${Ze}   !   !`;if(Wr>=7)return` ${Wr}   ! !`;if(Wr>=3)return` ${Wr} !    !`;if(se>0)return` ${se}   !`;const yr=["   !","   , !","    !","    !"];return yr[Tn%yr.length]},Pf=Math.max(0,Pk-Tn),Bs=n.map(se=>{const vt=((se.readCount||1)-1)*365+(se.currentDay||1);return{...se,day:vt,isMe:se.uid===t.uid}}).sort((se,Ze)=>Ze.day-se.day),ba=Bs.slice(0,20),Hc={},Gi=[];["senior","youth","middlehigh","elementary","kinder"].forEach(se=>{const Ze=Lr.find(gr=>gr.id===se),vt=Ze?Ze.name:null,Cn=Bs.find(gr=>gr.communityId===se||vt&&gr.communityName===vt);Cn&&(Hc[Cn.uid]=vt||(se==="senior"?"":se),Gi.push(Cn))});const Un=Bs.find(se=>se.isMe);let Gc=[];if(Un){const se=Un.communityId,Ze=Un.communityName;Gc=Bs.filter(vt=>{const Cn=se&&vt.communityId===se||Ze&&vt.communityName===Ze;return(!se&&!Ze?!0:Cn)&&!vt.isMe&&!ba.find(yr=>yr.uid===vt.uid)&&!Gi.find(yr=>yr.uid===vt.uid)}).sort((vt,Cn)=>Math.abs(vt.day-Un.day)-Math.abs(Cn.day-Un.day)).slice(0,10)}const mr=[...ba];Gi.forEach(se=>{mr.find(Ze=>Ze.uid===se.uid)||mr.push(se)}),Un&&!mr.find(se=>se.uid===Un.uid)&&mr.push(Un),Gc.forEach(se=>{mr.find(Ze=>Ze.uid===se.uid)||mr.push(se)});const Of=mr.sort((se,Ze)=>se.day-Ze.day),Kc=Ef(),$f=Kc.slice(0,3);return l.jsxs("div",{className:"min-h-screen bg-slate-50 overflow-hidden relative font-sans",children:[V&&l.jsx("div",{className:"fixed inset-0 z-50 flex justify-center pt-40 pointer-events-none",children:l.jsx("div",{className:"text-6xl animate-bounce",children:""})}),O&&l.jsx("div",{className:"fixed top-20 left-4 right-4 z-50 animate-bounce",children:l.jsxs("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white p-4 rounded-2xl shadow-2xl flex items-center gap-3",children:[l.jsx("div",{className:"text-4xl",children:O.emoji}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs font-bold opacity-90",children:"   !"}),l.jsx("p",{className:"font-bold text-lg",children:O.title}),l.jsx("p",{className:"text-xs opacity-80",children:O.desc})]})]})}),T&&l.jsx("div",{className:"fixed top-20 left-4 right-4 z-50 animate-bounce",children:l.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 text-white p-4 rounded-2xl shadow-2xl flex items-center gap-3",children:[l.jsx("div",{className:"text-4xl",children:""}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs font-bold opacity-90",children:"LEVEL UP!"}),l.jsxs("p",{className:"font-bold text-lg",children:[wa.name,"  !"]})]})]})}),S&&l.jsx("div",{className:"fixed top-32 left-1/2 -translate-x-1/2 z-50 animate-pulse",children:l.jsxs("div",{className:"bg-blue-600 text-white px-6 py-3 rounded-full shadow-2xl font-bold flex items-center gap-2",children:[l.jsx("span",{children:""}),S]})}),l.jsx(lL,{show:B,onClose:()=>M(!1),myLevel:wa,score:Hi}),l.jsx(cL,{show:X,onClose:()=>me(!1)}),l.jsx(uL,{show:yt,onClose:()=>qr(!1)}),l.jsx(dL,{show:ya,onClose:()=>pr(!1),calendarDate:gf,setCalendarDate:yf,readHistory:o}),l.jsx(hL,{show:Nv,onClose:()=>mf(!1)}),l.jsx(fL,{show:_v,onClose:()=>Iv(!1),onRestart:Z}),l.jsx(pL,{show:hf,onClose:()=>Uc(!1),currentUser:t,currentDay:Tn,dateSettingsDate:vf,setDateSettingsDate:xf,dateToOffset:ke,changeStartDate:Le}),l.jsx(mL,{show:bv,onClose:()=>Vc(!1),progressRanking:Kc,allMembersForRace:n,subgroupId:va,currentUser:t,selectedSubgroupDetail:_f,setSelectedSubgroupDetail:If,rankingCommunityFilter:wf,setRankingCommunityFilter:bf}),l.jsx(gL,{show:oe,onClose:()=>ge(!1),memos:r,currentDay:Tn,score:Hi,streak:Wr,currentUser:t,generateMemosHTML:Sf}),l.jsx(yL,{show:ff,onClose:()=>pf(!1),currentUser:t,changeSubgroup:Re}),l.jsx(vL,{handleLogout:Q,streak:Wr,score:Hi,myLevel:wa,setShowScoreInfo:M,setShowAchievements:qr,setShowDateSettings:Uc,setShowCalendar:pr,setShowReadingGuide:me,getEncouragementMessage:Wc,communityName:zc,setShowFullRanking:Vc,topProgressGroups:$f,subgroupId:va,planTypeName:Af,versionName:Rf,handleChangeVersionStart:te,setView:Cf}),l.jsxs("div",{className:"max-w-5xl mx-auto w-full pb-10 mt-8",children:[l.jsx(xL,{racers:Of,departmentChampions:Hc,getSubgroupDisplay:kf}),l.jsxs("main",{className:"px-4 space-y-6",children:[l.jsx(wL,{announcement:a}),l.jsx(bL,{verseData:c,viewingDay:d,setViewingDay:h,currentUser:t,daysRemaining:Pf,handleChangeVersionStart:te,getEncouragementMessage:Wc,fontSize:f,setFontSize:m,isSpeaking:y,isPaused:x,ttsSpeed:g,handleSpeedChange:p,handleSpeak:b,handleStop:v,availableVoices:I,selectedVoiceURI:_,setSelectedVoiceURI:N,activeChunkIndex:C,jumpToChunk:R,hasReadToday:u,handleRead:j}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsx(_L,{currentMemo:s,setCurrentMemo:i,setShowMemoList:ge,saveMemo:W,viewingDay:d,currentDay:Tn,memos:r}),l.jsx(IL,{communityName:zc,getSubgroupRanking:Nf,subgroupId:va,communityId:t?t.communityId:null})]}),l.jsx(NL,{getWeeklyMVP:Tf})]})]}),y&&l.jsx("div",{className:"fixed bottom-10 left-6 z-[100] flex items-center gap-2",children:l.jsxs("button",{onClick:w,className:`flex items-center justify-center gap-2 px-5 py-3 rounded-full shadow-2xl transition-all active:scale-95 ${x?"bg-indigo-600 shadow-indigo-200":"bg-orange-500 shadow-orange-200"} text-white`,children:[l.jsx("span",{className:"text-sm font-bold",children:x?" ":" "}),l.jsx("span",{className:"text-xl",children:x?"":""})]})})]})},kL=[{id:"wallpaper",name:"",icon:""},{id:"floor",name:"",icon:""},{id:"furniture",name:"",icon:""},{id:"electronic",name:"",icon:""},{id:"living",name:"/",icon:""},{id:"hobby",name:"/",icon:""},{id:"character",name:"",icon:""},{id:"hair",name:"/",icon:""},{id:"accessory",name:"",icon:""},{id:"outfit",name:"",icon:""}],kr=[{id:"wall_plain_white",category:"wallpaper",name:"  ",price:0,spriteSheet:"wallpapers_set",spriteX:0,spriteY:1,width:64,height:64,isDefault:!0},{id:"floor_plain_gray",category:"floor",name:"  ",price:0,spriteSheet:"floors_set",spriteX:1,spriteY:1,width:64,height:64,isDefault:!0},{id:"wall_sky",category:"wallpaper",name:" ",price:50,spriteSheet:"wallpapers_set",spriteX:0,spriteY:0,width:64,height:64},{id:"wall_star",category:"wallpaper",name:" ",price:50,spriteSheet:"wallpapers_set",spriteX:1,spriteY:0,width:64,height:64},{id:"wall_flower",category:"wallpaper",name:" ",price:50,spriteSheet:"wallpapers_set",spriteX:2,spriteY:0,width:64,height:64},{id:"wall_brick",category:"wallpaper",name:" ",price:80,spriteSheet:"wallpapers_set",spriteX:0,spriteY:1,width:64,height:64},{id:"wall_wood",category:"wallpaper",name:" ",price:80,spriteSheet:"wallpapers_set",spriteX:1,spriteY:1,width:64,height:64},{id:"wall_night",category:"wallpaper",name:" ",price:120,spriteSheet:"wallpapers_set",spriteX:2,spriteY:1,width:64,height:64},{id:"floor_wood",category:"floor",name:" ",price:50,spriteSheet:"floors_set",spriteX:0,spriteY:0,width:64,height:64},{id:"floor_tile_pink",category:"floor",name:"  ",price:60,spriteSheet:"floors_set",spriteX:1,spriteY:0,width:64,height:64},{id:"floor_tile_blue",category:"floor",name:"  ",price:60,spriteSheet:"floors_set",spriteX:2,spriteY:0,width:64,height:64},{id:"floor_grass",category:"floor",name:" ",price:80,spriteSheet:"floors_set",spriteX:0,spriteY:1,width:64,height:64},{id:"floor_marble",category:"floor",name:" ",price:150,spriteSheet:"floors_set",spriteX:1,spriteY:1,width:64,height:64},{id:"floor_carpet_red",category:"floor",name:"  ",price:200,spriteSheet:"floors_set",spriteX:2,spriteY:1,width:64,height:64},{id:"bed_wood",category:"furniture",name:"  ",price:150,spriteSheet:"furniture_beds",spriteX:0,spriteY:0,width:80,height:80},{id:"bed_princess",category:"furniture",name:"  ",price:300,spriteSheet:"furniture_beds",spriteX:1,spriteY:0,width:80,height:80},{id:"bed_modern_black",category:"furniture",name:"  ",price:400,spriteSheet:"furniture_beds",spriteX:0,spriteY:1,width:80,height:80},{id:"sofa_leather_brown",category:"furniture",name:"  ",price:200,spriteSheet:"furniture_chairs",spriteX:0,spriteY:0,width:64,height:64},{id:"sofa_fabric_pink",category:"furniture",name:"  ",price:180,spriteSheet:"furniture_chairs",spriteX:1,spriteY:0,width:64,height:64},{id:"desk_study",category:"furniture",name:"  ",price:120,spriteSheet:"furniture_desks",spriteX:0,spriteY:0,width:80,height:80},{id:"desk_antique",category:"furniture",name:"  ",price:280,spriteSheet:"furniture_desks",spriteX:1,spriteY:0,width:80,height:80},{id:"table_marble_round",category:"furniture",name:"  ",price:150,icon:""},{id:"bookshelf_tall",category:"furniture",name:"  ",price:250,icon:""},{id:"wardrobe_white",category:"furniture",name:"  ",price:350,icon:""},{id:"elec_pc_set",category:"electronic",name:"  PC",price:500,icon:""},{id:"elec_tv_huge",category:"electronic",name:"65  TV",price:450,icon:""},{id:"elec_home_theater",category:"electronic",name:" ",price:600,icon:""},{id:"elec_refrigerator",category:"electronic",name:"  ",price:400,icon:""},{id:"elec_ac_standing",category:"electronic",name:" ",price:300,icon:""},{id:"elec_laptop",category:"electronic",name:"  ",price:250,icon:""},{id:"elec_fan",category:"electronic",name:" ",price:80,icon:""},{id:"elec_toaster",category:"electronic",name:"  ",price:40,icon:""},{id:"plant_cactus",category:"living",name:" ",price:40,icon:""},{id:"plant_sunflower",category:"living",name:" ",price:60,icon:""},{id:"plant_bonsai",category:"living",name:"  ",price:120,icon:""},{id:"living_fish_tank",category:"living",name:" ",price:180,icon:""},{id:"living_dog_house",category:"living",name:"  & ",price:150,icon:""},{id:"living_cat_tower",category:"living",name:" ",price:200,icon:""},{id:"living_water_purifier",category:"living",name:" ",price:100,icon:""},{id:"hobby_piano_grand",category:"hobby",name:" ",price:800,icon:""},{id:"hobby_guitar_acoustic",category:"hobby",name:" ",price:150,icon:""},{id:"hobby_easel",category:"hobby",name:"  ",price:120,icon:""},{id:"hobby_teddy_bear_xl",category:"hobby",name:"  ",price:200,icon:""},{id:"hobby_globe",category:"hobby",name:" ",price:90,icon:""},{id:"hobby_mirror_full",category:"hobby",name:" ",price:110,icon:""},{id:"hobby_clock_wall",category:"hobby",name:" ",price:50,icon:""},{id:"hobby_holy_bible",category:"hobby",name:" ()",price:100,icon:""},{id:"base_man",category:"character",name:" ",price:0,icon:"",isDefault:!0},{id:"base_woman",category:"character",name:" ",price:0,icon:"",isDefault:!0},{id:"base_boy",category:"character",name:" ",price:0,icon:"",isDefault:!0},{id:"base_girl",category:"character",name:" ",price:0,icon:"",isDefault:!0},{id:"base_senior_man",category:"character",name:" ",price:0,icon:"",isDefault:!0},{id:"base_senior_woman",category:"character",name:" ",price:0,icon:"",isDefault:!0},{id:"hair_short_black",category:"hair",name:"  ",price:30,icon:""},{id:"hair_long_brown",category:"hair",name:"  ",price:40,icon:""},{id:"hair_curly_yellow",category:"hair",name:"  ",price:50,icon:""},{id:"hair_cap_red",category:"hair",name:"  ",price:60,icon:""},{id:"hair_beanie_blue",category:"hair",name:"  ",price:45,icon:""},{id:"hair_tiara",category:"hair",name:" ",price:120,icon:""},{id:"acc_glasses_horn",category:"accessory",name:"  ",price:40,icon:""},{id:"acc_sunglasses_dark",category:"accessory",name:" ",price:80,icon:""},{id:"acc_ribbon_pink",category:"accessory",name:"  ",price:35,icon:""},{id:"acc_mask_white",category:"accessory",name:"  ",price:10,icon:""},{id:"outfit_hoodie_gray",category:"outfit",name:" ",price:100,icon:""},{id:"outfit_suit_black",category:"outfit",name:"  ",price:250,icon:""},{id:"outfit_dress_yellow",category:"outfit",name:"  ",price:220,icon:""},{id:"outfit_jersey_blue",category:"outfit",name:" ",price:120,icon:""},{id:"outfit_hanbok",category:"outfit",name:"  ",price:500,icon:""}],SL=(t,e)=>{const[n,r]=A.useState({unlockedRooms:1,activeRoomIndex:0,rooms:[{wallpaper:"wall_plain_white",floor:"floor_plain_gray",items:[],characterPos:{x:4,y:4}}]}),[s,i]=A.useState({baseId:"base_man",hairId:null,accessoryId:null,outfitId:null}),[o,a]=A.useState(["wall_plain_white","floor_plain_gray","base_man"]),[c,u]=A.useState(!0),[d,h]=A.useState(null);A.useEffect(()=>{if(t&&t.miniroom)r(t.miniroom),t.character&&i(t.character),t.inventory&&a(t.inventory),u(!1);else if(t){const I={miniroom:{unlockedRooms:1,activeRoomIndex:0,rooms:[{wallpaper:"wall_plain_white",floor:"floor_plain_gray",items:[],characterPos:{x:4,y:4}}]},character:{baseId:"base_man",hairId:null,accessoryId:null,outfitId:null},inventory:["wall_plain_white","floor_plain_gray","base_man"]};r(I.miniroom),i(I.character),a(I.inventory),u(!1)}},[t]);const f=async I=>{if(!(!t||!t.uid))try{await fe.collection("users").doc(t.uid).set(I,{merge:!0}),e(_=>({..._,...I}))}catch(_){console.error("   :",_)}},m=async I=>{if(!t||(t.score||0)<I.price)return alert(" !"),!1;if(["wallpaper","floor","character","hair","accessory","outfit"].includes(I.category)&&o.includes(I.id))return alert("   ."),!1;const N=(t.score||0)-I.price,C=[...o,I.id],R={score:N,inventory:C,updatedAt:Ie.firestore.FieldValue.serverTimestamp()};try{return await f(R),a(C),alert(`${I.name}() !`),!0}catch{return alert(" "),!1}},y=I=>{const _={...n,...I};r(_),f({miniroom:_})};return{roomData:n,character:s,inventory:o,loading:c,previewItem:d,setPreviewItem:h,buyItem:m,updateRoom:y,placeItem:(I,_,N)=>{const C=[...n.rooms],R={...C[n.activeRoomIndex]},j={id:`${I}_${Date.now()}`,itemId:I,x:_,y:N};R.items=[...R.items||[],j],C[n.activeRoomIndex]=R,y({rooms:C})},movePlacedItem:(I,_,N)=>{const C=[...n.rooms],R={...C[n.activeRoomIndex]};R.items=R.items.map(j=>j.id===I?{...j,x:_,y:N}:j),C[n.activeRoomIndex]=R,y({rooms:C})},removePlacedItem:I=>{const _=[...n.rooms],N={..._[n.activeRoomIndex]};N.items=N.items.filter(C=>C.id!==I),_[n.activeRoomIndex]=N,y({rooms:_})},updateCharacter:I=>{const _={...s,...I};i(_),f({character:_})},moveCharacter:(I,_)=>{const N=[...n.rooms],C={...N[n.activeRoomIndex]};C.characterPos={x:I,y:_},N[n.activeRoomIndex]=C,y({rooms:N})},unlockRoom:async()=>{if(n.unlockedRooms>=5)return;const I=800+(n.unlockedRooms-1)*400;if((t.score||0)<I){alert(` ! (: ${I})`);return}if(confirm(` ? (${I}  )`)){const _=(t.score||0)-I,N={...n,unlockedRooms:n.unlockedRooms+1,rooms:[...n.rooms,{wallpaper:"wall_plain_white",floor:"floor_plain_gray",items:[],characterPos:{x:4,y:4}}]};await f({score:_,miniroom:N,updatedAt:Ie.firestore.FieldValue.serverTimestamp()}),r(N)}},activeRoom:n.rooms[n.activeRoomIndex]}},TL=""+new URL("wallpapers_set-a7018cb3.png",import.meta.url).href,CL=""+new URL("floors_set-0d337dba.png",import.meta.url).href,jL=""+new URL("furniture_beds-9854e1f0.png",import.meta.url).href,DL=""+new URL("furniture_desks-5828590e.png",import.meta.url).href,AL=""+new URL("furniture_chairs-8dddf935.png",import.meta.url).href,Cg={wallpapers_set:TL,floors_set:CL,furniture_beds:jL,furniture_desks:DL,furniture_chairs:AL},wv=({item:t,size:e=64,className:n="",style:r={},scale:s=1})=>{if(!t||!t.spriteSheet)return null;const i=Cg[t.spriteSheet]||"",o=t.width||64,a=t.height||64,c=-(t.spriteX*o),u=-(t.spriteY*a),h=(t.spriteSheet.includes("set")?3:2)*o,f={width:`${o*s}px`,height:`${a*s}px`,backgroundImage:`url(${i})`,backgroundPosition:`${c*s}px ${u*s}px`,backgroundSize:`${h*s}px auto`,backgroundRepeat:"no-repeat",imageRendering:"pixelated",...r};return l.jsx("div",{className:`sprite-item ${n}`,style:f,title:t.name})},$k=({character:t,size:e="text-5xl",className:n=""})=>{if(!t)return null;const r=kr.find(a=>a.id===t.baseId),s=kr.find(a=>a.id===t.hairId),i=kr.find(a=>a.id===t.accessoryId),o=kr.find(a=>a.id===t.outfitId);return l.jsxs("div",{className:`relative flex items-center justify-center ${n}`,children:[l.jsx("div",{className:`${e} z-10`,children:(r==null?void 0:r.icon)||""}),s&&l.jsx("div",{className:"absolute -top-1 z-20 text-3xl",style:{transform:"translateY(-20%)"},children:s.icon}),o&&l.jsx("div",{className:"absolute inset-x-0 bottom-0 z-15 text-4xl text-center opacity-80",style:{transform:"translateY(10%)"},children:o.icon}),i&&l.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 z-30 text-2xl",style:{transform:"translate(-50%, -80%)"},children:i.icon})]})},RL=({activeRoom:t,character:e,previewItem:n,isPlacementMode:r=!1,selectedPlacementId:s,onGridClick:i,onItemClick:o,onCharacterClick:a})=>{var _;const h=kr.find(N=>N.id===(t.wallpaper||"wall_plain_white")),f=kr.find(N=>N.id===(t.floor||"floor_plain_gray")),m=h!=null&&h.spriteSheet?Cg[h.spriteSheet]:"",y=h?-(h.spriteX*h.width):0,x=h?-(h.spriteY*h.height):0,w=f!=null&&f.spriteSheet?Cg[f.spriteSheet]:"",g=f?-(f.spriteX*f.width):0,p=f?-(f.spriteY*f.height):0,v=(N,C)=>{const R=(N-C)*32,j=(N+C)*(32/2);return{x:R,y:j}},b={position:"relative",width:"640px",height:"420px",margin:"0 auto"},I=t.characterPos||{x:4,y:4};return l.jsxs("div",{className:"room-canvas-container py-10 flex items-center justify-center bg-slate-200 rounded-[2rem] overflow-hidden shadow-inner border-4 border-white/50 relative",children:[l.jsxs("div",{style:b,children:[l.jsxs("div",{className:"absolute inset-0 pointer-events-none z-0",children:[l.jsx("div",{className:"absolute",style:{width:"320px",height:"240px",transform:"skewY(-26deg)",left:"0",top:"20px",backgroundColor:"#fff",borderRight:"2px solid #eee",backgroundImage:`url(${m})`,backgroundPosition:`${y}px ${x}px`,backgroundSize:"192px auto",imageRendering:"pixelated"}}),l.jsx("div",{className:"absolute",style:{width:"320px",height:"240px",transform:"skewY(26deg)",left:"320px",top:"20px",backgroundColor:"#fff",borderLeft:"2px solid #eee",backgroundImage:`url(${m})`,backgroundPosition:`${y}px ${x}px`,backgroundSize:"192px auto",imageRendering:"pixelated",filter:"brightness(0.95)"}})]}),l.jsxs("div",{className:"absolute top-[180px] left-[320px] -translate-x-1/2",children:[Array.from({length:10}).map((N,C)=>l.jsx("div",{style:{position:"absolute",zIndex:0},children:Array.from({length:10}).map((R,j)=>{const{x:W,y:Q}=v(j,C);return l.jsx("div",{onClick:()=>i&&i(j,C),className:`${r?"hover:bg-blue-500/20 cursor-crosshair":""} transition-colors`,style:{position:"absolute",left:W,top:Q,width:64,height:32,backgroundImage:`url(${w})`,backgroundPosition:`${g}px ${p}px`,backgroundSize:"192px auto",zIndex:0,clipPath:"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)",imageRendering:"pixelated"}},j)})},C)),(_=t.items)==null?void 0:_.map(N=>{const{x:C,y:R}=v(N.x,N.y),j=kr.find(W=>W.id===N.itemId);return j?l.jsx("div",{onClick:W=>{W.stopPropagation(),o&&o(N)},className:`absolute transition-transform hover:scale-105 cursor-pointer ${s===N.id?"ring-2 ring-blue-500 rounded-full scale-110":""}`,style:{left:C,top:R,transform:`translate(${-j.width/4}px, ${-j.height/2}px)`,zIndex:10+N.y},children:l.jsx(wv,{item:j,scale:1})},N.id):null}),(()=>{const{x:N,y:C}=v(I.x,I.y);let R={...e};return n&&(n.category==="character"&&(R.baseId=n.id),n.category==="hair"&&(R.hairId=n.id),n.category==="accessory"&&(R.accessoryId=n.id),n.category==="outfit"&&(R.outfitId=n.id)),l.jsx("div",{onClick:j=>{j.stopPropagation(),a&&a()},className:`absolute cursor-move transition-all group ${s==="character"?"scale-110":""}`,style:{left:N,top:C,zIndex:50+I.y,transform:"translate(-50%, -70%)"},children:l.jsxs("div",{className:"relative",children:[l.jsx($k,{character:R}),l.jsx("div",{className:"w-10 h-3 bg-black/10 rounded-full blur-[2px] mx-auto -mt-2"}),s==="character"&&l.jsx("div",{className:"absolute -inset-4 border-2 border-blue-500 rounded-xl animate-pulse"})]})})})(),n&&(n.category==="wallpaper"||n.category==="floor")&&l.jsx("div",{className:"absolute -top-[180px] -left-[320px] w-[640px] h-[400px] pointer-events-none ring-4 ring-indigo-500/50 rounded-3xl flex items-center justify-center bg-indigo-500/10 z-[100]",children:l.jsxs("p",{className:"bg-indigo-600 text-white px-4 py-2 rounded-full font-black text-sm shadow-xl",children:[" : ",n.name]})})]})]}),r&&l.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 bg-blue-600 text-white px-6 py-2 rounded-full font-black shadow-xl z-[200] animate-bounce",children:"   "})]})},PL=({shopCategory:t,setShopCategory:e,buyItem:n,inventory:r,onPreview:s,currentTalants:i})=>l.jsxs("div",{className:"bg-white rounded-[2rem] shadow-lg border border-slate-100 p-6 animate-in slide-in-from-bottom-4 duration-300",children:[l.jsx("div",{className:"flex items-center gap-4 mb-6 overflow-x-auto pb-2 scrollbar-hide",children:kL.map(o=>l.jsxs("button",{onClick:()=>e(o.id),className:`px-5 py-2.5 rounded-2xl font-bold whitespace-nowrap transition-all ${t===o.id?"bg-indigo-600 text-white shadow-lg":"bg-slate-100 text-slate-500 hover:bg-slate-200"}`,children:[o.icon," ",o.name]},o.id))}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:kr.filter(o=>o.category===t).map(o=>{const a=r.includes(o.id);return l.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-3xl p-4 flex flex-col items-center hover:shadow-md transition-shadow group relative",children:[l.jsx("div",{className:"w-20 h-20 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform cursor-help",onClick:()=>s(o),title:" ()",children:o.spriteSheet?l.jsx(wv,{item:o,scale:1.2}):l.jsx("div",{className:"text-5xl",children:o.icon})}),l.jsx("p",{className:"text-sm font-bold text-slate-700 text-center truncate w-full",children:o.name}),l.jsxs("p",{className:"text-xs font-black text-orange-500 mt-1",children:[" ",o.price]}),a?l.jsx("div",{className:"mt-3 w-full py-2 bg-slate-200 text-slate-400 rounded-xl text-xs font-black text-center",children:" "}):l.jsx("button",{onClick:()=>n(o),className:`mt-3 w-full py-2 rounded-xl text-xs font-black transition-colors ${i>=o.price?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:""}),l.jsx("button",{onClick:()=>s(o),className:"absolute top-2 right-2 p-1.5 bg-white shadow-sm border border-slate-100 rounded-full opacity-0 group-hover:opacity-100 transition-opacity text-[10px]",title:"",children:""})]},o.id)})})]}),OL=({inventory:t,onUseItem:e})=>l.jsxs("div",{className:"bg-white rounded-[2rem] shadow-lg border border-slate-100 p-6 animate-in slide-in-from-bottom-4 duration-300",children:[l.jsxs("h3",{className:"text-lg font-black text-slate-800 mb-6 flex items-center gap-2",children:["    ",l.jsxs("span",{className:"text-slate-300 text-sm",children:["(",t.length,")"]})]}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:t.map((n,r)=>{const s=kr.find(i=>i.id===n);return s?l.jsxs("div",{className:"bg-slate-50 border border-slate-100 rounded-3xl p-4 flex flex-col items-center group",children:[l.jsx("div",{className:"w-20 h-20 flex items-center justify-center mb-3",children:s.spriteSheet?l.jsx(wv,{item:s,scale:1.2}):l.jsx("div",{className:"text-5xl",children:s.icon})}),l.jsx("p",{className:"text-sm font-bold text-slate-700 text-center truncate w-full",children:s.name}),l.jsx("button",{onClick:()=>e(s),className:"mt-3 w-full py-2 bg-slate-200 text-slate-600 rounded-xl text-xs font-black hover:bg-indigo-100 hover:text-indigo-600 transition-colors",children:["wallpaper","floor","character","hair","accessory","outfit"].includes(s.category)?"/":""})]},`${n}_${r}`):null})})]}),$L=({currentUser:t,setView:e,setCurrentUser:n})=>{const{roomData:r,character:s,inventory:i,activeRoom:o,loading:a,previewItem:c,setPreviewItem:u,buyItem:d,updateRoom:h,placeItem:f,movePlacedItem:m,removePlacedItem:y,updateCharacter:x,moveCharacter:w,unlockRoom:g}=SL(t,n),[p,v]=A.useState("main"),[b,I]=A.useState("room"),[_,N]=A.useState("wallpaper"),[C,R]=A.useState(!1),[j,W]=A.useState(null);if(a)return l.jsx("div",{className:"p-20 text-center",children:"  ..."});const Q=t.score||0;return l.jsxs("div",{className:"min-h-screen bg-slate-200 flex items-center justify-center p-4 cy-pixel-font",children:[l.jsxs("div",{className:"cy-frame-container max-w-5xl w-full flex relative",children:[l.jsxs("div",{className:"cy-inner-frame flex-1 flex flex-col min-h-[600px] shadow-sm",children:[l.jsxs("div",{className:"flex justify-between items-end mb-4 border-b border-slate-100 pb-2",children:[l.jsx("div",{className:"flex items-center gap-3",children:l.jsxs("h1",{className:"text-lg font-bold text-slate-700 tracking-tight",children:[t.name," ",l.jsx("span",{className:"ml-2 text-xs font-normal text-blue-500 underline cursor-pointer",children:""})]})}),l.jsxs("div",{className:"flex gap-4 text-[11px] text-slate-500 font-bold",children:[l.jsxs("span",{className:"flex items-center gap-1",children:["TODAY ",l.jsx("span",{className:"text-red-500",children:"24"})]}),l.jsx("span",{className:"w-px h-2 bg-slate-200 mt-1"}),l.jsxs("span",{className:"flex items-center gap-1",children:["TOTAL ",l.jsx("span",{className:"text-slate-800",children:"1,245"})]})]})]}),l.jsxs("div",{className:"flex flex-1 gap-4 overflow-hidden",children:[l.jsxs("div",{className:"w-48 flex flex-col gap-3",children:[l.jsx("div",{className:"aspect-square bg-slate-50 border border-slate-200 rounded p-2 flex items-center justify-center",children:l.jsx($k,{character:s,size:"text-7xl"})}),l.jsxs("div",{className:"flex-1 border-t-2 border-dashed border-slate-200 pt-3 text-[11px] text-slate-600 leading-relaxed",children:[l.jsxs("p",{className:"font-bold text-blue-600 mb-1",children:["TODAY IS... ",c?"":""]}),l.jsx("p",{children:"        !"}),l.jsx("div",{className:"mt-4 p-2 bg-slate-50 rounded italic text-slate-400",children:'"          "'})]}),l.jsxs("div",{className:"mt-auto",children:[l.jsxs("div",{className:"p-2 bg-orange-50 rounded border border-orange-100 flex flex-col items-center",children:[l.jsx("span",{className:"text-[10px] font-bold text-orange-400",children:" "}),l.jsxs("span",{className:"text-sm font-black text-orange-600",children:[" ",Q.toLocaleString()]})]}),l.jsxs("select",{className:"w-full mt-2 text-[10px] border border-slate-200 rounded p-1",children:[l.jsx("option",{children:" "}),l.jsx("option",{children:" "}),l.jsx("option",{children:" "})]})]})]}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"flex gap-1 mb-2",children:[l.jsx("button",{onClick:()=>{v("main"),u(null)},className:`px-4 py-1.5 text-xs font-bold rounded-t-lg border-x border-t transition-all ${p==="main"?"bg-white border-slate-200 text-slate-800 -mb-px z-10":"bg-slate-50 border-transparent text-slate-400"}`,children:""}),l.jsx("button",{onClick:()=>{v("shop"),u(null)},className:`px-4 py-1.5 text-xs font-bold rounded-t-lg border-x border-t transition-all ${p==="shop"?"bg-white border-slate-200 text-slate-800 -mb-px z-10":"bg-slate-50 border-transparent text-slate-400"}`,children:""}),l.jsx("button",{onClick:()=>{v("inventory"),u(null)},className:`px-4 py-1.5 text-xs font-bold rounded-t-lg border-x border-t transition-all ${p==="inventory"?"bg-white border-slate-200 text-slate-800 -mb-px z-10":"bg-slate-50 border-transparent text-slate-400"}`,children:""})]}),l.jsxs("div",{className:"flex-1 bg-white border border-slate-200 rounded-b-lg p-4 overflow-y-auto relative scrollbar-hide",children:[p==="main"&&l.jsxs("div",{className:"h-full flex flex-col",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("span",{className:"text-[11px] font-bold text-slate-400",children:["Miniroom Stage #0",r.activeRoomIndex+1]}),l.jsxs("div",{className:"flex gap-1",children:[r.rooms.map((te,Z)=>l.jsx("button",{onClick:()=>h({activeRoomIndex:Z}),className:`w-5 h-5 text-[10px] font-bold rounded border ${r.activeRoomIndex===Z?"bg-slate-800 text-white border-slate-800":"bg-white text-slate-400 border-slate-200"}`,children:Z+1},Z)),r.unlockedRooms<5&&l.jsx("button",{onClick:g,className:"w-5 h-5 text-[10px] bg-slate-100 text-slate-400 rounded border border-slate-200 hover:bg-slate-200",children:"+"})]})]}),l.jsx("div",{className:"flex-1 flex items-center justify-center p-2 bg-[#f0f0f0] rounded border border-slate-100 shadow-inner",children:l.jsx(RL,{activeRoom:o,character:s,previewItem:c,isPlacementMode:C,selectedPlacementId:j,onGridClick:(te,Z)=>{C&&(j==="character"?w(te,Z):j&&m(j,te,Z),R(!1),W(null))},onItemClick:te=>{W(te.id),R(!0)},onCharacterClick:()=>{W("character"),R(!0)}})}),C&&l.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 flex gap-2",children:[l.jsx("div",{className:"bg-blue-600 text-white px-4 py-1.5 rounded-full text-xs font-bold shadow-lg animate-bounce",children:"   ..."}),l.jsx("button",{onClick:()=>{R(!1),W(null)},className:"bg-white border border-slate-200 px-3 py-1 rounded-full text-[10px] font-bold shadow-sm hover:bg-slate-50 transition-colors",children:""}),j&&j!=="character"&&l.jsx("button",{onClick:()=>{y(j),R(!1),W(null)},className:"bg-red-50 text-red-500 border border-red-100 px-3 py-1 rounded-full text-[10px] font-bold hover:bg-red-100 transition-colors",children:""})]})]}),p==="shop"&&l.jsx(PL,{shopCategory:_,setShopCategory:N,buyItem:d,inventory:i,onPreview:te=>{u(te),v("main")},currentTalants:Q}),p==="inventory"&&l.jsx(OL,{inventory:i,onUseItem:te=>{const Z=te.category;Z==="wallpaper"?h({rooms:r.rooms.map((Re,Le)=>Le===r.activeRoomIndex?{...Re,wallpaper:te.id}:Re)}):Z==="floor"?h({rooms:r.rooms.map((Re,Le)=>Le===r.activeRoomIndex?{...Re,floor:te.id}:Re)}):["character","hair","accessory","outfit"].includes(Z)?x({[`${Z}Id`]:te.id}):["furniture","decoration","electronic","living","hobby"].includes(Z)&&(f(te.id,4,4),alert("  !")),v("main")}})]}),l.jsxs("div",{className:"mt-4 p-3 bg-slate-50 rounded border border-slate-100",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"text-[11px] font-bold text-slate-700",children:" (Guestbook)"}),l.jsx("button",{className:"text-[10px] text-blue-500 font-bold hover:underline",children:" +"})]}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"text-[10px] flex gap-2",children:[l.jsx("span",{className:"font-bold text-slate-500 shrink-0",children:""}),l.jsx("span",{className:"text-slate-700 truncate",children:"  ~!!"}),l.jsx("span",{className:"ml-auto text-slate-300",children:"12:35"})]}),l.jsxs("div",{className:"text-[10px] flex gap-2",children:[l.jsx("span",{className:"font-bold text-slate-500 shrink-0",children:""}),l.jsx("span",{className:"text-slate-700 truncate",children:"      "}),l.jsx("span",{className:"ml-auto text-slate-300",children:"10:11"})]})]})]})]})]})]}),l.jsxs("div",{className:"flex flex-col ml-[-1px] mt-12 z-20",children:[l.jsx("button",{onClick:()=>e("dashboard"),className:"cy-side-tab !bg-orange-500 border-orange-600",children:""}),l.jsx("button",{onClick:()=>I("room"),className:`cy-side-tab ${b==="room"?"active":""}`,children:""}),l.jsx("button",{onClick:()=>I("guestbook"),className:`cy-side-tab ${b==="guestbook"?"active":""}`,children:""}),l.jsx("button",{className:"cy-side-tab",children:""}),l.jsx("button",{className:"cy-side-tab",children:""}),l.jsx("button",{className:"cy-side-tab !bg-slate-400 !border-slate-500 opacity-50 cursor-not-allowed",children:""})]}),l.jsxs("div",{className:"absolute top-4 right-20 bg-slate-800 text-white rounded p-1 flex items-center gap-2 px-3 shadow-lg opacity-80 hover:opacity-100 transition-opacity",children:[l.jsx("div",{className:"text-[9px] font-bold animate-pulse text-green-400 shrink-0",children:"BGM ON"}),l.jsx("div",{className:"w-1 h-1 bg-white rounded-full animate-bounce"}),l.jsx("span",{className:"text-[11px] font-bold truncate max-w-[150px]",children:" -  (Remake)"}),l.jsxs("div",{className:"flex gap-1.5 ml-1 shrink-0",children:[l.jsx("span",{className:"text-[10px] cursor-pointer hover:text-blue-400",children:""}),l.jsx("span",{className:"text-[10px] cursor-pointer hover:text-blue-400",children:""}),l.jsx("span",{className:"text-[10px] cursor-pointer hover:text-blue-400",children:""})]})]})]}),c&&p==="main"&&l.jsx("div",{className:"fixed bottom-10 left-1/2 -translate-x-1/2 z-[200]",children:l.jsxs("div",{className:"bg-indigo-600 text-white pl-6 pr-2 py-2 rounded-lg shadow-2xl flex items-center gap-4 border-2 border-white/20",children:[l.jsxs("span",{className:"font-bold text-xs tracking-tight",children:["PREVIEW: ",c.name]}),l.jsxs("div",{className:"flex gap-1",children:[!i.includes(c.id)&&l.jsx("button",{onClick:()=>d(c),className:"bg-yellow-400 text-indigo-900 px-3 py-1 rounded font-black text-[10px] hover:bg-yellow-300",children:" "}),l.jsx("button",{onClick:()=>u(null),className:"bg-white/20 hover:bg-white/30 text-white px-3 py-1 rounded font-bold text-[10px]",children:""})]})]})})]})},LL=t=>{const[e,n]=A.useState(!1),[r,s]=A.useState(!1),[i,o]=A.useState(()=>parseFloat(localStorage.getItem("bible_ttsSpeed"))||1),[a,c]=A.useState([]),[u,d]=A.useState(()=>localStorage.getItem("bible_selectedVoiceURI")||""),[h,f]=A.useState(-1),[m,y]=A.useState(!1),x=A.useRef([]),w=A.useRef(0),g=A.useRef(!1),p=A.useRef(null);A.useEffect(()=>{const R=()=>{if(!window.speechSynthesis)return;const W=window.speechSynthesis.getVoices();if(W.length===0)return;console.log("Loaded voices:",W.length);const Q=W.filter(te=>te.lang==="ko-KR"||te.lang.startsWith("ko"));c(te=>te.length===Q.length&&te.every((Z,Re)=>Z.voiceURI===Q[Re].voiceURI)?te:Q)};R();const j=navigator.userAgent;return(j.indexOf("NAVER")>-1||j.indexOf("KAKAOTALK")>-1)&&y(!0),window.speechSynthesis.addEventListener?(window.speechSynthesis.addEventListener("voiceschanged",R),()=>window.speechSynthesis.removeEventListener("voiceschanged",R)):(window.speechSynthesis.onvoiceschanged=R,()=>{window.speechSynthesis.onvoiceschanged=null})},[]),A.useEffect(()=>{if(a.length>0){const R=localStorage.getItem("bible_selectedVoiceURI"),j=R&&a.some(W=>W.voiceURI===R);if(!u)if(j)d(R);else{const W=a[0].voiceURI;d(W),localStorage.setItem("bible_selectedVoiceURI",W)}}},[a,u]);const v=R=>{o(j=>{const W=parseFloat((j+R).toFixed(1)),Q=Math.max(.6,Math.min(2,W));return localStorage.setItem("bible_ttsSpeed",Q),e&&!r&&x.current.length>0&&(I(),setTimeout(()=>{N(t,w.current,Q)},50)),Q})},b=()=>{r?(s(!1),g.current=!1,_()):(s(!0),g.current=!0,window.speechSynthesis&&window.speechSynthesis.cancel())},I=()=>{window.speechSynthesis&&window.speechSynthesis.cancel(),n(!1),s(!1),g.current=!1,f(-1),x.current=[],w.current=0},_=(R=null)=>{if(!window.speechSynthesis)return;if(w.current>=x.current.length){n(!1),f(-1);return}f(w.current);const j=x.current[w.current];if(!j||j.trim().length===0){w.current++,_(R);return}const W=new SpeechSynthesisUtterance(j);if(u){const Q=a.find(te=>te.voiceURI===u);Q&&(W.voice=Q)}W.lang="ko-KR",W.rate=R!==null?R:i,W.pitch=1,W.onend=()=>{g.current||(w.current++,_(R))},W.onerror=Q=>{g.current||Q.error==="interrupted"||Q.error==="canceled"||(console.error("TTS Error:",Q),I())},p.current=W,window.speechSynthesis.speak(W)},N=(R,j=0,W=null)=>{if(m){alert(`/     .

  '  ' 
  .`);return}if(!window.speechSynthesis){alert("     .");return}const Q=W!==null?W:i;(window.speechSynthesis.speaking||window.speechSynthesis.pending)&&window.speechSynthesis.cancel();const te=R.split(`
`),Z=[];te.forEach(Re=>{const Le=Re.replace(/\[\[VERSE:\d+\]\]/g,"").trim();if(!Le)return;let ke=Le;Le.indexOf("#")===0?ke=Le.replace(/\([^)]*\)/g,"").replace(/[0-9]+/g,T=>z$(T)):ke=Le,ke=ke.replace(/^#+\s*/,"");const V=ke.split(/([.?!])/g).reduce((T,S)=>[".","?","!"].indexOf(S)!==-1?(T.length>0&&(T[T.length-1]+=S),T):(S.trim().length>0&&T.push(S),T),[]);Z.push(...V)}),Z.length!==0&&(x.current=Z,w.current=j,n(!0),s(!1),g.current=!1,f(j),setTimeout(()=>{_(Q)},50))},C=R=>{N(t,R)};return A.useEffect(()=>{t&&I()},[t]),A.useEffect(()=>()=>{window.speechSynthesis&&window.speechSynthesis.cancel()},[]),{isSpeaking:e,isPaused:r,ttsSpeed:i,availableVoices:a,selectedVoiceURI:u,activeChunkIndex:h,handleSpeedChange:v,handleTogglePause:b,handleStop:I,handleSpeak:N,jumpToChunk:C,setSelectedVoiceURI:d}},ML=()=>{const[t,e]=A.useState("login"),[n,r]=A.useState("login"),[s,i]=A.useState(""),[o,a]=A.useState(""),[c,u]=A.useState(""),[d,h]=A.useState(""),[f,m]=A.useState(""),[y,x]=A.useState(""),[w,g]=A.useState(null),{currentUser:p,setCurrentUser:v,authLoading:b}=Z$(),[I,_]=A.useState(""),{verseData:N,setVerseData:C,subgroupStats:R,setSubgroupStats:j,communityMembers:W,setCommunityMembers:Q,allMembersForRace:te,setAllMembersForRace:Z,memos:Re,setMemos:Le,readHistory:ke,setReadHistory:V,announcement:T,setAnnouncement:S,viewingDay:O,setViewingDay:B,hasReadToday:M,setHasReadToday:X,showConfetti:me,setShowConfetti:oe,levelUpToast:ge,setLevelUpToast:yt,bonusToast:qr,setBonusToast:ya,newAchievement:pr,setNewAchievement:bv,handleRead:Vc,saveMemo:hf,changeSubgroup:Uc,handleRestart:ff,changeStartDate:pf,loadAllMembers:_v,loadMemos:Iv,loadAnnouncement:Nv}=sL(p,v,t),[mf,gf]=A.useState(!1),[yf,vf]=A.useState("all");A.useState("all");const[xf,wf]=A.useState(!1),[bf,_f]=A.useState(!1),[If,Nf]=A.useState(!1),[Ef,kf]=A.useState(!1),[Sf,Tf]=A.useState(!1),[Cf,Tn]=A.useState(!1),[Hi,va]=A.useState(!1),[zc,jf]=A.useState(!1),[Wr,xa]=A.useState(!1),[Df,Bc]=A.useState(null),[Af,qc]=A.useState(new Date),[Rf,wa]=A.useState(new Date),[Wc,Pf]=A.useState(""),[Bs,ba]=A.useState(null),[Hc,Gi]=A.useState(!1),{isSpeaking:Ev,isPaused:Un,ttsSpeed:Gc,availableVoices:mr,selectedVoiceURI:Of,activeChunkIndex:Kc,handleSpeedChange:$f,handleTogglePause:se,handleStop:Ze,handleSpeak:vt,jumpToChunk:Cn,setSelectedVoiceURI:gr}=LL(N.text),[yr,vn]=A.useState([]),[Ft,Qc]=A.useState(null),[Lk,kv]=A.useState(null),[qs,Sv]=A.useState(""),[Mk,Fk]=A.useState("all"),[Vk,Uk]=A.useState("today"),[zk,Bk]=A.useState("name"),[Yc,Tv]=A.useState({text:"",links:[{url:"",text:""}],enabled:!1}),[qk,Xc]=A.useState(null),[Wk,Hk]=A.useState(()=>{const he=localStorage.getItem("bible_fontSize");return he?parseInt(he,10):16}),[Gk,Cv]=A.useState(null),[Kk,Qk]=A.useState(["1year_revised"]),[FL,Yk]=A.useState(!1);A.useEffect(()=>{const he=navigator.userAgent;(he.indexOf("NAVER")>-1||he.indexOf("KAKAOTALK")>-1)&&Yk(!0)},[]),A.useEffect(()=>{b||(p?t==="login"&&(p.communityId&&p.subgroupId?e("dashboard"):(g(p),e("plan_type_select"))):t!=="login"&&e("login"))},[p,b]);const Xk=async()=>{if(fe)try{await fe.collection("settings").doc("announcement").set({...Yc,updatedAt:Ie.firestore.FieldValue.serverTimestamp()}),S(Yc.enabled?Yc:null),alert(" !")}catch(he){console.error("  :",he),alert(" ")}},Jk=async(he,be)=>{if(confirm(`${be}   ?`))try{await fe.collection("users").doc(he).delete(),vn(we=>we.filter(_e=>_e.uid!==he)),alert(".")}catch(we){console.error(we),alert(" ")}},Zk=async(he,be,we)=>{if(!qs||qs.length<6){alert("  6  .");return}if(confirm(`${be}  ?

 : ${qs}`))try{await fe.collection("users").doc(he).set({password:qs,passwordResetRequired:!0,updatedAt:Ie.firestore.FieldValue.serverTimestamp()},{merge:!0}),alert(` ${be}  !

 : ${qs}

    .`),vn(_e=>_e.map(xt=>xt.uid===he?{...xt,password:qs}:xt)),kv(null),Sv("")}catch(_e){console.error(_e),alert("  ")}},eS=he=>Qc({...he}),tS=async()=>{if(Ft)try{await fe.collection("users").doc(Ft.uid).set({communityId:Ft.communityId,communityName:Ft.communityName,subgroupId:Ft.subgroupId,planId:Ft.planId,currentDay:Ft.currentDay,score:Ft.score,streak:Ft.streak,lastReadDate:Ft.lastReadDate||null,updatedAt:Ie.firestore.FieldValue.serverTimestamp()},{merge:!0}),vn(he=>he.map(be=>be.uid===Ft.uid?Ft:be)),Qc(null),alert(".")}catch(he){console.error(he),alert(" ")}},nS=async he=>{if(he.preventDefault(),_(""),n==="signup"){if(console.log("===   ==="),console.log(":",s),console.log(" :",o.length),console.log(":",d),!s.trim()||!o.trim()||!d){_("  .");return}if(o!==c){_("  .");return}if(o.length<6){_(" 6  .");return}}const be=n==="signup"?s:f,we=n==="signup"?o:y;if(!be.trim()||!we.trim()){_("   .");return}if(be==="admin"&&we==="08283"&&n==="login")try{Pt&&!Pt.currentUser&&await Pt.signInAnonymously();const _e=await fe.collection("users").get();vn(_e.docs.map(wt=>Tg(wt)));const xt=await fe.collection("settings").doc("announcement").get();if(xt.exists){const wt=xt.data();!wt.links&&wt.linkUrl&&wt.linkText&&(wt.links=[{url:wt.linkUrl,text:wt.linkText}]),wt.links||(wt.links=[{url:"",text:""}]),Tv(wt)}const zn=await fe.collection("settings").doc("sync").get();zn.exists&&Cv(zn.data()),Gi(!0);return}catch(_e){console.error(_e),_("   ");return}try{const _e=U$(be);console.log(" :",_e);let xt=null;try{console.log("  ..."),xt=await Pt.signInWithEmailAndPassword(_e,we),console.log(" !")}catch(ze){if(console.log(" :",ze.code,ze.message),ze&&ze.code==="auth/user-not-found"||ze&&ze.code==="auth/invalid-login-credentials"||ze&&ze.code==="auth/invalid-credential"){if(n==="login"){_("  .   .");return}console.log("  ...");try{xt=await Pt.createUserWithEmailAndPassword(_e,we),console.log(" !")}catch(Be){console.error("  :",Be),console.error(" :",Be?Be.code:null),console.error(" :",Be?Be.message:null),Be&&Be.code==="auth/email-already-in-use"?_("   .      ."):Be&&Be.code==="auth/weak-password"?_(" 6  ."):Be&&Be.code==="auth/invalid-email"?_("    ."):_(` : ${Be&&Be.message||"   "}`);return}}else if(ze&&ze.code==="auth/wrong-password"){_(" .");return}else{console.error("    :",ze),_(" (   )");return}}const zn=xt.user.uid;console.log(" UID:",zn);const wt=fe.collection("users").doc(zn),Ws=await wt.get();if(!Ws.exists){console.log("  - Firestore   ...");const ze={name:be.trim(),password:we,startDate:new Date().toDateString(),currentDay:1,streak:0,score:0,lastReadDate:null,gender:"male",planId:"1year_revised",communityId:null,communityName:null,subgroupId:null,createdAt:Ie.firestore.FieldValue.serverTimestamp(),updatedAt:Ie.firestore.FieldValue.serverTimestamp()};await wt.set(ze),console.log("Firestore   !"),g({...ze,uid:zn}),e("plan_type_select");return}console.log("  -   ");const Hs=Tg(Ws);v(Hs),X(Hs.lastReadDate===new Date().toDateString()),!Hs.communityId||!Hs.subgroupId?(g(Hs),e("plan_type_select")):e("dashboard")}catch(_e){console.error("  :",_e),_("   ")}},rS=he=>{ba(he),e("bible_version_select")},sS=async he=>{const be=`${Bs}_${he}`;if(w)g(we=>({...we,planId:be})),e("community_select");else if(p){const we={...p,planId:be};v(we);try{const _e=Pt.currentUser?Pt.currentUser.uid:null;_e&&await fe.collection("users").doc(_e).set({planId:be,updatedAt:Ie.firestore.FieldValue.serverTimestamp()},{merge:!0})}catch(_e){console.error(_e)}e("dashboard"),oe(!0),setTimeout(()=>oe(!1),2e3)}},iS=(he,be)=>{g(we=>({...we,communityId:he,communityName:be})),e("subgroup_select")},oS=async he=>{const be={...w,subgroupId:he};v(be),g(null),e("dashboard");try{const we=(Pt.currentUser?Pt.currentUser.uid:null)||be.uid;we&&await fe.collection("users").doc(we).set({...be,updatedAt:Ie.firestore.FieldValue.serverTimestamp()},{merge:!0})}catch(we){console.error(we),alert("  ")}},aS=td.replace("notion-proxy","notion-proxy-bulk"),lS=td.replace("notion-proxy","notion-proxy-page"),cS=async(he=["1year_revised"])=>{if(!fe||!td)return alert(" "),{success:0,error:0,failedItems:[]};let be=0,we=0;const _e=[];for(const xt of he){const[zn,wt]=xt.split("_"),Ws=gs[zn]?gs[zn].find(Be=>Be.id===wt):null,Hs=Ws&&Ws.tagName||" ",ze=Ws&&Ws.name||xt;Xc({current:0,total:365,success:0,error:0,currentVersion:ze,currentDay:0,status:"    ..."});try{console.log(` ${ze}   ...`);const Be=await fetch(aS,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tag:Hs,includeContent:!1})});if(!Be.ok)throw new Error(`Bulk API Error: ${Be.status}`);const Jc=await Be.json();if(console.log(` ${Jc.count}   `),!Jc.items||Jc.items.length===0)throw new Error("   ");const Dv={};for(let an=1;an<=365;an++){const Bn=new Date(2025,0,an),qn=String(Bn.getMonth()+1).padStart(2,"0"),eu=String(Bn.getDate()).padStart(2,"0");Dv[`${qn}-${eu}`]=an}const Lf=Jc.items;let Zc=0;for(const an of Lf){const Bn=Dv[an.date];if(!Bn){console.log(`   : ${an.date}`),we++,_e.push({planId:xt,versionName:ze,day:0,date:an.date,error:"  "});continue}try{const qn=await fetch(lS,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pageId:an.pageId})});if(!qn.ok)throw new Error(`Page API Error: ${qn.status}`);const eu=await qn.json();if(eu.text){const dS=`${zn}_${wt}_${Bn}`;await fe.collection("verses").doc(dS).set({title:an.title,text:eu.text,pageId:an.pageId,day:Bn,planId:xt,syncedAt:Ie.firestore.FieldValue.serverTimestamp()}),be++,console.log(` Day ${Bn} (${an.date})  `)}else throw new Error(" ")}catch(qn){we++,_e.push({planId:xt,versionName:ze,day:Bn,date:an.date,error:qn.message}),console.error(` Day ${Bn} :`,qn.message)}Zc++,Zc%5===0&&Xc({current:Zc,total:Lf.length,success:be,error:we,currentVersion:ze,currentDay:Bn,status:`   ... (${Zc}/${Lf.length})`}),await new Promise(qn=>setTimeout(qn,200))}}catch(Be){console.error(` ${ze}  :`,Be),we+=365,_e.push({planId:xt,versionName:ze,day:0,date:"",error:` : ${Be.message}`})}}return await fe.collection("settings").doc("sync").set({lastSyncAt:Ie.firestore.FieldValue.serverTimestamp(),successCount:be,errorCount:we,syncedVersions:he,failedItems:_e.slice(0,50)}),Xc(null),{success:be,error:we,failedItems:_e}},jv=()=>{Pt&&Pt.signOut(),v(null),Gi(!1),g(null),m(""),x(""),_(""),e("login"),X(!1),Qc(null),Q([])},uS=()=>{ba(null),g(null),e("plan_type_select")};return b?l.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-5xl mb-4 animate-bounce",children:""}),l.jsx("p",{className:"text-slate-500 font-bold",children:"  ..."})]})}):Hc?l.jsx(oL,{handleLogout:jv,downloadCSV:J$,adminViewMode:Vk,setAdminViewMode:Uk,adminFilter:Mk,setAdminFilter:Fk,adminSortBy:zk,setAdminSortBy:Bk,allUsers:yr,MOCK_COMMUNITIES:Lr,BIBLE_VERSIONS:gs,announcementInput:Yc,setAnnouncementInput:Tv,saveAnnouncement:Xk,generateMemosCSV:X$,generateMemosHTML:Fw,editingUser:Ft,setEditingUser:Qc,startEditUser:eS,saveEditUser:tS,changingPassword:Lk,setChangingPassword:kv,newPassword:qs,setNewPassword:Sv,changePassword:Zk,deleteUser:Jk,lastSyncInfo:Gk,setLastSyncInfo:Cv,syncProgress:qk,setSyncProgress:Xc,selectedSyncVersions:Kk,setSelectedSyncVersions:Qk,syncNotionToFirestore:cS,adminStats:Q$(yr),db:fe}):t==="login"?l.jsx(iL,{loginTab:n,setLoginTab:r,loginName:f,setLoginName:m,loginPw:y,setLoginPw:x,signupName:s,setSignupName:i,signupBirthdate:d,setSignupBirthdate:h,signupPw:o,setSignupPw:a,signupPwConfirm:c,setSignupPwConfirm:u,errorMsg:I,handleLogin:nS}):["plan_type_select","bible_version_select","community_select","subgroup_select"].includes(t)?l.jsx(aL,{view:t,currentUser:p,tempUser:w,setView:e,selectedPlanType:Bs,handlePlanTypeSelect:rS,handleVersionSelect:sS,handleCommunitySelect:iS,handleSubgroupSelect:oS}):t==="dashboard"&&p?l.jsx(EL,{currentUser:p,communityMembers:W,allMembersForRace:te,memos:Re,currentMemo:Wc,setCurrentMemo:Pf,readHistory:ke,announcement:T,verseData:N,hasReadToday:M,viewingDay:O,setViewingDay:B,fontSize:Wk,setFontSize:Hk,isSpeaking:Ev,isPaused:Un,handleTogglePause:se,ttsSpeed:Gc,handleSpeedChange:$f,handleStop:Ze,handleSpeak:vt,availableVoices:mr,selectedVoiceURI:Of,setSelectedVoiceURI:gr,activeChunkIndex:Kc,jumpToChunk:Cn,handleRead:Vc,saveMemo:hf,handleLogout:jv,handleChangeVersionStart:uS,handleRestart:ff,changeSubgroup:Uc,changeStartDate:pf,dateToOffset:B$,showConfetti:me,levelUpToast:ge,bonusToast:qr,newAchievement:pr,showScoreInfo:xf,setShowScoreInfo:wf,showReadingGuide:bf,setShowReadingGuide:_f,showMemoList:If,setShowMemoList:Nf,showAchievements:Ef,setShowAchievements:kf,showCalendar:Sf,setShowCalendar:Tf,showFullRanking:Cf,setShowFullRanking:Tn,showDateSettings:Hi,setShowDateSettings:va,showSubgroupChange:zc,setShowSubgroupChange:jf,showRestartConfirm:Wr,setShowRestartConfirm:xa,showMonthlyContestInfo:mf,setShowMonthlyContestInfo:gf,calendarDate:Af,setCalendarDate:qc,dateSettingsDate:Rf,setDateSettingsDate:wa,rankingCommunityFilter:yf,setRankingCommunityFilter:vf,selectedSubgroupDetail:Df,setSelectedSubgroupDetail:Bc,getSubgroupRanking:()=>G$(R),getProgressRanking:()=>K$(R),getSubgroupDisplay:Y$,generateMemosHTML:Fw,getWeeklyMVP:()=>H$(W),setView:e}):t==="mini_room"&&p?l.jsx($L,{currentUser:p,setCurrentUser:v,setView:e}):null};Mp.createRoot(document.getElementById("root")).render(l.jsx(Lp.StrictMode,{children:l.jsx(ML,{})}));
